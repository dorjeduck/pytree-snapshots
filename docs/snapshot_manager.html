<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.0"/>
    <title>snapshot_manager API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#SnapshotManager">SnapshotManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SnapshotManager.__init__">SnapshotManager</a>
                        </li>
                        <li>
                                <a class="variable" href="#SnapshotManager.storage">storage</a>
                        </li>
                        <li>
                                <a class="variable" href="#SnapshotManager.query">query</a>
                        </li>
                        <li>
                                <a class="variable" href="#SnapshotManager.deepcopy_on_save">deepcopy_on_save</a>
                        </li>
                        <li>
                                <a class="variable" href="#SnapshotManager.deepcopy_on_retrieve">deepcopy_on_retrieve</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.save_snapshot">save_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_snapshot">get_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_latest_snapshot">get_latest_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_ids_by_rank">get_ids_by_rank</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.resort">resort</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_ids_by_insertion_order">get_ids_by_insertion_order</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.remove_snapshot">remove_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_metadata">get_metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.update_metadata">update_metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.add_tags">add_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_tags">get_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.remove_tags">remove_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.list_snapshots">list_snapshots</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_snapshot_count">get_snapshot_count</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_snapshot_by_index">get_snapshot_by_index</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.get_oldest_snapshot">get_oldest_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.list_snapshots_by_age">list_snapshots_by_age</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.save_to_file">save_to_file</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.load_from_file">load_from_file</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.update_cmp">update_cmp</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.remove_cmp">remove_cmp</a>
                        </li>
                        <li>
                                <a class="function" href="#SnapshotManager.update_max_snapshots">update_max_snapshots</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Snapshot">Snapshot</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Snapshot.__init__">Snapshot</a>
                        </li>
                        <li>
                                <a class="variable" href="#Snapshot.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Snapshot.timestamp">timestamp</a>
                        </li>
                        <li>
                                <a class="variable" href="#Snapshot.data">data</a>
                        </li>
                        <li>
                                <a class="variable" href="#Snapshot.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#Snapshot.tags">tags</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.get_id">get_id</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.clone">clone</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.from_dict">from_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.get_data">get_data</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.add_tags">add_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.remove_tags">remove_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.get_tags">get_tags</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.has_tag">has_tag</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.get_metadata">get_metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.set_metadata">set_metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.get_timestamp">get_timestamp</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.set_timestamp">set_timestamp</a>
                        </li>
                        <li>
                                <a class="function" href="#Snapshot.update_metadata">update_metadata</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PyTreeSnapshotManager">PyTreeSnapshotManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PyTreeSnapshotManager.__init__">PyTreeSnapshotManager</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshotManager.tree_map">tree_map</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshotManager.tree_replace">tree_replace</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshotManager.tree_combine">tree_combine</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshotManager.load_from_file">load_from_file</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PyTreeSnapshot">PyTreeSnapshot</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PyTreeSnapshot.__init__">PyTreeSnapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshot.validate_pytree">validate_pytree</a>
                        </li>
                        <li>
                                <a class="function" href="#PyTreeSnapshot.tree_map">tree_map</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
snapshot_manager    </h1>

                
                        <input id="mod-snapshot_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-snapshot_manager-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">1</span></a><span class="kn">from</span> <span class="nn">.snapshot_manager</span> <span class="kn">import</span> <span class="n">SnapshotManager</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">2</span></a><span class="kn">from</span> <span class="nn">.snapshot</span> <span class="kn">import</span> <span class="n">Snapshot</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">4</span></a><span class="kn">from</span> <span class="nn">.pytree_snapshot_manager</span> <span class="kn">import</span> <span class="n">PyTreeSnapshotManager</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">5</span></a><span class="kn">from</span> <span class="nn">.pytree_snapshot</span> <span class="kn">import</span> <span class="n">PyTreeSnapshot</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">7</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SnapshotManager&quot;</span><span class="p">,</span> <span class="s2">&quot;Snapshot&quot;</span><span class="p">,</span> <span class="s2">&quot;PyTreeSnapshotManager&quot;</span><span class="p">,</span> <span class="s2">&quot;PyTreeSnapshot&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="SnapshotManager">
                            <input id="SnapshotManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SnapshotManager</span>:

                <label class="view-source-button" for="SnapshotManager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager-12"><a href="#SnapshotManager-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">SnapshotManager</span><span class="p">:</span>
</span><span id="SnapshotManager-13"><a href="#SnapshotManager-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-14"><a href="#SnapshotManager-14"><span class="linenos"> 14</span></a><span class="sd">    A manager for storing and managing data snapshots.</span>
</span><span id="SnapshotManager-15"><a href="#SnapshotManager-15"><span class="linenos"> 15</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-16"><a href="#SnapshotManager-16"><span class="linenos"> 16</span></a>
</span><span id="SnapshotManager-17"><a href="#SnapshotManager-17"><span class="linenos"> 17</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SnapshotManager-18"><a href="#SnapshotManager-18"><span class="linenos"> 18</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SnapshotManager-19"><a href="#SnapshotManager-19"><span class="linenos"> 19</span></a>        <span class="n">deepcopy_on_save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="SnapshotManager-20"><a href="#SnapshotManager-20"><span class="linenos"> 20</span></a>        <span class="n">deepcopy_on_retrieve</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="SnapshotManager-21"><a href="#SnapshotManager-21"><span class="linenos"> 21</span></a>        <span class="n">query_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-22"><a href="#SnapshotManager-22"><span class="linenos"> 22</span></a>        <span class="n">max_snapshots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-23"><a href="#SnapshotManager-23"><span class="linenos"> 23</span></a>        <span class="n">cmp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-24"><a href="#SnapshotManager-24"><span class="linenos"> 24</span></a>    <span class="p">):</span>
</span><span id="SnapshotManager-25"><a href="#SnapshotManager-25"><span class="linenos"> 25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-26"><a href="#SnapshotManager-26"><span class="linenos"> 26</span></a><span class="sd">        Initialize the SnapshotManager.</span>
</span><span id="SnapshotManager-27"><a href="#SnapshotManager-27"><span class="linenos"> 27</span></a>
</span><span id="SnapshotManager-28"><a href="#SnapshotManager-28"><span class="linenos"> 28</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-29"><a href="#SnapshotManager-29"><span class="linenos"> 29</span></a><span class="sd">            deepcopy_on_save (bool): Whether to deepcopy PyTrees when saving snapshots. Defaults to True.</span>
</span><span id="SnapshotManager-30"><a href="#SnapshotManager-30"><span class="linenos"> 30</span></a><span class="sd">            deepcopy_on_retrieve (bool): Whether to return deep copies of PyTrees when retrieving snapshots. Defaults to True.</span>
</span><span id="SnapshotManager-31"><a href="#SnapshotManager-31"><span class="linenos"> 31</span></a><span class="sd">            query_class (type, optional): A class implementing SnapshotQueryInterface. Defaults to SnapshotQuery.</span>
</span><span id="SnapshotManager-32"><a href="#SnapshotManager-32"><span class="linenos"> 32</span></a><span class="sd">            max_snapshots (int, optional): Maximum number of snapshots to store. Defaults to None (no limit).</span>
</span><span id="SnapshotManager-33"><a href="#SnapshotManager-33"><span class="linenos"> 33</span></a><span class="sd">            cmp (callable, optional): A comparison function to order snapshots, also used to decide which snapshot to remove</span>
</span><span id="SnapshotManager-34"><a href="#SnapshotManager-34"><span class="linenos"> 34</span></a><span class="sd">                                            when the storage limit is reached. Defaults to None.</span>
</span><span id="SnapshotManager-35"><a href="#SnapshotManager-35"><span class="linenos"> 35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-36"><a href="#SnapshotManager-36"><span class="linenos"> 36</span></a>        <span class="k">if</span> <span class="n">query_class</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">query_class</span><span class="p">,</span> <span class="n">SnapshotQueryInterface</span><span class="p">):</span>
</span><span id="SnapshotManager-37"><a href="#SnapshotManager-37"><span class="linenos"> 37</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;query_class must implement SnapshotQueryInterface.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-38"><a href="#SnapshotManager-38"><span class="linenos"> 38</span></a>
</span><span id="SnapshotManager-39"><a href="#SnapshotManager-39"><span class="linenos"> 39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">SnapshotStorage</span><span class="p">(</span><span class="n">max_snapshots</span><span class="o">=</span><span class="n">max_snapshots</span><span class="p">,</span> <span class="n">cmp</span><span class="o">=</span><span class="n">cmp</span><span class="p">)</span>
</span><span id="SnapshotManager-40"><a href="#SnapshotManager-40"><span class="linenos"> 40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="n">query_class</span> <span class="ow">or</span> <span class="n">SnapshotQuery</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</span><span id="SnapshotManager-41"><a href="#SnapshotManager-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_save</span> <span class="o">=</span> <span class="n">deepcopy_on_save</span>
</span><span id="SnapshotManager-42"><a href="#SnapshotManager-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_retrieve</span> <span class="o">=</span> <span class="n">deepcopy_on_retrieve</span>
</span><span id="SnapshotManager-43"><a href="#SnapshotManager-43"><span class="linenos"> 43</span></a>
</span><span id="SnapshotManager-44"><a href="#SnapshotManager-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager-45"><a href="#SnapshotManager-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-46"><a href="#SnapshotManager-46"><span class="linenos"> 46</span></a><span class="sd">        Retrieve the data of a Snapshot by its index or ID.</span>
</span><span id="SnapshotManager-47"><a href="#SnapshotManager-47"><span class="linenos"> 47</span></a>
</span><span id="SnapshotManager-48"><a href="#SnapshotManager-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-49"><a href="#SnapshotManager-49"><span class="linenos"> 49</span></a><span class="sd">            index (int or str):</span>
</span><span id="SnapshotManager-50"><a href="#SnapshotManager-50"><span class="linenos"> 50</span></a><span class="sd">                - If an integer, retrieves the Snapshot by its position in the creation order.</span>
</span><span id="SnapshotManager-51"><a href="#SnapshotManager-51"><span class="linenos"> 51</span></a><span class="sd">                - If a string, retrieves the Snapshot by its unique ID.</span>
</span><span id="SnapshotManager-52"><a href="#SnapshotManager-52"><span class="linenos"> 52</span></a><span class="sd">            deepcopy (bool, optional): If True, returns a deep copy of the Snapshot&#39;s data.</span>
</span><span id="SnapshotManager-53"><a href="#SnapshotManager-53"><span class="linenos"> 53</span></a><span class="sd">                Defaults to the manager&#39;s `deepcopy_on_retrieve` setting.</span>
</span><span id="SnapshotManager-54"><a href="#SnapshotManager-54"><span class="linenos"> 54</span></a>
</span><span id="SnapshotManager-55"><a href="#SnapshotManager-55"><span class="linenos"> 55</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-56"><a href="#SnapshotManager-56"><span class="linenos"> 56</span></a><span class="sd">            Any: The data of the requested Snapshot.</span>
</span><span id="SnapshotManager-57"><a href="#SnapshotManager-57"><span class="linenos"> 57</span></a>
</span><span id="SnapshotManager-58"><a href="#SnapshotManager-58"><span class="linenos"> 58</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-59"><a href="#SnapshotManager-59"><span class="linenos"> 59</span></a><span class="sd">            ValueError: If `index` is neither an integer nor a string.</span>
</span><span id="SnapshotManager-60"><a href="#SnapshotManager-60"><span class="linenos"> 60</span></a><span class="sd">            IndexError: If the index is out of range when `index` is an integer.</span>
</span><span id="SnapshotManager-61"><a href="#SnapshotManager-61"><span class="linenos"> 61</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist when `index` is a string.</span>
</span><span id="SnapshotManager-62"><a href="#SnapshotManager-62"><span class="linenos"> 62</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-63"><a href="#SnapshotManager-63"><span class="linenos"> 63</span></a>
</span><span id="SnapshotManager-64"><a href="#SnapshotManager-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="SnapshotManager-65"><a href="#SnapshotManager-65"><span class="linenos"> 65</span></a>            <span class="c1"># Retrieve Snapshot by creation index</span>
</span><span id="SnapshotManager-66"><a href="#SnapshotManager-66"><span class="linenos"> 66</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot_by_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span><span id="SnapshotManager-67"><a href="#SnapshotManager-67"><span class="linenos"> 67</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SnapshotManager-68"><a href="#SnapshotManager-68"><span class="linenos"> 68</span></a>            <span class="c1"># Retrieve Snapshot by ID</span>
</span><span id="SnapshotManager-69"><a href="#SnapshotManager-69"><span class="linenos"> 69</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span><span id="SnapshotManager-70"><a href="#SnapshotManager-70"><span class="linenos"> 70</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SnapshotManager-71"><a href="#SnapshotManager-71"><span class="linenos"> 71</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid index type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">. Must be int or str.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-72"><a href="#SnapshotManager-72"><span class="linenos"> 72</span></a>
</span><span id="SnapshotManager-73"><a href="#SnapshotManager-73"><span class="linenos"> 73</span></a>    <span class="c1"># Save, Retrieve, and Delete PytreeSnapshots</span>
</span><span id="SnapshotManager-74"><a href="#SnapshotManager-74"><span class="linenos"> 74</span></a>
</span><span id="SnapshotManager-75"><a href="#SnapshotManager-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">save_snapshot</span><span class="p">(</span>
</span><span id="SnapshotManager-76"><a href="#SnapshotManager-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SnapshotManager-77"><a href="#SnapshotManager-77"><span class="linenos"> 77</span></a>        <span class="n">data</span><span class="p">,</span>
</span><span id="SnapshotManager-78"><a href="#SnapshotManager-78"><span class="linenos"> 78</span></a>        <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-79"><a href="#SnapshotManager-79"><span class="linenos"> 79</span></a>        <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-80"><a href="#SnapshotManager-80"><span class="linenos"> 80</span></a>        <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager-81"><a href="#SnapshotManager-81"><span class="linenos"> 81</span></a>        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="SnapshotManager-82"><a href="#SnapshotManager-82"><span class="linenos"> 82</span></a>        <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">,</span>
</span><span id="SnapshotManager-83"><a href="#SnapshotManager-83"><span class="linenos"> 83</span></a>    <span class="p">):</span>
</span><span id="SnapshotManager-84"><a href="#SnapshotManager-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-85"><a href="#SnapshotManager-85"><span class="linenos"> 85</span></a><span class="sd">        Save a new Snapshot or overwrite an existing one.</span>
</span><span id="SnapshotManager-86"><a href="#SnapshotManager-86"><span class="linenos"> 86</span></a>
</span><span id="SnapshotManager-87"><a href="#SnapshotManager-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-88"><a href="#SnapshotManager-88"><span class="linenos"> 88</span></a><span class="sd">            data (Any): The data to store in the Snapshot. Can be any serializable Python object or PyTree.</span>
</span><span id="SnapshotManager-89"><a href="#SnapshotManager-89"><span class="linenos"> 89</span></a><span class="sd">            snapshot_id (str, optional): Identifier for the Snapshot. A unique ID is generated if not provided.</span>
</span><span id="SnapshotManager-90"><a href="#SnapshotManager-90"><span class="linenos"> 90</span></a><span class="sd">            metadata (dict, optional): Additional metadata to associate with the Snapshot. Defaults to None.</span>
</span><span id="SnapshotManager-91"><a href="#SnapshotManager-91"><span class="linenos"> 91</span></a><span class="sd">            tags (list, optional): Tags to categorize or label the Snapshot. Defaults to None.</span>
</span><span id="SnapshotManager-92"><a href="#SnapshotManager-92"><span class="linenos"> 92</span></a><span class="sd">            overwrite (bool): Whether to overwrite an existing Snapshot with the same ID. Defaults to False.</span>
</span><span id="SnapshotManager-93"><a href="#SnapshotManager-93"><span class="linenos"> 93</span></a><span class="sd">            deepcopy (bool, optional): Whether to deepcopy the data before saving. If not specified,</span>
</span><span id="SnapshotManager-94"><a href="#SnapshotManager-94"><span class="linenos"> 94</span></a><span class="sd">                uses the manager&#39;s `deepcopy_on_save` setting.</span>
</span><span id="SnapshotManager-95"><a href="#SnapshotManager-95"><span class="linenos"> 95</span></a>
</span><span id="SnapshotManager-96"><a href="#SnapshotManager-96"><span class="linenos"> 96</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-97"><a href="#SnapshotManager-97"><span class="linenos"> 97</span></a><span class="sd">            str: The ID of the saved Snapshot if successfully added.</span>
</span><span id="SnapshotManager-98"><a href="#SnapshotManager-98"><span class="linenos"> 98</span></a><span class="sd">            bool: False if the Snapshot was not saved due to storage constraints.</span>
</span><span id="SnapshotManager-99"><a href="#SnapshotManager-99"><span class="linenos"> 99</span></a>
</span><span id="SnapshotManager-100"><a href="#SnapshotManager-100"><span class="linenos">100</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-101"><a href="#SnapshotManager-101"><span class="linenos">101</span></a><span class="sd">            ValueError: If attempting to save a Snapshot with an existing ID without `overwrite=True`.</span>
</span><span id="SnapshotManager-102"><a href="#SnapshotManager-102"><span class="linenos">102</span></a><span class="sd">            TypeError: If `tags` or `metadata` is not of the correct type.</span>
</span><span id="SnapshotManager-103"><a href="#SnapshotManager-103"><span class="linenos">103</span></a>
</span><span id="SnapshotManager-104"><a href="#SnapshotManager-104"><span class="linenos">104</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-105"><a href="#SnapshotManager-105"><span class="linenos">105</span></a><span class="sd">            Save a simple data structure:</span>
</span><span id="SnapshotManager-106"><a href="#SnapshotManager-106"><span class="linenos">106</span></a><span class="sd">                manager.save_snapshot({&quot;key&quot;: &quot;value&quot;}, tags=[&quot;example&quot;], metadata={&quot;desc&quot;: &quot;test&quot;})</span>
</span><span id="SnapshotManager-107"><a href="#SnapshotManager-107"><span class="linenos">107</span></a>
</span><span id="SnapshotManager-108"><a href="#SnapshotManager-108"><span class="linenos">108</span></a><span class="sd">            Overwrite an existing snapshot:</span>
</span><span id="SnapshotManager-109"><a href="#SnapshotManager-109"><span class="linenos">109</span></a><span class="sd">                manager.save_snapshot(data, snapshot_id=&quot;existing_id&quot;, overwrite=True)</span>
</span><span id="SnapshotManager-110"><a href="#SnapshotManager-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-111"><a href="#SnapshotManager-111"><span class="linenos">111</span></a>
</span><span id="SnapshotManager-112"><a href="#SnapshotManager-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="SnapshotManager-113"><a href="#SnapshotManager-113"><span class="linenos">113</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tags must be a list.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-114"><a href="#SnapshotManager-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="SnapshotManager-115"><a href="#SnapshotManager-115"><span class="linenos">115</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;metadata must be a dictionary.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-116"><a href="#SnapshotManager-116"><span class="linenos">116</span></a>
</span><span id="SnapshotManager-117"><a href="#SnapshotManager-117"><span class="linenos">117</span></a>        <span class="n">deepcopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_save</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">is</span> <span class="n">DEFAULT</span> <span class="k">else</span> <span class="n">deepcopy</span>
</span><span id="SnapshotManager-118"><a href="#SnapshotManager-118"><span class="linenos">118</span></a>
</span><span id="SnapshotManager-119"><a href="#SnapshotManager-119"><span class="linenos">119</span></a>        <span class="c1"># Check if overwriting is not allowed</span>
</span><span id="SnapshotManager-120"><a href="#SnapshotManager-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">has_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager-121"><a href="#SnapshotManager-121"><span class="linenos">121</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SnapshotManager-122"><a href="#SnapshotManager-122"><span class="linenos">122</span></a>                <span class="sa">f</span><span class="s2">&quot;Snapshot ID &#39;</span><span class="si">{</span><span class="n">snapshot_id</span><span class="si">}</span><span class="s2">&#39; already exists. Set `overwrite=True` to replace it.&quot;</span>
</span><span id="SnapshotManager-123"><a href="#SnapshotManager-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="SnapshotManager-124"><a href="#SnapshotManager-124"><span class="linenos">124</span></a>
</span><span id="SnapshotManager-125"><a href="#SnapshotManager-125"><span class="linenos">125</span></a>        <span class="c1"># Create the snapshot using the factory method</span>
</span><span id="SnapshotManager-126"><a href="#SnapshotManager-126"><span class="linenos">126</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_snapshot</span><span class="p">(</span>
</span><span id="SnapshotManager-127"><a href="#SnapshotManager-127"><span class="linenos">127</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="SnapshotManager-128"><a href="#SnapshotManager-128"><span class="linenos">128</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="SnapshotManager-129"><a href="#SnapshotManager-129"><span class="linenos">129</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
</span><span id="SnapshotManager-130"><a href="#SnapshotManager-130"><span class="linenos">130</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">,</span>
</span><span id="SnapshotManager-131"><a href="#SnapshotManager-131"><span class="linenos">131</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">,</span>
</span><span id="SnapshotManager-132"><a href="#SnapshotManager-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="SnapshotManager-133"><a href="#SnapshotManager-133"><span class="linenos">133</span></a>
</span><span id="SnapshotManager-134"><a href="#SnapshotManager-134"><span class="linenos">134</span></a>        <span class="c1"># Add the snapshot to storage</span>
</span><span id="SnapshotManager-135"><a href="#SnapshotManager-135"><span class="linenos">135</span></a>
</span><span id="SnapshotManager-136"><a href="#SnapshotManager-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">add_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">):</span>
</span><span id="SnapshotManager-137"><a href="#SnapshotManager-137"><span class="linenos">137</span></a>            <span class="c1"># Snapshot was not added due to storage constraints / cmp policy</span>
</span><span id="SnapshotManager-138"><a href="#SnapshotManager-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="SnapshotManager-139"><a href="#SnapshotManager-139"><span class="linenos">139</span></a>
</span><span id="SnapshotManager-140"><a href="#SnapshotManager-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">id</span>
</span><span id="SnapshotManager-141"><a href="#SnapshotManager-141"><span class="linenos">141</span></a>
</span><span id="SnapshotManager-142"><a href="#SnapshotManager-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="nf">get_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager-143"><a href="#SnapshotManager-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-144"><a href="#SnapshotManager-144"><span class="linenos">144</span></a><span class="sd">        Retrieve a Snapshot by its unique ID.</span>
</span><span id="SnapshotManager-145"><a href="#SnapshotManager-145"><span class="linenos">145</span></a>
</span><span id="SnapshotManager-146"><a href="#SnapshotManager-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-147"><a href="#SnapshotManager-147"><span class="linenos">147</span></a><span class="sd">            snapshot_id (str): The unique identifier of the Snapshot to retrieve.</span>
</span><span id="SnapshotManager-148"><a href="#SnapshotManager-148"><span class="linenos">148</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot&#39;s data.</span>
</span><span id="SnapshotManager-149"><a href="#SnapshotManager-149"><span class="linenos">149</span></a><span class="sd">                If not specified, defaults to the manager&#39;s `deepcopy_on_retrieve` setting.</span>
</span><span id="SnapshotManager-150"><a href="#SnapshotManager-150"><span class="linenos">150</span></a>
</span><span id="SnapshotManager-151"><a href="#SnapshotManager-151"><span class="linenos">151</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-152"><a href="#SnapshotManager-152"><span class="linenos">152</span></a><span class="sd">            Snapshot: The Snapshot object associated with the given ID.</span>
</span><span id="SnapshotManager-153"><a href="#SnapshotManager-153"><span class="linenos">153</span></a>
</span><span id="SnapshotManager-154"><a href="#SnapshotManager-154"><span class="linenos">154</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-155"><a href="#SnapshotManager-155"><span class="linenos">155</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager-156"><a href="#SnapshotManager-156"><span class="linenos">156</span></a>
</span><span id="SnapshotManager-157"><a href="#SnapshotManager-157"><span class="linenos">157</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-158"><a href="#SnapshotManager-158"><span class="linenos">158</span></a><span class="sd">            Retrieve a Snapshot with a deep copy:</span>
</span><span id="SnapshotManager-159"><a href="#SnapshotManager-159"><span class="linenos">159</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;example_id&quot;, deepcopy=True)</span>
</span><span id="SnapshotManager-160"><a href="#SnapshotManager-160"><span class="linenos">160</span></a>
</span><span id="SnapshotManager-161"><a href="#SnapshotManager-161"><span class="linenos">161</span></a><span class="sd">            Retrieve a Snapshot without a deep copy:</span>
</span><span id="SnapshotManager-162"><a href="#SnapshotManager-162"><span class="linenos">162</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;example_id&quot;, deepcopy=False)</span>
</span><span id="SnapshotManager-163"><a href="#SnapshotManager-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-164"><a href="#SnapshotManager-164"><span class="linenos">164</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-165"><a href="#SnapshotManager-165"><span class="linenos">165</span></a>
</span><span id="SnapshotManager-166"><a href="#SnapshotManager-166"><span class="linenos">166</span></a>        <span class="n">deepcopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_retrieve</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">is</span> <span class="n">DEFAULT</span> <span class="k">else</span> <span class="n">deepcopy</span>
</span><span id="SnapshotManager-167"><a href="#SnapshotManager-167"><span class="linenos">167</span></a>
</span><span id="SnapshotManager-168"><a href="#SnapshotManager-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="n">snapshot</span>
</span><span id="SnapshotManager-169"><a href="#SnapshotManager-169"><span class="linenos">169</span></a>
</span><span id="SnapshotManager-170"><a href="#SnapshotManager-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">get_latest_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager-171"><a href="#SnapshotManager-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-172"><a href="#SnapshotManager-172"><span class="linenos">172</span></a><span class="sd">        Retrieve the most recently added Snapshot.</span>
</span><span id="SnapshotManager-173"><a href="#SnapshotManager-173"><span class="linenos">173</span></a>
</span><span id="SnapshotManager-174"><a href="#SnapshotManager-174"><span class="linenos">174</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-175"><a href="#SnapshotManager-175"><span class="linenos">175</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot&#39;s data.</span>
</span><span id="SnapshotManager-176"><a href="#SnapshotManager-176"><span class="linenos">176</span></a><span class="sd">                If not specified, defaults to the manager&#39;s `deepcopy_on_retrieve` setting.</span>
</span><span id="SnapshotManager-177"><a href="#SnapshotManager-177"><span class="linenos">177</span></a>
</span><span id="SnapshotManager-178"><a href="#SnapshotManager-178"><span class="linenos">178</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-179"><a href="#SnapshotManager-179"><span class="linenos">179</span></a><span class="sd">            Snapshot: The most recently added Snapshot object.</span>
</span><span id="SnapshotManager-180"><a href="#SnapshotManager-180"><span class="linenos">180</span></a>
</span><span id="SnapshotManager-181"><a href="#SnapshotManager-181"><span class="linenos">181</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-182"><a href="#SnapshotManager-182"><span class="linenos">182</span></a><span class="sd">            IndexError: If no snapshots are stored.</span>
</span><span id="SnapshotManager-183"><a href="#SnapshotManager-183"><span class="linenos">183</span></a>
</span><span id="SnapshotManager-184"><a href="#SnapshotManager-184"><span class="linenos">184</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-185"><a href="#SnapshotManager-185"><span class="linenos">185</span></a><span class="sd">            Retrieve the latest Snapshot with a deep copy:</span>
</span><span id="SnapshotManager-186"><a href="#SnapshotManager-186"><span class="linenos">186</span></a><span class="sd">                latest_snapshot = manager.get_latest_snapshot(deepcopy=True)</span>
</span><span id="SnapshotManager-187"><a href="#SnapshotManager-187"><span class="linenos">187</span></a>
</span><span id="SnapshotManager-188"><a href="#SnapshotManager-188"><span class="linenos">188</span></a><span class="sd">            Retrieve the latest Snapshot without a deep copy:</span>
</span><span id="SnapshotManager-189"><a href="#SnapshotManager-189"><span class="linenos">189</span></a><span class="sd">                latest_snapshot = manager.get_latest_snapshot(deepcopy=False)</span>
</span><span id="SnapshotManager-190"><a href="#SnapshotManager-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-191"><a href="#SnapshotManager-191"><span class="linenos">191</span></a>        <span class="c1"># Use storage to get the latest snapshot</span>
</span><span id="SnapshotManager-192"><a href="#SnapshotManager-192"><span class="linenos">192</span></a>
</span><span id="SnapshotManager-193"><a href="#SnapshotManager-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">:</span>
</span><span id="SnapshotManager-194"><a href="#SnapshotManager-194"><span class="linenos">194</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;No snapshots are available.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-195"><a href="#SnapshotManager-195"><span class="linenos">195</span></a>
</span><span id="SnapshotManager-196"><a href="#SnapshotManager-196"><span class="linenos">196</span></a>        <span class="c1"># Use storage to get the latest snapshot ID</span>
</span><span id="SnapshotManager-197"><a href="#SnapshotManager-197"><span class="linenos">197</span></a>        <span class="n">latest_snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SnapshotManager-198"><a href="#SnapshotManager-198"><span class="linenos">198</span></a>
</span><span id="SnapshotManager-199"><a href="#SnapshotManager-199"><span class="linenos">199</span></a>        <span class="c1"># Retrieve the snapshot using the get_snapshot method</span>
</span><span id="SnapshotManager-200"><a href="#SnapshotManager-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">latest_snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span><span id="SnapshotManager-201"><a href="#SnapshotManager-201"><span class="linenos">201</span></a>
</span><span id="SnapshotManager-202"><a href="#SnapshotManager-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">get_ids_by_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-203"><a href="#SnapshotManager-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-204"><a href="#SnapshotManager-204"><span class="linenos">204</span></a><span class="sd">        Retrieve a list of snapshot IDs ranked according to the comparison function.</span>
</span><span id="SnapshotManager-205"><a href="#SnapshotManager-205"><span class="linenos">205</span></a>
</span><span id="SnapshotManager-206"><a href="#SnapshotManager-206"><span class="linenos">206</span></a><span class="sd">        If a custom comparison function (`cmp`) was provided during the initialization of</span>
</span><span id="SnapshotManager-207"><a href="#SnapshotManager-207"><span class="linenos">207</span></a><span class="sd">        the manager, the snapshots will be ranked based on that function. If no comparison function</span>
</span><span id="SnapshotManager-208"><a href="#SnapshotManager-208"><span class="linenos">208</span></a><span class="sd">        is defined, the snapshots are ranked by their creation time in insertion order.</span>
</span><span id="SnapshotManager-209"><a href="#SnapshotManager-209"><span class="linenos">209</span></a>
</span><span id="SnapshotManager-210"><a href="#SnapshotManager-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-211"><a href="#SnapshotManager-211"><span class="linenos">211</span></a><span class="sd">            list[str]: A list of snapshot IDs ranked according to the defined criteria.</span>
</span><span id="SnapshotManager-212"><a href="#SnapshotManager-212"><span class="linenos">212</span></a>
</span><span id="SnapshotManager-213"><a href="#SnapshotManager-213"><span class="linenos">213</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-214"><a href="#SnapshotManager-214"><span class="linenos">214</span></a><span class="sd">            Retrieve snapshot IDs ranked by a custom comparison:</span>
</span><span id="SnapshotManager-215"><a href="#SnapshotManager-215"><span class="linenos">215</span></a><span class="sd">                ranked_ids = manager.get_ids_by_rank()</span>
</span><span id="SnapshotManager-216"><a href="#SnapshotManager-216"><span class="linenos">216</span></a>
</span><span id="SnapshotManager-217"><a href="#SnapshotManager-217"><span class="linenos">217</span></a><span class="sd">            If no comparison function is defined:</span>
</span><span id="SnapshotManager-218"><a href="#SnapshotManager-218"><span class="linenos">218</span></a><span class="sd">                ranked_ids = manager.get_ids_by_rank()  # Returns IDs in insertion order</span>
</span><span id="SnapshotManager-219"><a href="#SnapshotManager-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-220"><a href="#SnapshotManager-220"><span class="linenos">220</span></a>
</span><span id="SnapshotManager-221"><a href="#SnapshotManager-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_ids_by_rank</span><span class="p">()</span>
</span><span id="SnapshotManager-222"><a href="#SnapshotManager-222"><span class="linenos">222</span></a>
</span><span id="SnapshotManager-223"><a href="#SnapshotManager-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">resort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-224"><a href="#SnapshotManager-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-225"><a href="#SnapshotManager-225"><span class="linenos">225</span></a><span class="sd">        Re-sort the snapshots in storage according to the current comparison function if available.</span>
</span><span id="SnapshotManager-226"><a href="#SnapshotManager-226"><span class="linenos">226</span></a>
</span><span id="SnapshotManager-227"><a href="#SnapshotManager-227"><span class="linenos">227</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-228"><a href="#SnapshotManager-228"><span class="linenos">228</span></a><span class="sd">            None</span>
</span><span id="SnapshotManager-229"><a href="#SnapshotManager-229"><span class="linenos">229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-230"><a href="#SnapshotManager-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">resort</span><span class="p">()</span>
</span><span id="SnapshotManager-231"><a href="#SnapshotManager-231"><span class="linenos">231</span></a>
</span><span id="SnapshotManager-232"><a href="#SnapshotManager-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">get_ids_by_insertion_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-233"><a href="#SnapshotManager-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-234"><a href="#SnapshotManager-234"><span class="linenos">234</span></a><span class="sd">        Retrieve a list of snapshot IDs in the order they were added.</span>
</span><span id="SnapshotManager-235"><a href="#SnapshotManager-235"><span class="linenos">235</span></a>
</span><span id="SnapshotManager-236"><a href="#SnapshotManager-236"><span class="linenos">236</span></a><span class="sd">        This method returns the snapshot IDs in the exact sequence they were created or added</span>
</span><span id="SnapshotManager-237"><a href="#SnapshotManager-237"><span class="linenos">237</span></a><span class="sd">        to the manager. Unlike ranked snapshots, this order is based purely on the creation</span>
</span><span id="SnapshotManager-238"><a href="#SnapshotManager-238"><span class="linenos">238</span></a><span class="sd">        or insertion order, unaffected by any cmp or ranking logic.</span>
</span><span id="SnapshotManager-239"><a href="#SnapshotManager-239"><span class="linenos">239</span></a>
</span><span id="SnapshotManager-240"><a href="#SnapshotManager-240"><span class="linenos">240</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-241"><a href="#SnapshotManager-241"><span class="linenos">241</span></a><span class="sd">            list[str]: A list of snapshot IDs ordered by their insertion sequence.</span>
</span><span id="SnapshotManager-242"><a href="#SnapshotManager-242"><span class="linenos">242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-243"><a href="#SnapshotManager-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_ids_by_insertion_order</span><span class="p">()</span>
</span><span id="SnapshotManager-244"><a href="#SnapshotManager-244"><span class="linenos">244</span></a>
</span><span id="SnapshotManager-245"><a href="#SnapshotManager-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">remove_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager-246"><a href="#SnapshotManager-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-247"><a href="#SnapshotManager-247"><span class="linenos">247</span></a><span class="sd">        Remove a Snapshot by its unique ID.</span>
</span><span id="SnapshotManager-248"><a href="#SnapshotManager-248"><span class="linenos">248</span></a>
</span><span id="SnapshotManager-249"><a href="#SnapshotManager-249"><span class="linenos">249</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-250"><a href="#SnapshotManager-250"><span class="linenos">250</span></a><span class="sd">            snapshot_id (str): The unique identifier of the Snapshot to remove.</span>
</span><span id="SnapshotManager-251"><a href="#SnapshotManager-251"><span class="linenos">251</span></a>
</span><span id="SnapshotManager-252"><a href="#SnapshotManager-252"><span class="linenos">252</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-253"><a href="#SnapshotManager-253"><span class="linenos">253</span></a><span class="sd">            bool: True if the Snapshot was successfully removed, False if no Snapshot with the</span>
</span><span id="SnapshotManager-254"><a href="#SnapshotManager-254"><span class="linenos">254</span></a><span class="sd">                given ID exists in storage.</span>
</span><span id="SnapshotManager-255"><a href="#SnapshotManager-255"><span class="linenos">255</span></a>
</span><span id="SnapshotManager-256"><a href="#SnapshotManager-256"><span class="linenos">256</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-257"><a href="#SnapshotManager-257"><span class="linenos">257</span></a><span class="sd">            ValueError: If the provided snapshot_id is not a string.</span>
</span><span id="SnapshotManager-258"><a href="#SnapshotManager-258"><span class="linenos">258</span></a>
</span><span id="SnapshotManager-259"><a href="#SnapshotManager-259"><span class="linenos">259</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-260"><a href="#SnapshotManager-260"><span class="linenos">260</span></a><span class="sd">            Remove a Snapshot by ID:</span>
</span><span id="SnapshotManager-261"><a href="#SnapshotManager-261"><span class="linenos">261</span></a><span class="sd">                success = manager.remove_snapshot(&quot;example_id&quot;)</span>
</span><span id="SnapshotManager-262"><a href="#SnapshotManager-262"><span class="linenos">262</span></a><span class="sd">                if success:</span>
</span><span id="SnapshotManager-263"><a href="#SnapshotManager-263"><span class="linenos">263</span></a><span class="sd">                    print(&quot;Snapshot removed.&quot;)</span>
</span><span id="SnapshotManager-264"><a href="#SnapshotManager-264"><span class="linenos">264</span></a><span class="sd">                else:</span>
</span><span id="SnapshotManager-265"><a href="#SnapshotManager-265"><span class="linenos">265</span></a><span class="sd">                    print(&quot;Snapshot ID not found.&quot;)</span>
</span><span id="SnapshotManager-266"><a href="#SnapshotManager-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-267"><a href="#SnapshotManager-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SnapshotManager-268"><a href="#SnapshotManager-268"><span class="linenos">268</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot ID must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-269"><a href="#SnapshotManager-269"><span class="linenos">269</span></a>
</span><span id="SnapshotManager-270"><a href="#SnapshotManager-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">remove_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-271"><a href="#SnapshotManager-271"><span class="linenos">271</span></a>
</span><span id="SnapshotManager-272"><a href="#SnapshotManager-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager-273"><a href="#SnapshotManager-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-274"><a href="#SnapshotManager-274"><span class="linenos">274</span></a><span class="sd">        Retrieve the metadata associated with a specific Snapshot.</span>
</span><span id="SnapshotManager-275"><a href="#SnapshotManager-275"><span class="linenos">275</span></a>
</span><span id="SnapshotManager-276"><a href="#SnapshotManager-276"><span class="linenos">276</span></a><span class="sd">        This method fetches the metadata stored alongside the Snapshot identified by `snapshot_id`.</span>
</span><span id="SnapshotManager-277"><a href="#SnapshotManager-277"><span class="linenos">277</span></a><span class="sd">        Metadata typically contains additional descriptive information about the Snapshot.</span>
</span><span id="SnapshotManager-278"><a href="#SnapshotManager-278"><span class="linenos">278</span></a>
</span><span id="SnapshotManager-279"><a href="#SnapshotManager-279"><span class="linenos">279</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-280"><a href="#SnapshotManager-280"><span class="linenos">280</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot whose metadata is to be retrieved.</span>
</span><span id="SnapshotManager-281"><a href="#SnapshotManager-281"><span class="linenos">281</span></a>
</span><span id="SnapshotManager-282"><a href="#SnapshotManager-282"><span class="linenos">282</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-283"><a href="#SnapshotManager-283"><span class="linenos">283</span></a><span class="sd">            dict: The metadata dictionary associated with the Snapshot.</span>
</span><span id="SnapshotManager-284"><a href="#SnapshotManager-284"><span class="linenos">284</span></a>
</span><span id="SnapshotManager-285"><a href="#SnapshotManager-285"><span class="linenos">285</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-286"><a href="#SnapshotManager-286"><span class="linenos">286</span></a><span class="sd">            ValueError: If the Snapshot with the given `snapshot_id` does not exist.</span>
</span><span id="SnapshotManager-287"><a href="#SnapshotManager-287"><span class="linenos">287</span></a>
</span><span id="SnapshotManager-288"><a href="#SnapshotManager-288"><span class="linenos">288</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-289"><a href="#SnapshotManager-289"><span class="linenos">289</span></a><span class="sd">            Retrieve metadata for a specific Snapshot:</span>
</span><span id="SnapshotManager-290"><a href="#SnapshotManager-290"><span class="linenos">290</span></a><span class="sd">                metadata = manager.get_metadata(&quot;example_snapshot_id&quot;)</span>
</span><span id="SnapshotManager-291"><a href="#SnapshotManager-291"><span class="linenos">291</span></a><span class="sd">                print(metadata)</span>
</span><span id="SnapshotManager-292"><a href="#SnapshotManager-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-293"><a href="#SnapshotManager-293"><span class="linenos">293</span></a>
</span><span id="SnapshotManager-294"><a href="#SnapshotManager-294"><span class="linenos">294</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-295"><a href="#SnapshotManager-295"><span class="linenos">295</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">metadata</span>
</span><span id="SnapshotManager-296"><a href="#SnapshotManager-296"><span class="linenos">296</span></a>
</span><span id="SnapshotManager-297"><a href="#SnapshotManager-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">new_metadata</span><span class="p">):</span>
</span><span id="SnapshotManager-298"><a href="#SnapshotManager-298"><span class="linenos">298</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-299"><a href="#SnapshotManager-299"><span class="linenos">299</span></a><span class="sd">        Update the metadata for a specific Snapshot.</span>
</span><span id="SnapshotManager-300"><a href="#SnapshotManager-300"><span class="linenos">300</span></a>
</span><span id="SnapshotManager-301"><a href="#SnapshotManager-301"><span class="linenos">301</span></a><span class="sd">        This method merges the provided `new_metadata` dictionary with the existing metadata</span>
</span><span id="SnapshotManager-302"><a href="#SnapshotManager-302"><span class="linenos">302</span></a><span class="sd">        of the Snapshot identified by `snapshot_id`. Existing keys in the metadata will be</span>
</span><span id="SnapshotManager-303"><a href="#SnapshotManager-303"><span class="linenos">303</span></a><span class="sd">        updated, and new keys will be added.</span>
</span><span id="SnapshotManager-304"><a href="#SnapshotManager-304"><span class="linenos">304</span></a>
</span><span id="SnapshotManager-305"><a href="#SnapshotManager-305"><span class="linenos">305</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-306"><a href="#SnapshotManager-306"><span class="linenos">306</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot to update.</span>
</span><span id="SnapshotManager-307"><a href="#SnapshotManager-307"><span class="linenos">307</span></a><span class="sd">            new_metadata (dict): A dictionary of new metadata to merge with the existing metadata.</span>
</span><span id="SnapshotManager-308"><a href="#SnapshotManager-308"><span class="linenos">308</span></a>
</span><span id="SnapshotManager-309"><a href="#SnapshotManager-309"><span class="linenos">309</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-310"><a href="#SnapshotManager-310"><span class="linenos">310</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in storage.</span>
</span><span id="SnapshotManager-311"><a href="#SnapshotManager-311"><span class="linenos">311</span></a><span class="sd">            TypeError: If `new_metadata` is not a dictionary.</span>
</span><span id="SnapshotManager-312"><a href="#SnapshotManager-312"><span class="linenos">312</span></a>
</span><span id="SnapshotManager-313"><a href="#SnapshotManager-313"><span class="linenos">313</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-314"><a href="#SnapshotManager-314"><span class="linenos">314</span></a><span class="sd">            Update metadata for a snapshot:</span>
</span><span id="SnapshotManager-315"><a href="#SnapshotManager-315"><span class="linenos">315</span></a><span class="sd">                manager.update_metadata(&quot;snap_id&quot;, {&quot;new_key&quot;: &quot;new_value&quot;})</span>
</span><span id="SnapshotManager-316"><a href="#SnapshotManager-316"><span class="linenos">316</span></a>
</span><span id="SnapshotManager-317"><a href="#SnapshotManager-317"><span class="linenos">317</span></a><span class="sd">            Merge additional metadata:</span>
</span><span id="SnapshotManager-318"><a href="#SnapshotManager-318"><span class="linenos">318</span></a><span class="sd">                manager.update_metadata(&quot;snap_id&quot;, {&quot;updated_field&quot;: &quot;new_value&quot;})</span>
</span><span id="SnapshotManager-319"><a href="#SnapshotManager-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-320"><a href="#SnapshotManager-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="SnapshotManager-321"><a href="#SnapshotManager-321"><span class="linenos">321</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;new_metadata must be a dictionary.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-322"><a href="#SnapshotManager-322"><span class="linenos">322</span></a>
</span><span id="SnapshotManager-323"><a href="#SnapshotManager-323"><span class="linenos">323</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-324"><a href="#SnapshotManager-324"><span class="linenos">324</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">)</span>
</span><span id="SnapshotManager-325"><a href="#SnapshotManager-325"><span class="linenos">325</span></a>
</span><span id="SnapshotManager-326"><a href="#SnapshotManager-326"><span class="linenos">326</span></a>    <span class="c1"># Tag Management</span>
</span><span id="SnapshotManager-327"><a href="#SnapshotManager-327"><span class="linenos">327</span></a>
</span><span id="SnapshotManager-328"><a href="#SnapshotManager-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="nf">add_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="SnapshotManager-329"><a href="#SnapshotManager-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-330"><a href="#SnapshotManager-330"><span class="linenos">330</span></a><span class="sd">        Add tags to a Snapshot.</span>
</span><span id="SnapshotManager-331"><a href="#SnapshotManager-331"><span class="linenos">331</span></a>
</span><span id="SnapshotManager-332"><a href="#SnapshotManager-332"><span class="linenos">332</span></a><span class="sd">        This method adds the provided tags to the Snapshot identified by `snapshot_id`.</span>
</span><span id="SnapshotManager-333"><a href="#SnapshotManager-333"><span class="linenos">333</span></a><span class="sd">        Duplicate tags will be ignored, ensuring that each tag appears only once in the Snapshot.</span>
</span><span id="SnapshotManager-334"><a href="#SnapshotManager-334"><span class="linenos">334</span></a>
</span><span id="SnapshotManager-335"><a href="#SnapshotManager-335"><span class="linenos">335</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-336"><a href="#SnapshotManager-336"><span class="linenos">336</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot to which tags should be added.</span>
</span><span id="SnapshotManager-337"><a href="#SnapshotManager-337"><span class="linenos">337</span></a><span class="sd">            tags (list[str]): A list of tags to add to the Snapshot. Each tag should be a string.</span>
</span><span id="SnapshotManager-338"><a href="#SnapshotManager-338"><span class="linenos">338</span></a>
</span><span id="SnapshotManager-339"><a href="#SnapshotManager-339"><span class="linenos">339</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-340"><a href="#SnapshotManager-340"><span class="linenos">340</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager-341"><a href="#SnapshotManager-341"><span class="linenos">341</span></a><span class="sd">            TypeError: If `tags` is not a list or contains non-string elements.</span>
</span><span id="SnapshotManager-342"><a href="#SnapshotManager-342"><span class="linenos">342</span></a>
</span><span id="SnapshotManager-343"><a href="#SnapshotManager-343"><span class="linenos">343</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-344"><a href="#SnapshotManager-344"><span class="linenos">344</span></a><span class="sd">            Add new tags to a Snapshot:</span>
</span><span id="SnapshotManager-345"><a href="#SnapshotManager-345"><span class="linenos">345</span></a><span class="sd">                manager.add_tags(&quot;example_id&quot;, [&quot;important&quot;, &quot;review&quot;])</span>
</span><span id="SnapshotManager-346"><a href="#SnapshotManager-346"><span class="linenos">346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-347"><a href="#SnapshotManager-347"><span class="linenos">347</span></a>
</span><span id="SnapshotManager-348"><a href="#SnapshotManager-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="SnapshotManager-349"><a href="#SnapshotManager-349"><span class="linenos">349</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tags must be a list.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-350"><a href="#SnapshotManager-350"><span class="linenos">350</span></a>
</span><span id="SnapshotManager-351"><a href="#SnapshotManager-351"><span class="linenos">351</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-352"><a href="#SnapshotManager-352"><span class="linenos">352</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">add_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span><span id="SnapshotManager-353"><a href="#SnapshotManager-353"><span class="linenos">353</span></a>
</span><span id="SnapshotManager-354"><a href="#SnapshotManager-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager-355"><a href="#SnapshotManager-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-356"><a href="#SnapshotManager-356"><span class="linenos">356</span></a><span class="sd">        Retrieve the tags associated with a specific Snapshot.</span>
</span><span id="SnapshotManager-357"><a href="#SnapshotManager-357"><span class="linenos">357</span></a>
</span><span id="SnapshotManager-358"><a href="#SnapshotManager-358"><span class="linenos">358</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-359"><a href="#SnapshotManager-359"><span class="linenos">359</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot whose tags are to be retrieved.</span>
</span><span id="SnapshotManager-360"><a href="#SnapshotManager-360"><span class="linenos">360</span></a>
</span><span id="SnapshotManager-361"><a href="#SnapshotManager-361"><span class="linenos">361</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-362"><a href="#SnapshotManager-362"><span class="linenos">362</span></a><span class="sd">            list[str]: A list of tags associated with the Snapshot. If no tags are associated, returns an empty list.</span>
</span><span id="SnapshotManager-363"><a href="#SnapshotManager-363"><span class="linenos">363</span></a>
</span><span id="SnapshotManager-364"><a href="#SnapshotManager-364"><span class="linenos">364</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-365"><a href="#SnapshotManager-365"><span class="linenos">365</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager-366"><a href="#SnapshotManager-366"><span class="linenos">366</span></a>
</span><span id="SnapshotManager-367"><a href="#SnapshotManager-367"><span class="linenos">367</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-368"><a href="#SnapshotManager-368"><span class="linenos">368</span></a><span class="sd">            Retrieve tags for a Snapshot:</span>
</span><span id="SnapshotManager-369"><a href="#SnapshotManager-369"><span class="linenos">369</span></a><span class="sd">                tags = manager.get_tags(&quot;snapshot_id&quot;)</span>
</span><span id="SnapshotManager-370"><a href="#SnapshotManager-370"><span class="linenos">370</span></a><span class="sd">                print(tags)</span>
</span><span id="SnapshotManager-371"><a href="#SnapshotManager-371"><span class="linenos">371</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-372"><a href="#SnapshotManager-372"><span class="linenos">372</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-373"><a href="#SnapshotManager-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">tags</span>
</span><span id="SnapshotManager-374"><a href="#SnapshotManager-374"><span class="linenos">374</span></a>
</span><span id="SnapshotManager-375"><a href="#SnapshotManager-375"><span class="linenos">375</span></a>    <span class="k">def</span> <span class="nf">remove_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="SnapshotManager-376"><a href="#SnapshotManager-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-377"><a href="#SnapshotManager-377"><span class="linenos">377</span></a><span class="sd">        Remove tags from a Snapshot.</span>
</span><span id="SnapshotManager-378"><a href="#SnapshotManager-378"><span class="linenos">378</span></a>
</span><span id="SnapshotManager-379"><a href="#SnapshotManager-379"><span class="linenos">379</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-380"><a href="#SnapshotManager-380"><span class="linenos">380</span></a><span class="sd">            snapshot_id (str): The ID of the Snapshot.</span>
</span><span id="SnapshotManager-381"><a href="#SnapshotManager-381"><span class="linenos">381</span></a><span class="sd">            tags (list): Tags to remove.</span>
</span><span id="SnapshotManager-382"><a href="#SnapshotManager-382"><span class="linenos">382</span></a>
</span><span id="SnapshotManager-383"><a href="#SnapshotManager-383"><span class="linenos">383</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-384"><a href="#SnapshotManager-384"><span class="linenos">384</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist.</span>
</span><span id="SnapshotManager-385"><a href="#SnapshotManager-385"><span class="linenos">385</span></a>
</span><span id="SnapshotManager-386"><a href="#SnapshotManager-386"><span class="linenos">386</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-387"><a href="#SnapshotManager-387"><span class="linenos">387</span></a><span class="sd">            Remove tags from a Snapshot:</span>
</span><span id="SnapshotManager-388"><a href="#SnapshotManager-388"><span class="linenos">388</span></a><span class="sd">                manager.remove_tags(&quot;snap_id&quot;, [&quot;obsolete&quot;])</span>
</span><span id="SnapshotManager-389"><a href="#SnapshotManager-389"><span class="linenos">389</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-390"><a href="#SnapshotManager-390"><span class="linenos">390</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager-391"><a href="#SnapshotManager-391"><span class="linenos">391</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">remove_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span><span id="SnapshotManager-392"><a href="#SnapshotManager-392"><span class="linenos">392</span></a>
</span><span id="SnapshotManager-393"><a href="#SnapshotManager-393"><span class="linenos">393</span></a>    <span class="c1"># Querying and Listing PytreeSnapshots</span>
</span><span id="SnapshotManager-394"><a href="#SnapshotManager-394"><span class="linenos">394</span></a>
</span><span id="SnapshotManager-395"><a href="#SnapshotManager-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">list_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-396"><a href="#SnapshotManager-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-397"><a href="#SnapshotManager-397"><span class="linenos">397</span></a><span class="sd">        List all Snapshot IDs in the order they were created.</span>
</span><span id="SnapshotManager-398"><a href="#SnapshotManager-398"><span class="linenos">398</span></a>
</span><span id="SnapshotManager-399"><a href="#SnapshotManager-399"><span class="linenos">399</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-400"><a href="#SnapshotManager-400"><span class="linenos">400</span></a><span class="sd">            list: Snapshot IDs.</span>
</span><span id="SnapshotManager-401"><a href="#SnapshotManager-401"><span class="linenos">401</span></a>
</span><span id="SnapshotManager-402"><a href="#SnapshotManager-402"><span class="linenos">402</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-403"><a href="#SnapshotManager-403"><span class="linenos">403</span></a><span class="sd">            List all Snapshot IDs:</span>
</span><span id="SnapshotManager-404"><a href="#SnapshotManager-404"><span class="linenos">404</span></a><span class="sd">                ids = manager.list_snapshots()</span>
</span><span id="SnapshotManager-405"><a href="#SnapshotManager-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-406"><a href="#SnapshotManager-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="SnapshotManager-407"><a href="#SnapshotManager-407"><span class="linenos">407</span></a>
</span><span id="SnapshotManager-408"><a href="#SnapshotManager-408"><span class="linenos">408</span></a>    <span class="k">def</span> <span class="nf">get_snapshot_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-409"><a href="#SnapshotManager-409"><span class="linenos">409</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-410"><a href="#SnapshotManager-410"><span class="linenos">410</span></a><span class="sd">        Return the current number of PytreeSnapshots.</span>
</span><span id="SnapshotManager-411"><a href="#SnapshotManager-411"><span class="linenos">411</span></a>
</span><span id="SnapshotManager-412"><a href="#SnapshotManager-412"><span class="linenos">412</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-413"><a href="#SnapshotManager-413"><span class="linenos">413</span></a><span class="sd">            int: The number of stored PytreeSnapshots.</span>
</span><span id="SnapshotManager-414"><a href="#SnapshotManager-414"><span class="linenos">414</span></a>
</span><span id="SnapshotManager-415"><a href="#SnapshotManager-415"><span class="linenos">415</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-416"><a href="#SnapshotManager-416"><span class="linenos">416</span></a><span class="sd">            Get the number of PytreeSnapshots:</span>
</span><span id="SnapshotManager-417"><a href="#SnapshotManager-417"><span class="linenos">417</span></a><span class="sd">                count = manager.get_snapshot_count()</span>
</span><span id="SnapshotManager-418"><a href="#SnapshotManager-418"><span class="linenos">418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-419"><a href="#SnapshotManager-419"><span class="linenos">419</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</span><span id="SnapshotManager-420"><a href="#SnapshotManager-420"><span class="linenos">420</span></a>
</span><span id="SnapshotManager-421"><a href="#SnapshotManager-421"><span class="linenos">421</span></a>    <span class="k">def</span> <span class="nf">get_snapshot_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager-422"><a href="#SnapshotManager-422"><span class="linenos">422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-423"><a href="#SnapshotManager-423"><span class="linenos">423</span></a><span class="sd">        Retrieve a Snapshot by its creation index.</span>
</span><span id="SnapshotManager-424"><a href="#SnapshotManager-424"><span class="linenos">424</span></a>
</span><span id="SnapshotManager-425"><a href="#SnapshotManager-425"><span class="linenos">425</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-426"><a href="#SnapshotManager-426"><span class="linenos">426</span></a><span class="sd">            index (int): Index of the Snapshot in the creation order.</span>
</span><span id="SnapshotManager-427"><a href="#SnapshotManager-427"><span class="linenos">427</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</span>
</span><span id="SnapshotManager-428"><a href="#SnapshotManager-428"><span class="linenos">428</span></a>
</span><span id="SnapshotManager-429"><a href="#SnapshotManager-429"><span class="linenos">429</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-430"><a href="#SnapshotManager-430"><span class="linenos">430</span></a><span class="sd">            Snapshot: The Snapshot object.</span>
</span><span id="SnapshotManager-431"><a href="#SnapshotManager-431"><span class="linenos">431</span></a>
</span><span id="SnapshotManager-432"><a href="#SnapshotManager-432"><span class="linenos">432</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-433"><a href="#SnapshotManager-433"><span class="linenos">433</span></a><span class="sd">            IndexError: If the index is out of range.</span>
</span><span id="SnapshotManager-434"><a href="#SnapshotManager-434"><span class="linenos">434</span></a>
</span><span id="SnapshotManager-435"><a href="#SnapshotManager-435"><span class="linenos">435</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-436"><a href="#SnapshotManager-436"><span class="linenos">436</span></a><span class="sd">            Retrieve a Snapshot by index:</span>
</span><span id="SnapshotManager-437"><a href="#SnapshotManager-437"><span class="linenos">437</span></a><span class="sd">                snapshot = manager.get_snapshot_by_index(0)</span>
</span><span id="SnapshotManager-438"><a href="#SnapshotManager-438"><span class="linenos">438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-439"><a href="#SnapshotManager-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">):</span>
</span><span id="SnapshotManager-440"><a href="#SnapshotManager-440"><span class="linenos">440</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index &#39;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&#39; is out of range.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-441"><a href="#SnapshotManager-441"><span class="linenos">441</span></a>
</span><span id="SnapshotManager-442"><a href="#SnapshotManager-442"><span class="linenos">442</span></a>        <span class="c1"># Get the snapshot ID by its index</span>
</span><span id="SnapshotManager-443"><a href="#SnapshotManager-443"><span class="linenos">443</span></a>        <span class="n">snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="SnapshotManager-444"><a href="#SnapshotManager-444"><span class="linenos">444</span></a>
</span><span id="SnapshotManager-445"><a href="#SnapshotManager-445"><span class="linenos">445</span></a>        <span class="c1"># Use the existing get_snapshot method to retrieve the snapshot</span>
</span><span id="SnapshotManager-446"><a href="#SnapshotManager-446"><span class="linenos">446</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span><span id="SnapshotManager-447"><a href="#SnapshotManager-447"><span class="linenos">447</span></a>
</span><span id="SnapshotManager-448"><a href="#SnapshotManager-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">get_oldest_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager-449"><a href="#SnapshotManager-449"><span class="linenos">449</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-450"><a href="#SnapshotManager-450"><span class="linenos">450</span></a><span class="sd">        Retrieve the oldest Snapshot.</span>
</span><span id="SnapshotManager-451"><a href="#SnapshotManager-451"><span class="linenos">451</span></a>
</span><span id="SnapshotManager-452"><a href="#SnapshotManager-452"><span class="linenos">452</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-453"><a href="#SnapshotManager-453"><span class="linenos">453</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</span>
</span><span id="SnapshotManager-454"><a href="#SnapshotManager-454"><span class="linenos">454</span></a>
</span><span id="SnapshotManager-455"><a href="#SnapshotManager-455"><span class="linenos">455</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-456"><a href="#SnapshotManager-456"><span class="linenos">456</span></a><span class="sd">            Snapshot: The oldest Snapshot object.</span>
</span><span id="SnapshotManager-457"><a href="#SnapshotManager-457"><span class="linenos">457</span></a>
</span><span id="SnapshotManager-458"><a href="#SnapshotManager-458"><span class="linenos">458</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-459"><a href="#SnapshotManager-459"><span class="linenos">459</span></a><span class="sd">            IndexError: If no Snapshots are available.</span>
</span><span id="SnapshotManager-460"><a href="#SnapshotManager-460"><span class="linenos">460</span></a>
</span><span id="SnapshotManager-461"><a href="#SnapshotManager-461"><span class="linenos">461</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-462"><a href="#SnapshotManager-462"><span class="linenos">462</span></a><span class="sd">            Retrieve the oldest Snapshot:</span>
</span><span id="SnapshotManager-463"><a href="#SnapshotManager-463"><span class="linenos">463</span></a><span class="sd">                snapshot = manager.get_oldest_snapshot()</span>
</span><span id="SnapshotManager-464"><a href="#SnapshotManager-464"><span class="linenos">464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-465"><a href="#SnapshotManager-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">:</span>
</span><span id="SnapshotManager-466"><a href="#SnapshotManager-466"><span class="linenos">466</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;No Snapshots are available.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager-467"><a href="#SnapshotManager-467"><span class="linenos">467</span></a>
</span><span id="SnapshotManager-468"><a href="#SnapshotManager-468"><span class="linenos">468</span></a>        <span class="c1"># Get the oldest snapshot ID from the storage</span>
</span><span id="SnapshotManager-469"><a href="#SnapshotManager-469"><span class="linenos">469</span></a>        <span class="n">oldest_snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SnapshotManager-470"><a href="#SnapshotManager-470"><span class="linenos">470</span></a>
</span><span id="SnapshotManager-471"><a href="#SnapshotManager-471"><span class="linenos">471</span></a>        <span class="c1"># Use the existing get_snapshot method to retrieve the snapshot</span>
</span><span id="SnapshotManager-472"><a href="#SnapshotManager-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">oldest_snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span><span id="SnapshotManager-473"><a href="#SnapshotManager-473"><span class="linenos">473</span></a>
</span><span id="SnapshotManager-474"><a href="#SnapshotManager-474"><span class="linenos">474</span></a>    <span class="k">def</span> <span class="nf">list_snapshots_by_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SnapshotManager-475"><a href="#SnapshotManager-475"><span class="linenos">475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-476"><a href="#SnapshotManager-476"><span class="linenos">476</span></a><span class="sd">        List all Snapshot IDs sorted by their age (creation time).</span>
</span><span id="SnapshotManager-477"><a href="#SnapshotManager-477"><span class="linenos">477</span></a>
</span><span id="SnapshotManager-478"><a href="#SnapshotManager-478"><span class="linenos">478</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-479"><a href="#SnapshotManager-479"><span class="linenos">479</span></a><span class="sd">            ascending (bool): If True, lists PytreeSnapshots from oldest to newest. Otherwise, newest to oldest.</span>
</span><span id="SnapshotManager-480"><a href="#SnapshotManager-480"><span class="linenos">480</span></a>
</span><span id="SnapshotManager-481"><a href="#SnapshotManager-481"><span class="linenos">481</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-482"><a href="#SnapshotManager-482"><span class="linenos">482</span></a><span class="sd">            list: Snapshot IDs sorted by age.</span>
</span><span id="SnapshotManager-483"><a href="#SnapshotManager-483"><span class="linenos">483</span></a>
</span><span id="SnapshotManager-484"><a href="#SnapshotManager-484"><span class="linenos">484</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-485"><a href="#SnapshotManager-485"><span class="linenos">485</span></a><span class="sd">            List PytreeSnapshots from newest to oldest:</span>
</span><span id="SnapshotManager-486"><a href="#SnapshotManager-486"><span class="linenos">486</span></a><span class="sd">                ids = manager.list_snapshots_by_age(ascending=False)</span>
</span><span id="SnapshotManager-487"><a href="#SnapshotManager-487"><span class="linenos">487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-488"><a href="#SnapshotManager-488"><span class="linenos">488</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="SnapshotManager-489"><a href="#SnapshotManager-489"><span class="linenos">489</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="SnapshotManager-490"><a href="#SnapshotManager-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">ascending</span>
</span><span id="SnapshotManager-491"><a href="#SnapshotManager-491"><span class="linenos">491</span></a>            <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">))</span>
</span><span id="SnapshotManager-492"><a href="#SnapshotManager-492"><span class="linenos">492</span></a>        <span class="p">)</span>
</span><span id="SnapshotManager-493"><a href="#SnapshotManager-493"><span class="linenos">493</span></a>
</span><span id="SnapshotManager-494"><a href="#SnapshotManager-494"><span class="linenos">494</span></a>    <span class="k">def</span> <span class="nf">_create_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager-495"><a href="#SnapshotManager-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-496"><a href="#SnapshotManager-496"><span class="linenos">496</span></a><span class="sd">        Factory method to create a Snapshot. Can be overridden by subclasses.</span>
</span><span id="SnapshotManager-497"><a href="#SnapshotManager-497"><span class="linenos">497</span></a>
</span><span id="SnapshotManager-498"><a href="#SnapshotManager-498"><span class="linenos">498</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-499"><a href="#SnapshotManager-499"><span class="linenos">499</span></a><span class="sd">            data: The data to store in the Snapshot.</span>
</span><span id="SnapshotManager-500"><a href="#SnapshotManager-500"><span class="linenos">500</span></a><span class="sd">            metadata (dict): Metadata to associate with the snapshot.</span>
</span><span id="SnapshotManager-501"><a href="#SnapshotManager-501"><span class="linenos">501</span></a><span class="sd">            tags (list): Tags to associate with the snapshot.</span>
</span><span id="SnapshotManager-502"><a href="#SnapshotManager-502"><span class="linenos">502</span></a><span class="sd">            deepcopy (bool): Whether to deepcopy the data.</span>
</span><span id="SnapshotManager-503"><a href="#SnapshotManager-503"><span class="linenos">503</span></a><span class="sd">            snapshot_id (str): Identifier for the Snapshot.</span>
</span><span id="SnapshotManager-504"><a href="#SnapshotManager-504"><span class="linenos">504</span></a>
</span><span id="SnapshotManager-505"><a href="#SnapshotManager-505"><span class="linenos">505</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-506"><a href="#SnapshotManager-506"><span class="linenos">506</span></a><span class="sd">            Snapshot: The created Snapshot instance.</span>
</span><span id="SnapshotManager-507"><a href="#SnapshotManager-507"><span class="linenos">507</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-508"><a href="#SnapshotManager-508"><span class="linenos">508</span></a>
</span><span id="SnapshotManager-509"><a href="#SnapshotManager-509"><span class="linenos">509</span></a>        <span class="k">return</span> <span class="n">Snapshot</span><span class="p">(</span>
</span><span id="SnapshotManager-510"><a href="#SnapshotManager-510"><span class="linenos">510</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="SnapshotManager-511"><a href="#SnapshotManager-511"><span class="linenos">511</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="SnapshotManager-512"><a href="#SnapshotManager-512"><span class="linenos">512</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
</span><span id="SnapshotManager-513"><a href="#SnapshotManager-513"><span class="linenos">513</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">,</span>
</span><span id="SnapshotManager-514"><a href="#SnapshotManager-514"><span class="linenos">514</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">,</span>
</span><span id="SnapshotManager-515"><a href="#SnapshotManager-515"><span class="linenos">515</span></a>        <span class="p">)</span>
</span><span id="SnapshotManager-516"><a href="#SnapshotManager-516"><span class="linenos">516</span></a>
</span><span id="SnapshotManager-517"><a href="#SnapshotManager-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SnapshotManager-518"><a href="#SnapshotManager-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-519"><a href="#SnapshotManager-519"><span class="linenos">519</span></a><span class="sd">        Save the current state of the SnapshotManager to a file.</span>
</span><span id="SnapshotManager-520"><a href="#SnapshotManager-520"><span class="linenos">520</span></a>
</span><span id="SnapshotManager-521"><a href="#SnapshotManager-521"><span class="linenos">521</span></a><span class="sd">        The state includes all stored snapshots, metadata, and configuration. This allows for</span>
</span><span id="SnapshotManager-522"><a href="#SnapshotManager-522"><span class="linenos">522</span></a><span class="sd">        persistent storage and later restoration of the manager&#39;s state.</span>
</span><span id="SnapshotManager-523"><a href="#SnapshotManager-523"><span class="linenos">523</span></a>
</span><span id="SnapshotManager-524"><a href="#SnapshotManager-524"><span class="linenos">524</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-525"><a href="#SnapshotManager-525"><span class="linenos">525</span></a><span class="sd">            file_path (str): The file path where the state should be saved.</span>
</span><span id="SnapshotManager-526"><a href="#SnapshotManager-526"><span class="linenos">526</span></a><span class="sd">            compress (bool): Whether to compress the saved state. Defaults to True.</span>
</span><span id="SnapshotManager-527"><a href="#SnapshotManager-527"><span class="linenos">527</span></a>
</span><span id="SnapshotManager-528"><a href="#SnapshotManager-528"><span class="linenos">528</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-529"><a href="#SnapshotManager-529"><span class="linenos">529</span></a><span class="sd">            None</span>
</span><span id="SnapshotManager-530"><a href="#SnapshotManager-530"><span class="linenos">530</span></a>
</span><span id="SnapshotManager-531"><a href="#SnapshotManager-531"><span class="linenos">531</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-532"><a href="#SnapshotManager-532"><span class="linenos">532</span></a><span class="sd">            IOError: If there is an issue writing to the file.</span>
</span><span id="SnapshotManager-533"><a href="#SnapshotManager-533"><span class="linenos">533</span></a>
</span><span id="SnapshotManager-534"><a href="#SnapshotManager-534"><span class="linenos">534</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-535"><a href="#SnapshotManager-535"><span class="linenos">535</span></a><span class="sd">            Save the state of the manager to a file:</span>
</span><span id="SnapshotManager-536"><a href="#SnapshotManager-536"><span class="linenos">536</span></a><span class="sd">                manager.save_to_file(&quot;snapshot_manager_state.json&quot;)</span>
</span><span id="SnapshotManager-537"><a href="#SnapshotManager-537"><span class="linenos">537</span></a>
</span><span id="SnapshotManager-538"><a href="#SnapshotManager-538"><span class="linenos">538</span></a><span class="sd">            Save without compression:</span>
</span><span id="SnapshotManager-539"><a href="#SnapshotManager-539"><span class="linenos">539</span></a><span class="sd">                manager.save_to_file(&quot;snapshot_manager_state.json&quot;, compress=False)</span>
</span><span id="SnapshotManager-540"><a href="#SnapshotManager-540"><span class="linenos">540</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-541"><a href="#SnapshotManager-541"><span class="linenos">541</span></a>
</span><span id="SnapshotManager-542"><a href="#SnapshotManager-542"><span class="linenos">542</span></a>        <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">compress</span><span class="p">)</span>
</span><span id="SnapshotManager-543"><a href="#SnapshotManager-543"><span class="linenos">543</span></a>
</span><span id="SnapshotManager-544"><a href="#SnapshotManager-544"><span class="linenos">544</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SnapshotManager-545"><a href="#SnapshotManager-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="nf">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="SnapshotManager-546"><a href="#SnapshotManager-546"><span class="linenos">546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-547"><a href="#SnapshotManager-547"><span class="linenos">547</span></a><span class="sd">        Load a SnapshotManager instance from a file.</span>
</span><span id="SnapshotManager-548"><a href="#SnapshotManager-548"><span class="linenos">548</span></a>
</span><span id="SnapshotManager-549"><a href="#SnapshotManager-549"><span class="linenos">549</span></a><span class="sd">        This method restores the state of a SnapshotManager from a file created using `save_to_file`.</span>
</span><span id="SnapshotManager-550"><a href="#SnapshotManager-550"><span class="linenos">550</span></a><span class="sd">        The loaded state includes all stored snapshots, metadata, and configuration.</span>
</span><span id="SnapshotManager-551"><a href="#SnapshotManager-551"><span class="linenos">551</span></a>
</span><span id="SnapshotManager-552"><a href="#SnapshotManager-552"><span class="linenos">552</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-553"><a href="#SnapshotManager-553"><span class="linenos">553</span></a><span class="sd">            file_path (str): The path to the file containing the saved state.</span>
</span><span id="SnapshotManager-554"><a href="#SnapshotManager-554"><span class="linenos">554</span></a>
</span><span id="SnapshotManager-555"><a href="#SnapshotManager-555"><span class="linenos">555</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager-556"><a href="#SnapshotManager-556"><span class="linenos">556</span></a><span class="sd">            SnapshotManager: A new instance of SnapshotManager initialized with the loaded state.</span>
</span><span id="SnapshotManager-557"><a href="#SnapshotManager-557"><span class="linenos">557</span></a>
</span><span id="SnapshotManager-558"><a href="#SnapshotManager-558"><span class="linenos">558</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager-559"><a href="#SnapshotManager-559"><span class="linenos">559</span></a><span class="sd">            IOError: If there is an issue reading from the file.</span>
</span><span id="SnapshotManager-560"><a href="#SnapshotManager-560"><span class="linenos">560</span></a><span class="sd">            ValueError: If the file does not contain valid SnapshotManager data.</span>
</span><span id="SnapshotManager-561"><a href="#SnapshotManager-561"><span class="linenos">561</span></a>
</span><span id="SnapshotManager-562"><a href="#SnapshotManager-562"><span class="linenos">562</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager-563"><a href="#SnapshotManager-563"><span class="linenos">563</span></a><span class="sd">            Load a SnapshotManager from a saved file:</span>
</span><span id="SnapshotManager-564"><a href="#SnapshotManager-564"><span class="linenos">564</span></a><span class="sd">                manager = SnapshotManager.load_from_file(&quot;snapshot_manager_state.json&quot;)</span>
</span><span id="SnapshotManager-565"><a href="#SnapshotManager-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-566"><a href="#SnapshotManager-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">SnapshotManager</span><span class="p">,</span> <span class="n">Snapshot</span><span class="p">)</span>
</span><span id="SnapshotManager-567"><a href="#SnapshotManager-567"><span class="linenos">567</span></a>
</span><span id="SnapshotManager-568"><a href="#SnapshotManager-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="nf">update_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmp</span><span class="p">):</span>
</span><span id="SnapshotManager-569"><a href="#SnapshotManager-569"><span class="linenos">569</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-570"><a href="#SnapshotManager-570"><span class="linenos">570</span></a><span class="sd">        Update the cmp function used for ranking snapshots.</span>
</span><span id="SnapshotManager-571"><a href="#SnapshotManager-571"><span class="linenos">571</span></a>
</span><span id="SnapshotManager-572"><a href="#SnapshotManager-572"><span class="linenos">572</span></a><span class="sd">        This method updates the comparison function used to determine the ranking of snapshots.</span>
</span><span id="SnapshotManager-573"><a href="#SnapshotManager-573"><span class="linenos">573</span></a><span class="sd">        The new cmp will be applied to the existing snapshots, and they will be re-ranked accordingly.</span>
</span><span id="SnapshotManager-574"><a href="#SnapshotManager-574"><span class="linenos">574</span></a>
</span><span id="SnapshotManager-575"><a href="#SnapshotManager-575"><span class="linenos">575</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-576"><a href="#SnapshotManager-576"><span class="linenos">576</span></a><span class="sd">            cmp (callable): A new cmp function that takes two snapshots as arguments and</span>
</span><span id="SnapshotManager-577"><a href="#SnapshotManager-577"><span class="linenos">577</span></a><span class="sd">                returns a negative, zero, or positive number to indicate their relative ranking.</span>
</span><span id="SnapshotManager-578"><a href="#SnapshotManager-578"><span class="linenos">578</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-579"><a href="#SnapshotManager-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_cmp</span><span class="p">(</span><span class="n">cmp</span><span class="p">)</span>
</span><span id="SnapshotManager-580"><a href="#SnapshotManager-580"><span class="linenos">580</span></a>
</span><span id="SnapshotManager-581"><a href="#SnapshotManager-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">remove_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager-582"><a href="#SnapshotManager-582"><span class="linenos">582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-583"><a href="#SnapshotManager-583"><span class="linenos">583</span></a><span class="sd">        Remove the cmp function and disable ranked snapshot management.</span>
</span><span id="SnapshotManager-584"><a href="#SnapshotManager-584"><span class="linenos">584</span></a>
</span><span id="SnapshotManager-585"><a href="#SnapshotManager-585"><span class="linenos">585</span></a><span class="sd">        This method removes the cmp function from the storage, disabling ranked snapshots.</span>
</span><span id="SnapshotManager-586"><a href="#SnapshotManager-586"><span class="linenos">586</span></a><span class="sd">        Snapshots will no longer be ranked or sorted based on the cmp, and only their creation</span>
</span><span id="SnapshotManager-587"><a href="#SnapshotManager-587"><span class="linenos">587</span></a><span class="sd">        order will be maintained.</span>
</span><span id="SnapshotManager-588"><a href="#SnapshotManager-588"><span class="linenos">588</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-589"><a href="#SnapshotManager-589"><span class="linenos">589</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_cmp</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="SnapshotManager-590"><a href="#SnapshotManager-590"><span class="linenos">590</span></a>
</span><span id="SnapshotManager-591"><a href="#SnapshotManager-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="nf">update_max_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_snapshots</span><span class="p">):</span>
</span><span id="SnapshotManager-592"><a href="#SnapshotManager-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager-593"><a href="#SnapshotManager-593"><span class="linenos">593</span></a><span class="sd">        Update the maximum number of snapshots to store.</span>
</span><span id="SnapshotManager-594"><a href="#SnapshotManager-594"><span class="linenos">594</span></a>
</span><span id="SnapshotManager-595"><a href="#SnapshotManager-595"><span class="linenos">595</span></a><span class="sd">        This method adjusts the maximum limit for the number of snapshots stored by the manager.</span>
</span><span id="SnapshotManager-596"><a href="#SnapshotManager-596"><span class="linenos">596</span></a><span class="sd">        If the new limit is smaller than the current number of snapshots, excess snapshots will be removed</span>
</span><span id="SnapshotManager-597"><a href="#SnapshotManager-597"><span class="linenos">597</span></a><span class="sd">        according to the current ranking or creation order.</span>
</span><span id="SnapshotManager-598"><a href="#SnapshotManager-598"><span class="linenos">598</span></a>
</span><span id="SnapshotManager-599"><a href="#SnapshotManager-599"><span class="linenos">599</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager-600"><a href="#SnapshotManager-600"><span class="linenos">600</span></a><span class="sd">            max_snapshots (int): The new maximum number of snapshots to retain. If None, no limit is enforced.</span>
</span><span id="SnapshotManager-601"><a href="#SnapshotManager-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager-602"><a href="#SnapshotManager-602"><span class="linenos">602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_max_snapshots</span><span class="p">(</span><span class="n">max_snapshots</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A manager for storing and managing data snapshots.</p>
</div>


                            <div id="SnapshotManager.__init__" class="classattr">
                                        <input id="SnapshotManager.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SnapshotManager</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">deepcopy_on_save</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">deepcopy_on_retrieve</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">query_class</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">max_snapshots</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cmp</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="SnapshotManager.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.__init__-17"><a href="#SnapshotManager.__init__-17"><span class="linenos">17</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SnapshotManager.__init__-18"><a href="#SnapshotManager.__init__-18"><span class="linenos">18</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-19"><a href="#SnapshotManager.__init__-19"><span class="linenos">19</span></a>        <span class="n">deepcopy_on_save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-20"><a href="#SnapshotManager.__init__-20"><span class="linenos">20</span></a>        <span class="n">deepcopy_on_retrieve</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-21"><a href="#SnapshotManager.__init__-21"><span class="linenos">21</span></a>        <span class="n">query_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-22"><a href="#SnapshotManager.__init__-22"><span class="linenos">22</span></a>        <span class="n">max_snapshots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-23"><a href="#SnapshotManager.__init__-23"><span class="linenos">23</span></a>        <span class="n">cmp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.__init__-24"><a href="#SnapshotManager.__init__-24"><span class="linenos">24</span></a>    <span class="p">):</span>
</span><span id="SnapshotManager.__init__-25"><a href="#SnapshotManager.__init__-25"><span class="linenos">25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.__init__-26"><a href="#SnapshotManager.__init__-26"><span class="linenos">26</span></a><span class="sd">        Initialize the SnapshotManager.</span>
</span><span id="SnapshotManager.__init__-27"><a href="#SnapshotManager.__init__-27"><span class="linenos">27</span></a>
</span><span id="SnapshotManager.__init__-28"><a href="#SnapshotManager.__init__-28"><span class="linenos">28</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.__init__-29"><a href="#SnapshotManager.__init__-29"><span class="linenos">29</span></a><span class="sd">            deepcopy_on_save (bool): Whether to deepcopy PyTrees when saving snapshots. Defaults to True.</span>
</span><span id="SnapshotManager.__init__-30"><a href="#SnapshotManager.__init__-30"><span class="linenos">30</span></a><span class="sd">            deepcopy_on_retrieve (bool): Whether to return deep copies of PyTrees when retrieving snapshots. Defaults to True.</span>
</span><span id="SnapshotManager.__init__-31"><a href="#SnapshotManager.__init__-31"><span class="linenos">31</span></a><span class="sd">            query_class (type, optional): A class implementing SnapshotQueryInterface. Defaults to SnapshotQuery.</span>
</span><span id="SnapshotManager.__init__-32"><a href="#SnapshotManager.__init__-32"><span class="linenos">32</span></a><span class="sd">            max_snapshots (int, optional): Maximum number of snapshots to store. Defaults to None (no limit).</span>
</span><span id="SnapshotManager.__init__-33"><a href="#SnapshotManager.__init__-33"><span class="linenos">33</span></a><span class="sd">            cmp (callable, optional): A comparison function to order snapshots, also used to decide which snapshot to remove</span>
</span><span id="SnapshotManager.__init__-34"><a href="#SnapshotManager.__init__-34"><span class="linenos">34</span></a><span class="sd">                                            when the storage limit is reached. Defaults to None.</span>
</span><span id="SnapshotManager.__init__-35"><a href="#SnapshotManager.__init__-35"><span class="linenos">35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.__init__-36"><a href="#SnapshotManager.__init__-36"><span class="linenos">36</span></a>        <span class="k">if</span> <span class="n">query_class</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">query_class</span><span class="p">,</span> <span class="n">SnapshotQueryInterface</span><span class="p">):</span>
</span><span id="SnapshotManager.__init__-37"><a href="#SnapshotManager.__init__-37"><span class="linenos">37</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;query_class must implement SnapshotQueryInterface.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.__init__-38"><a href="#SnapshotManager.__init__-38"><span class="linenos">38</span></a>
</span><span id="SnapshotManager.__init__-39"><a href="#SnapshotManager.__init__-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">SnapshotStorage</span><span class="p">(</span><span class="n">max_snapshots</span><span class="o">=</span><span class="n">max_snapshots</span><span class="p">,</span> <span class="n">cmp</span><span class="o">=</span><span class="n">cmp</span><span class="p">)</span>
</span><span id="SnapshotManager.__init__-40"><a href="#SnapshotManager.__init__-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="n">query_class</span> <span class="ow">or</span> <span class="n">SnapshotQuery</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</span><span id="SnapshotManager.__init__-41"><a href="#SnapshotManager.__init__-41"><span class="linenos">41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_save</span> <span class="o">=</span> <span class="n">deepcopy_on_save</span>
</span><span id="SnapshotManager.__init__-42"><a href="#SnapshotManager.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_retrieve</span> <span class="o">=</span> <span class="n">deepcopy_on_retrieve</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the SnapshotManager.</p>

<p>Args:
    deepcopy_on_save (bool): Whether to deepcopy PyTrees when saving snapshots. Defaults to True.
    deepcopy_on_retrieve (bool): Whether to return deep copies of PyTrees when retrieving snapshots. Defaults to True.
    query_class (type, optional): A class implementing SnapshotQueryInterface. Defaults to SnapshotQuery.
    max_snapshots (int, optional): Maximum number of snapshots to store. Defaults to None (no limit).
    cmp (callable, optional): A comparison function to order snapshots, also used to decide which snapshot to remove
                                    when the storage limit is reached. Defaults to None.</p>
</div>


                            </div>
                            <div id="SnapshotManager.storage" class="classattr">
                                <div class="attr variable">
            <span class="name">storage</span>

        
    </div>
    <a class="headerlink" href="#SnapshotManager.storage"></a>
    
    

                            </div>
                            <div id="SnapshotManager.query" class="classattr">
                                <div class="attr variable">
            <span class="name">query</span>

        
    </div>
    <a class="headerlink" href="#SnapshotManager.query"></a>
    
    

                            </div>
                            <div id="SnapshotManager.deepcopy_on_save" class="classattr">
                                <div class="attr variable">
            <span class="name">deepcopy_on_save</span>

        
    </div>
    <a class="headerlink" href="#SnapshotManager.deepcopy_on_save"></a>
    
    

                            </div>
                            <div id="SnapshotManager.deepcopy_on_retrieve" class="classattr">
                                <div class="attr variable">
            <span class="name">deepcopy_on_retrieve</span>

        
    </div>
    <a class="headerlink" href="#SnapshotManager.deepcopy_on_retrieve"></a>
    
    

                            </div>
                            <div id="SnapshotManager.save_snapshot" class="classattr">
                                        <input id="SnapshotManager.save_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_snapshot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span>,</span><span class="param">	<span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">metadata</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">tags</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">deepcopy</span><span class="o">=&lt;</span><span class="nb">object</span> <span class="nb">object</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.save_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.save_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.save_snapshot-75"><a href="#SnapshotManager.save_snapshot-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">save_snapshot</span><span class="p">(</span>
</span><span id="SnapshotManager.save_snapshot-76"><a href="#SnapshotManager.save_snapshot-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-77"><a href="#SnapshotManager.save_snapshot-77"><span class="linenos"> 77</span></a>        <span class="n">data</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-78"><a href="#SnapshotManager.save_snapshot-78"><span class="linenos"> 78</span></a>        <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-79"><a href="#SnapshotManager.save_snapshot-79"><span class="linenos"> 79</span></a>        <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-80"><a href="#SnapshotManager.save_snapshot-80"><span class="linenos"> 80</span></a>        <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-81"><a href="#SnapshotManager.save_snapshot-81"><span class="linenos"> 81</span></a>        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-82"><a href="#SnapshotManager.save_snapshot-82"><span class="linenos"> 82</span></a>        <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-83"><a href="#SnapshotManager.save_snapshot-83"><span class="linenos"> 83</span></a>    <span class="p">):</span>
</span><span id="SnapshotManager.save_snapshot-84"><a href="#SnapshotManager.save_snapshot-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.save_snapshot-85"><a href="#SnapshotManager.save_snapshot-85"><span class="linenos"> 85</span></a><span class="sd">        Save a new Snapshot or overwrite an existing one.</span>
</span><span id="SnapshotManager.save_snapshot-86"><a href="#SnapshotManager.save_snapshot-86"><span class="linenos"> 86</span></a>
</span><span id="SnapshotManager.save_snapshot-87"><a href="#SnapshotManager.save_snapshot-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.save_snapshot-88"><a href="#SnapshotManager.save_snapshot-88"><span class="linenos"> 88</span></a><span class="sd">            data (Any): The data to store in the Snapshot. Can be any serializable Python object or PyTree.</span>
</span><span id="SnapshotManager.save_snapshot-89"><a href="#SnapshotManager.save_snapshot-89"><span class="linenos"> 89</span></a><span class="sd">            snapshot_id (str, optional): Identifier for the Snapshot. A unique ID is generated if not provided.</span>
</span><span id="SnapshotManager.save_snapshot-90"><a href="#SnapshotManager.save_snapshot-90"><span class="linenos"> 90</span></a><span class="sd">            metadata (dict, optional): Additional metadata to associate with the Snapshot. Defaults to None.</span>
</span><span id="SnapshotManager.save_snapshot-91"><a href="#SnapshotManager.save_snapshot-91"><span class="linenos"> 91</span></a><span class="sd">            tags (list, optional): Tags to categorize or label the Snapshot. Defaults to None.</span>
</span><span id="SnapshotManager.save_snapshot-92"><a href="#SnapshotManager.save_snapshot-92"><span class="linenos"> 92</span></a><span class="sd">            overwrite (bool): Whether to overwrite an existing Snapshot with the same ID. Defaults to False.</span>
</span><span id="SnapshotManager.save_snapshot-93"><a href="#SnapshotManager.save_snapshot-93"><span class="linenos"> 93</span></a><span class="sd">            deepcopy (bool, optional): Whether to deepcopy the data before saving. If not specified,</span>
</span><span id="SnapshotManager.save_snapshot-94"><a href="#SnapshotManager.save_snapshot-94"><span class="linenos"> 94</span></a><span class="sd">                uses the manager&#39;s `deepcopy_on_save` setting.</span>
</span><span id="SnapshotManager.save_snapshot-95"><a href="#SnapshotManager.save_snapshot-95"><span class="linenos"> 95</span></a>
</span><span id="SnapshotManager.save_snapshot-96"><a href="#SnapshotManager.save_snapshot-96"><span class="linenos"> 96</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.save_snapshot-97"><a href="#SnapshotManager.save_snapshot-97"><span class="linenos"> 97</span></a><span class="sd">            str: The ID of the saved Snapshot if successfully added.</span>
</span><span id="SnapshotManager.save_snapshot-98"><a href="#SnapshotManager.save_snapshot-98"><span class="linenos"> 98</span></a><span class="sd">            bool: False if the Snapshot was not saved due to storage constraints.</span>
</span><span id="SnapshotManager.save_snapshot-99"><a href="#SnapshotManager.save_snapshot-99"><span class="linenos"> 99</span></a>
</span><span id="SnapshotManager.save_snapshot-100"><a href="#SnapshotManager.save_snapshot-100"><span class="linenos">100</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.save_snapshot-101"><a href="#SnapshotManager.save_snapshot-101"><span class="linenos">101</span></a><span class="sd">            ValueError: If attempting to save a Snapshot with an existing ID without `overwrite=True`.</span>
</span><span id="SnapshotManager.save_snapshot-102"><a href="#SnapshotManager.save_snapshot-102"><span class="linenos">102</span></a><span class="sd">            TypeError: If `tags` or `metadata` is not of the correct type.</span>
</span><span id="SnapshotManager.save_snapshot-103"><a href="#SnapshotManager.save_snapshot-103"><span class="linenos">103</span></a>
</span><span id="SnapshotManager.save_snapshot-104"><a href="#SnapshotManager.save_snapshot-104"><span class="linenos">104</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.save_snapshot-105"><a href="#SnapshotManager.save_snapshot-105"><span class="linenos">105</span></a><span class="sd">            Save a simple data structure:</span>
</span><span id="SnapshotManager.save_snapshot-106"><a href="#SnapshotManager.save_snapshot-106"><span class="linenos">106</span></a><span class="sd">                manager.save_snapshot({&quot;key&quot;: &quot;value&quot;}, tags=[&quot;example&quot;], metadata={&quot;desc&quot;: &quot;test&quot;})</span>
</span><span id="SnapshotManager.save_snapshot-107"><a href="#SnapshotManager.save_snapshot-107"><span class="linenos">107</span></a>
</span><span id="SnapshotManager.save_snapshot-108"><a href="#SnapshotManager.save_snapshot-108"><span class="linenos">108</span></a><span class="sd">            Overwrite an existing snapshot:</span>
</span><span id="SnapshotManager.save_snapshot-109"><a href="#SnapshotManager.save_snapshot-109"><span class="linenos">109</span></a><span class="sd">                manager.save_snapshot(data, snapshot_id=&quot;existing_id&quot;, overwrite=True)</span>
</span><span id="SnapshotManager.save_snapshot-110"><a href="#SnapshotManager.save_snapshot-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.save_snapshot-111"><a href="#SnapshotManager.save_snapshot-111"><span class="linenos">111</span></a>
</span><span id="SnapshotManager.save_snapshot-112"><a href="#SnapshotManager.save_snapshot-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="SnapshotManager.save_snapshot-113"><a href="#SnapshotManager.save_snapshot-113"><span class="linenos">113</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tags must be a list.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.save_snapshot-114"><a href="#SnapshotManager.save_snapshot-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="SnapshotManager.save_snapshot-115"><a href="#SnapshotManager.save_snapshot-115"><span class="linenos">115</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;metadata must be a dictionary.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.save_snapshot-116"><a href="#SnapshotManager.save_snapshot-116"><span class="linenos">116</span></a>
</span><span id="SnapshotManager.save_snapshot-117"><a href="#SnapshotManager.save_snapshot-117"><span class="linenos">117</span></a>        <span class="n">deepcopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_save</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">is</span> <span class="n">DEFAULT</span> <span class="k">else</span> <span class="n">deepcopy</span>
</span><span id="SnapshotManager.save_snapshot-118"><a href="#SnapshotManager.save_snapshot-118"><span class="linenos">118</span></a>
</span><span id="SnapshotManager.save_snapshot-119"><a href="#SnapshotManager.save_snapshot-119"><span class="linenos">119</span></a>        <span class="c1"># Check if overwriting is not allowed</span>
</span><span id="SnapshotManager.save_snapshot-120"><a href="#SnapshotManager.save_snapshot-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">has_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager.save_snapshot-121"><a href="#SnapshotManager.save_snapshot-121"><span class="linenos">121</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SnapshotManager.save_snapshot-122"><a href="#SnapshotManager.save_snapshot-122"><span class="linenos">122</span></a>                <span class="sa">f</span><span class="s2">&quot;Snapshot ID &#39;</span><span class="si">{</span><span class="n">snapshot_id</span><span class="si">}</span><span class="s2">&#39; already exists. Set `overwrite=True` to replace it.&quot;</span>
</span><span id="SnapshotManager.save_snapshot-123"><a href="#SnapshotManager.save_snapshot-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="SnapshotManager.save_snapshot-124"><a href="#SnapshotManager.save_snapshot-124"><span class="linenos">124</span></a>
</span><span id="SnapshotManager.save_snapshot-125"><a href="#SnapshotManager.save_snapshot-125"><span class="linenos">125</span></a>        <span class="c1"># Create the snapshot using the factory method</span>
</span><span id="SnapshotManager.save_snapshot-126"><a href="#SnapshotManager.save_snapshot-126"><span class="linenos">126</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_snapshot</span><span class="p">(</span>
</span><span id="SnapshotManager.save_snapshot-127"><a href="#SnapshotManager.save_snapshot-127"><span class="linenos">127</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-128"><a href="#SnapshotManager.save_snapshot-128"><span class="linenos">128</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-129"><a href="#SnapshotManager.save_snapshot-129"><span class="linenos">129</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-130"><a href="#SnapshotManager.save_snapshot-130"><span class="linenos">130</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-131"><a href="#SnapshotManager.save_snapshot-131"><span class="linenos">131</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">,</span>
</span><span id="SnapshotManager.save_snapshot-132"><a href="#SnapshotManager.save_snapshot-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="SnapshotManager.save_snapshot-133"><a href="#SnapshotManager.save_snapshot-133"><span class="linenos">133</span></a>
</span><span id="SnapshotManager.save_snapshot-134"><a href="#SnapshotManager.save_snapshot-134"><span class="linenos">134</span></a>        <span class="c1"># Add the snapshot to storage</span>
</span><span id="SnapshotManager.save_snapshot-135"><a href="#SnapshotManager.save_snapshot-135"><span class="linenos">135</span></a>
</span><span id="SnapshotManager.save_snapshot-136"><a href="#SnapshotManager.save_snapshot-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">add_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">):</span>
</span><span id="SnapshotManager.save_snapshot-137"><a href="#SnapshotManager.save_snapshot-137"><span class="linenos">137</span></a>            <span class="c1"># Snapshot was not added due to storage constraints / cmp policy</span>
</span><span id="SnapshotManager.save_snapshot-138"><a href="#SnapshotManager.save_snapshot-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="SnapshotManager.save_snapshot-139"><a href="#SnapshotManager.save_snapshot-139"><span class="linenos">139</span></a>
</span><span id="SnapshotManager.save_snapshot-140"><a href="#SnapshotManager.save_snapshot-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">id</span>
</span></pre></div>


            <div class="docstring"><p>Save a new Snapshot or overwrite an existing one.</p>

<p>Args:
    data (Any): The data to store in the Snapshot. Can be any serializable Python object or PyTree.
    snapshot_id (str, optional): Identifier for the Snapshot. A unique ID is generated if not provided.
    metadata (dict, optional): Additional metadata to associate with the Snapshot. Defaults to None.
    tags (list, optional): Tags to categorize or label the Snapshot. Defaults to None.
    overwrite (bool): Whether to overwrite an existing Snapshot with the same ID. Defaults to False.
    deepcopy (bool, optional): Whether to deepcopy the data before saving. If not specified,
        uses the manager's <code><a href="#SnapshotManager.deepcopy_on_save">deepcopy_on_save</a></code> setting.</p>

<p>Returns:
    str: The ID of the saved Snapshot if successfully added.
    bool: False if the Snapshot was not saved due to storage constraints.</p>

<p>Raises:
    ValueError: If attempting to save a Snapshot with an existing ID without <code>overwrite=True</code>.
    TypeError: If <code>tags</code> or <code>metadata</code> is not of the correct type.</p>

<p>Examples:
    Save a simple data structure:
        manager.save_snapshot({"key": "value"}, tags=["example"], metadata={"desc": "test"})</p>

<pre><code>Overwrite an existing snapshot:
    manager.save_snapshot(data, snapshot_id="existing_id", overwrite=True)
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.get_snapshot" class="classattr">
                                        <input id="SnapshotManager.get_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=&lt;</span><span class="nb">object</span> <span class="nb">object</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_snapshot-142"><a href="#SnapshotManager.get_snapshot-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="nf">get_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager.get_snapshot-143"><a href="#SnapshotManager.get_snapshot-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot-144"><a href="#SnapshotManager.get_snapshot-144"><span class="linenos">144</span></a><span class="sd">        Retrieve a Snapshot by its unique ID.</span>
</span><span id="SnapshotManager.get_snapshot-145"><a href="#SnapshotManager.get_snapshot-145"><span class="linenos">145</span></a>
</span><span id="SnapshotManager.get_snapshot-146"><a href="#SnapshotManager.get_snapshot-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_snapshot-147"><a href="#SnapshotManager.get_snapshot-147"><span class="linenos">147</span></a><span class="sd">            snapshot_id (str): The unique identifier of the Snapshot to retrieve.</span>
</span><span id="SnapshotManager.get_snapshot-148"><a href="#SnapshotManager.get_snapshot-148"><span class="linenos">148</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot&#39;s data.</span>
</span><span id="SnapshotManager.get_snapshot-149"><a href="#SnapshotManager.get_snapshot-149"><span class="linenos">149</span></a><span class="sd">                If not specified, defaults to the manager&#39;s `deepcopy_on_retrieve` setting.</span>
</span><span id="SnapshotManager.get_snapshot-150"><a href="#SnapshotManager.get_snapshot-150"><span class="linenos">150</span></a>
</span><span id="SnapshotManager.get_snapshot-151"><a href="#SnapshotManager.get_snapshot-151"><span class="linenos">151</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_snapshot-152"><a href="#SnapshotManager.get_snapshot-152"><span class="linenos">152</span></a><span class="sd">            Snapshot: The Snapshot object associated with the given ID.</span>
</span><span id="SnapshotManager.get_snapshot-153"><a href="#SnapshotManager.get_snapshot-153"><span class="linenos">153</span></a>
</span><span id="SnapshotManager.get_snapshot-154"><a href="#SnapshotManager.get_snapshot-154"><span class="linenos">154</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_snapshot-155"><a href="#SnapshotManager.get_snapshot-155"><span class="linenos">155</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager.get_snapshot-156"><a href="#SnapshotManager.get_snapshot-156"><span class="linenos">156</span></a>
</span><span id="SnapshotManager.get_snapshot-157"><a href="#SnapshotManager.get_snapshot-157"><span class="linenos">157</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_snapshot-158"><a href="#SnapshotManager.get_snapshot-158"><span class="linenos">158</span></a><span class="sd">            Retrieve a Snapshot with a deep copy:</span>
</span><span id="SnapshotManager.get_snapshot-159"><a href="#SnapshotManager.get_snapshot-159"><span class="linenos">159</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;example_id&quot;, deepcopy=True)</span>
</span><span id="SnapshotManager.get_snapshot-160"><a href="#SnapshotManager.get_snapshot-160"><span class="linenos">160</span></a>
</span><span id="SnapshotManager.get_snapshot-161"><a href="#SnapshotManager.get_snapshot-161"><span class="linenos">161</span></a><span class="sd">            Retrieve a Snapshot without a deep copy:</span>
</span><span id="SnapshotManager.get_snapshot-162"><a href="#SnapshotManager.get_snapshot-162"><span class="linenos">162</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;example_id&quot;, deepcopy=False)</span>
</span><span id="SnapshotManager.get_snapshot-163"><a href="#SnapshotManager.get_snapshot-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot-164"><a href="#SnapshotManager.get_snapshot-164"><span class="linenos">164</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.get_snapshot-165"><a href="#SnapshotManager.get_snapshot-165"><span class="linenos">165</span></a>
</span><span id="SnapshotManager.get_snapshot-166"><a href="#SnapshotManager.get_snapshot-166"><span class="linenos">166</span></a>        <span class="n">deepcopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy_on_retrieve</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">is</span> <span class="n">DEFAULT</span> <span class="k">else</span> <span class="n">deepcopy</span>
</span><span id="SnapshotManager.get_snapshot-167"><a href="#SnapshotManager.get_snapshot-167"><span class="linenos">167</span></a>
</span><span id="SnapshotManager.get_snapshot-168"><a href="#SnapshotManager.get_snapshot-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="n">snapshot</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve a Snapshot by its unique ID.</p>

<p>Args:
    snapshot_id (str): The unique identifier of the Snapshot to retrieve.
    deepcopy (bool, optional): Whether to return a deep copy of the Snapshot's data.
        If not specified, defaults to the manager's <code><a href="#SnapshotManager.deepcopy_on_retrieve">deepcopy_on_retrieve</a></code> setting.</p>

<p>Returns:
    Snapshot: The Snapshot object associated with the given ID.</p>

<p>Raises:
    ValueError: If the Snapshot ID does not exist in the storage.</p>

<p>Examples:
    Retrieve a Snapshot with a deep copy:
        snapshot = manager.get_snapshot("example_id", deepcopy=True)</p>

<pre><code>Retrieve a Snapshot without a deep copy:
    snapshot = manager.get_snapshot("example_id", deepcopy=False)
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.get_latest_snapshot" class="classattr">
                                        <input id="SnapshotManager.get_latest_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_latest_snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=&lt;</span><span class="nb">object</span> <span class="nb">object</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_latest_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_latest_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_latest_snapshot-170"><a href="#SnapshotManager.get_latest_snapshot-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">get_latest_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager.get_latest_snapshot-171"><a href="#SnapshotManager.get_latest_snapshot-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_latest_snapshot-172"><a href="#SnapshotManager.get_latest_snapshot-172"><span class="linenos">172</span></a><span class="sd">        Retrieve the most recently added Snapshot.</span>
</span><span id="SnapshotManager.get_latest_snapshot-173"><a href="#SnapshotManager.get_latest_snapshot-173"><span class="linenos">173</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-174"><a href="#SnapshotManager.get_latest_snapshot-174"><span class="linenos">174</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_latest_snapshot-175"><a href="#SnapshotManager.get_latest_snapshot-175"><span class="linenos">175</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot&#39;s data.</span>
</span><span id="SnapshotManager.get_latest_snapshot-176"><a href="#SnapshotManager.get_latest_snapshot-176"><span class="linenos">176</span></a><span class="sd">                If not specified, defaults to the manager&#39;s `deepcopy_on_retrieve` setting.</span>
</span><span id="SnapshotManager.get_latest_snapshot-177"><a href="#SnapshotManager.get_latest_snapshot-177"><span class="linenos">177</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-178"><a href="#SnapshotManager.get_latest_snapshot-178"><span class="linenos">178</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_latest_snapshot-179"><a href="#SnapshotManager.get_latest_snapshot-179"><span class="linenos">179</span></a><span class="sd">            Snapshot: The most recently added Snapshot object.</span>
</span><span id="SnapshotManager.get_latest_snapshot-180"><a href="#SnapshotManager.get_latest_snapshot-180"><span class="linenos">180</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-181"><a href="#SnapshotManager.get_latest_snapshot-181"><span class="linenos">181</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_latest_snapshot-182"><a href="#SnapshotManager.get_latest_snapshot-182"><span class="linenos">182</span></a><span class="sd">            IndexError: If no snapshots are stored.</span>
</span><span id="SnapshotManager.get_latest_snapshot-183"><a href="#SnapshotManager.get_latest_snapshot-183"><span class="linenos">183</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-184"><a href="#SnapshotManager.get_latest_snapshot-184"><span class="linenos">184</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_latest_snapshot-185"><a href="#SnapshotManager.get_latest_snapshot-185"><span class="linenos">185</span></a><span class="sd">            Retrieve the latest Snapshot with a deep copy:</span>
</span><span id="SnapshotManager.get_latest_snapshot-186"><a href="#SnapshotManager.get_latest_snapshot-186"><span class="linenos">186</span></a><span class="sd">                latest_snapshot = manager.get_latest_snapshot(deepcopy=True)</span>
</span><span id="SnapshotManager.get_latest_snapshot-187"><a href="#SnapshotManager.get_latest_snapshot-187"><span class="linenos">187</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-188"><a href="#SnapshotManager.get_latest_snapshot-188"><span class="linenos">188</span></a><span class="sd">            Retrieve the latest Snapshot without a deep copy:</span>
</span><span id="SnapshotManager.get_latest_snapshot-189"><a href="#SnapshotManager.get_latest_snapshot-189"><span class="linenos">189</span></a><span class="sd">                latest_snapshot = manager.get_latest_snapshot(deepcopy=False)</span>
</span><span id="SnapshotManager.get_latest_snapshot-190"><a href="#SnapshotManager.get_latest_snapshot-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_latest_snapshot-191"><a href="#SnapshotManager.get_latest_snapshot-191"><span class="linenos">191</span></a>        <span class="c1"># Use storage to get the latest snapshot</span>
</span><span id="SnapshotManager.get_latest_snapshot-192"><a href="#SnapshotManager.get_latest_snapshot-192"><span class="linenos">192</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-193"><a href="#SnapshotManager.get_latest_snapshot-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">:</span>
</span><span id="SnapshotManager.get_latest_snapshot-194"><a href="#SnapshotManager.get_latest_snapshot-194"><span class="linenos">194</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;No snapshots are available.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.get_latest_snapshot-195"><a href="#SnapshotManager.get_latest_snapshot-195"><span class="linenos">195</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-196"><a href="#SnapshotManager.get_latest_snapshot-196"><span class="linenos">196</span></a>        <span class="c1"># Use storage to get the latest snapshot ID</span>
</span><span id="SnapshotManager.get_latest_snapshot-197"><a href="#SnapshotManager.get_latest_snapshot-197"><span class="linenos">197</span></a>        <span class="n">latest_snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SnapshotManager.get_latest_snapshot-198"><a href="#SnapshotManager.get_latest_snapshot-198"><span class="linenos">198</span></a>
</span><span id="SnapshotManager.get_latest_snapshot-199"><a href="#SnapshotManager.get_latest_snapshot-199"><span class="linenos">199</span></a>        <span class="c1"># Retrieve the snapshot using the get_snapshot method</span>
</span><span id="SnapshotManager.get_latest_snapshot-200"><a href="#SnapshotManager.get_latest_snapshot-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">latest_snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the most recently added Snapshot.</p>

<p>Args:
    deepcopy (bool, optional): Whether to return a deep copy of the Snapshot's data.
        If not specified, defaults to the manager's <code><a href="#SnapshotManager.deepcopy_on_retrieve">deepcopy_on_retrieve</a></code> setting.</p>

<p>Returns:
    Snapshot: The most recently added Snapshot object.</p>

<p>Raises:
    IndexError: If no snapshots are stored.</p>

<p>Examples:
    Retrieve the latest Snapshot with a deep copy:
        latest_snapshot = manager.get_latest_snapshot(deepcopy=True)</p>

<pre><code>Retrieve the latest Snapshot without a deep copy:
    latest_snapshot = manager.get_latest_snapshot(deepcopy=False)
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.get_ids_by_rank" class="classattr">
                                        <input id="SnapshotManager.get_ids_by_rank-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_ids_by_rank</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_ids_by_rank-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_ids_by_rank"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_ids_by_rank-202"><a href="#SnapshotManager.get_ids_by_rank-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">get_ids_by_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.get_ids_by_rank-203"><a href="#SnapshotManager.get_ids_by_rank-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_ids_by_rank-204"><a href="#SnapshotManager.get_ids_by_rank-204"><span class="linenos">204</span></a><span class="sd">        Retrieve a list of snapshot IDs ranked according to the comparison function.</span>
</span><span id="SnapshotManager.get_ids_by_rank-205"><a href="#SnapshotManager.get_ids_by_rank-205"><span class="linenos">205</span></a>
</span><span id="SnapshotManager.get_ids_by_rank-206"><a href="#SnapshotManager.get_ids_by_rank-206"><span class="linenos">206</span></a><span class="sd">        If a custom comparison function (`cmp`) was provided during the initialization of</span>
</span><span id="SnapshotManager.get_ids_by_rank-207"><a href="#SnapshotManager.get_ids_by_rank-207"><span class="linenos">207</span></a><span class="sd">        the manager, the snapshots will be ranked based on that function. If no comparison function</span>
</span><span id="SnapshotManager.get_ids_by_rank-208"><a href="#SnapshotManager.get_ids_by_rank-208"><span class="linenos">208</span></a><span class="sd">        is defined, the snapshots are ranked by their creation time in insertion order.</span>
</span><span id="SnapshotManager.get_ids_by_rank-209"><a href="#SnapshotManager.get_ids_by_rank-209"><span class="linenos">209</span></a>
</span><span id="SnapshotManager.get_ids_by_rank-210"><a href="#SnapshotManager.get_ids_by_rank-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_ids_by_rank-211"><a href="#SnapshotManager.get_ids_by_rank-211"><span class="linenos">211</span></a><span class="sd">            list[str]: A list of snapshot IDs ranked according to the defined criteria.</span>
</span><span id="SnapshotManager.get_ids_by_rank-212"><a href="#SnapshotManager.get_ids_by_rank-212"><span class="linenos">212</span></a>
</span><span id="SnapshotManager.get_ids_by_rank-213"><a href="#SnapshotManager.get_ids_by_rank-213"><span class="linenos">213</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_ids_by_rank-214"><a href="#SnapshotManager.get_ids_by_rank-214"><span class="linenos">214</span></a><span class="sd">            Retrieve snapshot IDs ranked by a custom comparison:</span>
</span><span id="SnapshotManager.get_ids_by_rank-215"><a href="#SnapshotManager.get_ids_by_rank-215"><span class="linenos">215</span></a><span class="sd">                ranked_ids = manager.get_ids_by_rank()</span>
</span><span id="SnapshotManager.get_ids_by_rank-216"><a href="#SnapshotManager.get_ids_by_rank-216"><span class="linenos">216</span></a>
</span><span id="SnapshotManager.get_ids_by_rank-217"><a href="#SnapshotManager.get_ids_by_rank-217"><span class="linenos">217</span></a><span class="sd">            If no comparison function is defined:</span>
</span><span id="SnapshotManager.get_ids_by_rank-218"><a href="#SnapshotManager.get_ids_by_rank-218"><span class="linenos">218</span></a><span class="sd">                ranked_ids = manager.get_ids_by_rank()  # Returns IDs in insertion order</span>
</span><span id="SnapshotManager.get_ids_by_rank-219"><a href="#SnapshotManager.get_ids_by_rank-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_ids_by_rank-220"><a href="#SnapshotManager.get_ids_by_rank-220"><span class="linenos">220</span></a>
</span><span id="SnapshotManager.get_ids_by_rank-221"><a href="#SnapshotManager.get_ids_by_rank-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_ids_by_rank</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve a list of snapshot IDs ranked according to the comparison function.</p>

<p>If a custom comparison function (<code>cmp</code>) was provided during the initialization of
the manager, the snapshots will be ranked based on that function. If no comparison function
is defined, the snapshots are ranked by their creation time in insertion order.</p>

<p>Returns:
    list[str]: A list of snapshot IDs ranked according to the defined criteria.</p>

<p>Examples:
    Retrieve snapshot IDs ranked by a custom comparison:
        ranked_ids = manager.get_ids_by_rank()</p>

<pre><code>If no comparison function is defined:
    ranked_ids = manager.get_ids_by_rank()  # Returns IDs in insertion order
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.resort" class="classattr">
                                        <input id="SnapshotManager.resort-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resort</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.resort-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.resort"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.resort-223"><a href="#SnapshotManager.resort-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">resort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.resort-224"><a href="#SnapshotManager.resort-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.resort-225"><a href="#SnapshotManager.resort-225"><span class="linenos">225</span></a><span class="sd">        Re-sort the snapshots in storage according to the current comparison function if available.</span>
</span><span id="SnapshotManager.resort-226"><a href="#SnapshotManager.resort-226"><span class="linenos">226</span></a>
</span><span id="SnapshotManager.resort-227"><a href="#SnapshotManager.resort-227"><span class="linenos">227</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.resort-228"><a href="#SnapshotManager.resort-228"><span class="linenos">228</span></a><span class="sd">            None</span>
</span><span id="SnapshotManager.resort-229"><a href="#SnapshotManager.resort-229"><span class="linenos">229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.resort-230"><a href="#SnapshotManager.resort-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">resort</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Re-sort the snapshots in storage according to the current comparison function if available.</p>

<p>Returns:
    None</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_ids_by_insertion_order" class="classattr">
                                        <input id="SnapshotManager.get_ids_by_insertion_order-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_ids_by_insertion_order</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_ids_by_insertion_order-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_ids_by_insertion_order"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_ids_by_insertion_order-232"><a href="#SnapshotManager.get_ids_by_insertion_order-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">get_ids_by_insertion_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-233"><a href="#SnapshotManager.get_ids_by_insertion_order-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-234"><a href="#SnapshotManager.get_ids_by_insertion_order-234"><span class="linenos">234</span></a><span class="sd">        Retrieve a list of snapshot IDs in the order they were added.</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-235"><a href="#SnapshotManager.get_ids_by_insertion_order-235"><span class="linenos">235</span></a>
</span><span id="SnapshotManager.get_ids_by_insertion_order-236"><a href="#SnapshotManager.get_ids_by_insertion_order-236"><span class="linenos">236</span></a><span class="sd">        This method returns the snapshot IDs in the exact sequence they were created or added</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-237"><a href="#SnapshotManager.get_ids_by_insertion_order-237"><span class="linenos">237</span></a><span class="sd">        to the manager. Unlike ranked snapshots, this order is based purely on the creation</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-238"><a href="#SnapshotManager.get_ids_by_insertion_order-238"><span class="linenos">238</span></a><span class="sd">        or insertion order, unaffected by any cmp or ranking logic.</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-239"><a href="#SnapshotManager.get_ids_by_insertion_order-239"><span class="linenos">239</span></a>
</span><span id="SnapshotManager.get_ids_by_insertion_order-240"><a href="#SnapshotManager.get_ids_by_insertion_order-240"><span class="linenos">240</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-241"><a href="#SnapshotManager.get_ids_by_insertion_order-241"><span class="linenos">241</span></a><span class="sd">            list[str]: A list of snapshot IDs ordered by their insertion sequence.</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-242"><a href="#SnapshotManager.get_ids_by_insertion_order-242"><span class="linenos">242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_ids_by_insertion_order-243"><a href="#SnapshotManager.get_ids_by_insertion_order-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_ids_by_insertion_order</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve a list of snapshot IDs in the order they were added.</p>

<p>This method returns the snapshot IDs in the exact sequence they were created or added
to the manager. Unlike ranked snapshots, this order is based purely on the creation
or insertion order, unaffected by any cmp or ranking logic.</p>

<p>Returns:
    list[str]: A list of snapshot IDs ordered by their insertion sequence.</p>
</div>


                            </div>
                            <div id="SnapshotManager.remove_snapshot" class="classattr">
                                        <input id="SnapshotManager.remove_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.remove_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.remove_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.remove_snapshot-245"><a href="#SnapshotManager.remove_snapshot-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">remove_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager.remove_snapshot-246"><a href="#SnapshotManager.remove_snapshot-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_snapshot-247"><a href="#SnapshotManager.remove_snapshot-247"><span class="linenos">247</span></a><span class="sd">        Remove a Snapshot by its unique ID.</span>
</span><span id="SnapshotManager.remove_snapshot-248"><a href="#SnapshotManager.remove_snapshot-248"><span class="linenos">248</span></a>
</span><span id="SnapshotManager.remove_snapshot-249"><a href="#SnapshotManager.remove_snapshot-249"><span class="linenos">249</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.remove_snapshot-250"><a href="#SnapshotManager.remove_snapshot-250"><span class="linenos">250</span></a><span class="sd">            snapshot_id (str): The unique identifier of the Snapshot to remove.</span>
</span><span id="SnapshotManager.remove_snapshot-251"><a href="#SnapshotManager.remove_snapshot-251"><span class="linenos">251</span></a>
</span><span id="SnapshotManager.remove_snapshot-252"><a href="#SnapshotManager.remove_snapshot-252"><span class="linenos">252</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.remove_snapshot-253"><a href="#SnapshotManager.remove_snapshot-253"><span class="linenos">253</span></a><span class="sd">            bool: True if the Snapshot was successfully removed, False if no Snapshot with the</span>
</span><span id="SnapshotManager.remove_snapshot-254"><a href="#SnapshotManager.remove_snapshot-254"><span class="linenos">254</span></a><span class="sd">                given ID exists in storage.</span>
</span><span id="SnapshotManager.remove_snapshot-255"><a href="#SnapshotManager.remove_snapshot-255"><span class="linenos">255</span></a>
</span><span id="SnapshotManager.remove_snapshot-256"><a href="#SnapshotManager.remove_snapshot-256"><span class="linenos">256</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.remove_snapshot-257"><a href="#SnapshotManager.remove_snapshot-257"><span class="linenos">257</span></a><span class="sd">            ValueError: If the provided snapshot_id is not a string.</span>
</span><span id="SnapshotManager.remove_snapshot-258"><a href="#SnapshotManager.remove_snapshot-258"><span class="linenos">258</span></a>
</span><span id="SnapshotManager.remove_snapshot-259"><a href="#SnapshotManager.remove_snapshot-259"><span class="linenos">259</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.remove_snapshot-260"><a href="#SnapshotManager.remove_snapshot-260"><span class="linenos">260</span></a><span class="sd">            Remove a Snapshot by ID:</span>
</span><span id="SnapshotManager.remove_snapshot-261"><a href="#SnapshotManager.remove_snapshot-261"><span class="linenos">261</span></a><span class="sd">                success = manager.remove_snapshot(&quot;example_id&quot;)</span>
</span><span id="SnapshotManager.remove_snapshot-262"><a href="#SnapshotManager.remove_snapshot-262"><span class="linenos">262</span></a><span class="sd">                if success:</span>
</span><span id="SnapshotManager.remove_snapshot-263"><a href="#SnapshotManager.remove_snapshot-263"><span class="linenos">263</span></a><span class="sd">                    print(&quot;Snapshot removed.&quot;)</span>
</span><span id="SnapshotManager.remove_snapshot-264"><a href="#SnapshotManager.remove_snapshot-264"><span class="linenos">264</span></a><span class="sd">                else:</span>
</span><span id="SnapshotManager.remove_snapshot-265"><a href="#SnapshotManager.remove_snapshot-265"><span class="linenos">265</span></a><span class="sd">                    print(&quot;Snapshot ID not found.&quot;)</span>
</span><span id="SnapshotManager.remove_snapshot-266"><a href="#SnapshotManager.remove_snapshot-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_snapshot-267"><a href="#SnapshotManager.remove_snapshot-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SnapshotManager.remove_snapshot-268"><a href="#SnapshotManager.remove_snapshot-268"><span class="linenos">268</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot ID must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.remove_snapshot-269"><a href="#SnapshotManager.remove_snapshot-269"><span class="linenos">269</span></a>
</span><span id="SnapshotManager.remove_snapshot-270"><a href="#SnapshotManager.remove_snapshot-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">remove_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Remove a Snapshot by its unique ID.</p>

<p>Args:
    snapshot_id (str): The unique identifier of the Snapshot to remove.</p>

<p>Returns:
    bool: True if the Snapshot was successfully removed, False if no Snapshot with the
        given ID exists in storage.</p>

<p>Raises:
    ValueError: If the provided snapshot_id is not a string.</p>

<p>Examples:
    Remove a Snapshot by ID:
        success = manager.remove_snapshot("example_id")
        if success:
            print("Snapshot removed.")
        else:
            print("Snapshot ID not found.")</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_metadata" class="classattr">
                                        <input id="SnapshotManager.get_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_metadata-272"><a href="#SnapshotManager.get_metadata-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager.get_metadata-273"><a href="#SnapshotManager.get_metadata-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_metadata-274"><a href="#SnapshotManager.get_metadata-274"><span class="linenos">274</span></a><span class="sd">        Retrieve the metadata associated with a specific Snapshot.</span>
</span><span id="SnapshotManager.get_metadata-275"><a href="#SnapshotManager.get_metadata-275"><span class="linenos">275</span></a>
</span><span id="SnapshotManager.get_metadata-276"><a href="#SnapshotManager.get_metadata-276"><span class="linenos">276</span></a><span class="sd">        This method fetches the metadata stored alongside the Snapshot identified by `snapshot_id`.</span>
</span><span id="SnapshotManager.get_metadata-277"><a href="#SnapshotManager.get_metadata-277"><span class="linenos">277</span></a><span class="sd">        Metadata typically contains additional descriptive information about the Snapshot.</span>
</span><span id="SnapshotManager.get_metadata-278"><a href="#SnapshotManager.get_metadata-278"><span class="linenos">278</span></a>
</span><span id="SnapshotManager.get_metadata-279"><a href="#SnapshotManager.get_metadata-279"><span class="linenos">279</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_metadata-280"><a href="#SnapshotManager.get_metadata-280"><span class="linenos">280</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot whose metadata is to be retrieved.</span>
</span><span id="SnapshotManager.get_metadata-281"><a href="#SnapshotManager.get_metadata-281"><span class="linenos">281</span></a>
</span><span id="SnapshotManager.get_metadata-282"><a href="#SnapshotManager.get_metadata-282"><span class="linenos">282</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_metadata-283"><a href="#SnapshotManager.get_metadata-283"><span class="linenos">283</span></a><span class="sd">            dict: The metadata dictionary associated with the Snapshot.</span>
</span><span id="SnapshotManager.get_metadata-284"><a href="#SnapshotManager.get_metadata-284"><span class="linenos">284</span></a>
</span><span id="SnapshotManager.get_metadata-285"><a href="#SnapshotManager.get_metadata-285"><span class="linenos">285</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_metadata-286"><a href="#SnapshotManager.get_metadata-286"><span class="linenos">286</span></a><span class="sd">            ValueError: If the Snapshot with the given `snapshot_id` does not exist.</span>
</span><span id="SnapshotManager.get_metadata-287"><a href="#SnapshotManager.get_metadata-287"><span class="linenos">287</span></a>
</span><span id="SnapshotManager.get_metadata-288"><a href="#SnapshotManager.get_metadata-288"><span class="linenos">288</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_metadata-289"><a href="#SnapshotManager.get_metadata-289"><span class="linenos">289</span></a><span class="sd">            Retrieve metadata for a specific Snapshot:</span>
</span><span id="SnapshotManager.get_metadata-290"><a href="#SnapshotManager.get_metadata-290"><span class="linenos">290</span></a><span class="sd">                metadata = manager.get_metadata(&quot;example_snapshot_id&quot;)</span>
</span><span id="SnapshotManager.get_metadata-291"><a href="#SnapshotManager.get_metadata-291"><span class="linenos">291</span></a><span class="sd">                print(metadata)</span>
</span><span id="SnapshotManager.get_metadata-292"><a href="#SnapshotManager.get_metadata-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_metadata-293"><a href="#SnapshotManager.get_metadata-293"><span class="linenos">293</span></a>
</span><span id="SnapshotManager.get_metadata-294"><a href="#SnapshotManager.get_metadata-294"><span class="linenos">294</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.get_metadata-295"><a href="#SnapshotManager.get_metadata-295"><span class="linenos">295</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">metadata</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the metadata associated with a specific Snapshot.</p>

<p>This method fetches the metadata stored alongside the Snapshot identified by <code>snapshot_id</code>.
Metadata typically contains additional descriptive information about the Snapshot.</p>

<p>Args:
    snapshot_id (str): The unique ID of the Snapshot whose metadata is to be retrieved.</p>

<p>Returns:
    dict: The metadata dictionary associated with the Snapshot.</p>

<p>Raises:
    ValueError: If the Snapshot with the given <code>snapshot_id</code> does not exist.</p>

<p>Examples:
    Retrieve metadata for a specific Snapshot:
        metadata = manager.get_metadata("example_snapshot_id")
        print(metadata)</p>
</div>


                            </div>
                            <div id="SnapshotManager.update_metadata" class="classattr">
                                        <input id="SnapshotManager.update_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span>, </span><span class="param"><span class="n">new_metadata</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.update_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.update_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.update_metadata-297"><a href="#SnapshotManager.update_metadata-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">new_metadata</span><span class="p">):</span>
</span><span id="SnapshotManager.update_metadata-298"><a href="#SnapshotManager.update_metadata-298"><span class="linenos">298</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_metadata-299"><a href="#SnapshotManager.update_metadata-299"><span class="linenos">299</span></a><span class="sd">        Update the metadata for a specific Snapshot.</span>
</span><span id="SnapshotManager.update_metadata-300"><a href="#SnapshotManager.update_metadata-300"><span class="linenos">300</span></a>
</span><span id="SnapshotManager.update_metadata-301"><a href="#SnapshotManager.update_metadata-301"><span class="linenos">301</span></a><span class="sd">        This method merges the provided `new_metadata` dictionary with the existing metadata</span>
</span><span id="SnapshotManager.update_metadata-302"><a href="#SnapshotManager.update_metadata-302"><span class="linenos">302</span></a><span class="sd">        of the Snapshot identified by `snapshot_id`. Existing keys in the metadata will be</span>
</span><span id="SnapshotManager.update_metadata-303"><a href="#SnapshotManager.update_metadata-303"><span class="linenos">303</span></a><span class="sd">        updated, and new keys will be added.</span>
</span><span id="SnapshotManager.update_metadata-304"><a href="#SnapshotManager.update_metadata-304"><span class="linenos">304</span></a>
</span><span id="SnapshotManager.update_metadata-305"><a href="#SnapshotManager.update_metadata-305"><span class="linenos">305</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.update_metadata-306"><a href="#SnapshotManager.update_metadata-306"><span class="linenos">306</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot to update.</span>
</span><span id="SnapshotManager.update_metadata-307"><a href="#SnapshotManager.update_metadata-307"><span class="linenos">307</span></a><span class="sd">            new_metadata (dict): A dictionary of new metadata to merge with the existing metadata.</span>
</span><span id="SnapshotManager.update_metadata-308"><a href="#SnapshotManager.update_metadata-308"><span class="linenos">308</span></a>
</span><span id="SnapshotManager.update_metadata-309"><a href="#SnapshotManager.update_metadata-309"><span class="linenos">309</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.update_metadata-310"><a href="#SnapshotManager.update_metadata-310"><span class="linenos">310</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in storage.</span>
</span><span id="SnapshotManager.update_metadata-311"><a href="#SnapshotManager.update_metadata-311"><span class="linenos">311</span></a><span class="sd">            TypeError: If `new_metadata` is not a dictionary.</span>
</span><span id="SnapshotManager.update_metadata-312"><a href="#SnapshotManager.update_metadata-312"><span class="linenos">312</span></a>
</span><span id="SnapshotManager.update_metadata-313"><a href="#SnapshotManager.update_metadata-313"><span class="linenos">313</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.update_metadata-314"><a href="#SnapshotManager.update_metadata-314"><span class="linenos">314</span></a><span class="sd">            Update metadata for a snapshot:</span>
</span><span id="SnapshotManager.update_metadata-315"><a href="#SnapshotManager.update_metadata-315"><span class="linenos">315</span></a><span class="sd">                manager.update_metadata(&quot;snap_id&quot;, {&quot;new_key&quot;: &quot;new_value&quot;})</span>
</span><span id="SnapshotManager.update_metadata-316"><a href="#SnapshotManager.update_metadata-316"><span class="linenos">316</span></a>
</span><span id="SnapshotManager.update_metadata-317"><a href="#SnapshotManager.update_metadata-317"><span class="linenos">317</span></a><span class="sd">            Merge additional metadata:</span>
</span><span id="SnapshotManager.update_metadata-318"><a href="#SnapshotManager.update_metadata-318"><span class="linenos">318</span></a><span class="sd">                manager.update_metadata(&quot;snap_id&quot;, {&quot;updated_field&quot;: &quot;new_value&quot;})</span>
</span><span id="SnapshotManager.update_metadata-319"><a href="#SnapshotManager.update_metadata-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_metadata-320"><a href="#SnapshotManager.update_metadata-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="SnapshotManager.update_metadata-321"><a href="#SnapshotManager.update_metadata-321"><span class="linenos">321</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;new_metadata must be a dictionary.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.update_metadata-322"><a href="#SnapshotManager.update_metadata-322"><span class="linenos">322</span></a>
</span><span id="SnapshotManager.update_metadata-323"><a href="#SnapshotManager.update_metadata-323"><span class="linenos">323</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.update_metadata-324"><a href="#SnapshotManager.update_metadata-324"><span class="linenos">324</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update the metadata for a specific Snapshot.</p>

<p>This method merges the provided <code>new_metadata</code> dictionary with the existing metadata
of the Snapshot identified by <code>snapshot_id</code>. Existing keys in the metadata will be
updated, and new keys will be added.</p>

<p>Args:
    snapshot_id (str): The unique ID of the Snapshot to update.
    new_metadata (dict): A dictionary of new metadata to merge with the existing metadata.</p>

<p>Raises:
    ValueError: If the Snapshot ID does not exist in storage.
    TypeError: If <code>new_metadata</code> is not a dictionary.</p>

<p>Examples:
    Update metadata for a snapshot:
        manager.update_metadata("snap_id", {"new_key": "new_value"})</p>

<pre><code>Merge additional metadata:
    manager.update_metadata("snap_id", {"updated_field": "new_value"})
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.add_tags" class="classattr">
                                        <input id="SnapshotManager.add_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span>, </span><span class="param"><span class="n">tags</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.add_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.add_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.add_tags-328"><a href="#SnapshotManager.add_tags-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="nf">add_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="SnapshotManager.add_tags-329"><a href="#SnapshotManager.add_tags-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.add_tags-330"><a href="#SnapshotManager.add_tags-330"><span class="linenos">330</span></a><span class="sd">        Add tags to a Snapshot.</span>
</span><span id="SnapshotManager.add_tags-331"><a href="#SnapshotManager.add_tags-331"><span class="linenos">331</span></a>
</span><span id="SnapshotManager.add_tags-332"><a href="#SnapshotManager.add_tags-332"><span class="linenos">332</span></a><span class="sd">        This method adds the provided tags to the Snapshot identified by `snapshot_id`.</span>
</span><span id="SnapshotManager.add_tags-333"><a href="#SnapshotManager.add_tags-333"><span class="linenos">333</span></a><span class="sd">        Duplicate tags will be ignored, ensuring that each tag appears only once in the Snapshot.</span>
</span><span id="SnapshotManager.add_tags-334"><a href="#SnapshotManager.add_tags-334"><span class="linenos">334</span></a>
</span><span id="SnapshotManager.add_tags-335"><a href="#SnapshotManager.add_tags-335"><span class="linenos">335</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.add_tags-336"><a href="#SnapshotManager.add_tags-336"><span class="linenos">336</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot to which tags should be added.</span>
</span><span id="SnapshotManager.add_tags-337"><a href="#SnapshotManager.add_tags-337"><span class="linenos">337</span></a><span class="sd">            tags (list[str]): A list of tags to add to the Snapshot. Each tag should be a string.</span>
</span><span id="SnapshotManager.add_tags-338"><a href="#SnapshotManager.add_tags-338"><span class="linenos">338</span></a>
</span><span id="SnapshotManager.add_tags-339"><a href="#SnapshotManager.add_tags-339"><span class="linenos">339</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.add_tags-340"><a href="#SnapshotManager.add_tags-340"><span class="linenos">340</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager.add_tags-341"><a href="#SnapshotManager.add_tags-341"><span class="linenos">341</span></a><span class="sd">            TypeError: If `tags` is not a list or contains non-string elements.</span>
</span><span id="SnapshotManager.add_tags-342"><a href="#SnapshotManager.add_tags-342"><span class="linenos">342</span></a>
</span><span id="SnapshotManager.add_tags-343"><a href="#SnapshotManager.add_tags-343"><span class="linenos">343</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.add_tags-344"><a href="#SnapshotManager.add_tags-344"><span class="linenos">344</span></a><span class="sd">            Add new tags to a Snapshot:</span>
</span><span id="SnapshotManager.add_tags-345"><a href="#SnapshotManager.add_tags-345"><span class="linenos">345</span></a><span class="sd">                manager.add_tags(&quot;example_id&quot;, [&quot;important&quot;, &quot;review&quot;])</span>
</span><span id="SnapshotManager.add_tags-346"><a href="#SnapshotManager.add_tags-346"><span class="linenos">346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.add_tags-347"><a href="#SnapshotManager.add_tags-347"><span class="linenos">347</span></a>
</span><span id="SnapshotManager.add_tags-348"><a href="#SnapshotManager.add_tags-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="SnapshotManager.add_tags-349"><a href="#SnapshotManager.add_tags-349"><span class="linenos">349</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tags must be a list.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.add_tags-350"><a href="#SnapshotManager.add_tags-350"><span class="linenos">350</span></a>
</span><span id="SnapshotManager.add_tags-351"><a href="#SnapshotManager.add_tags-351"><span class="linenos">351</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.add_tags-352"><a href="#SnapshotManager.add_tags-352"><span class="linenos">352</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">add_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add tags to a Snapshot.</p>

<p>This method adds the provided tags to the Snapshot identified by <code>snapshot_id</code>.
Duplicate tags will be ignored, ensuring that each tag appears only once in the Snapshot.</p>

<p>Args:
    snapshot_id (str): The unique ID of the Snapshot to which tags should be added.
    tags (list[str]): A list of tags to add to the Snapshot. Each tag should be a string.</p>

<p>Raises:
    ValueError: If the Snapshot ID does not exist in the storage.
    TypeError: If <code>tags</code> is not a list or contains non-string elements.</p>

<p>Examples:
    Add new tags to a Snapshot:
        manager.add_tags("example_id", ["important", "review"])</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_tags" class="classattr">
                                        <input id="SnapshotManager.get_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_tags-354"><a href="#SnapshotManager.get_tags-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="SnapshotManager.get_tags-355"><a href="#SnapshotManager.get_tags-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_tags-356"><a href="#SnapshotManager.get_tags-356"><span class="linenos">356</span></a><span class="sd">        Retrieve the tags associated with a specific Snapshot.</span>
</span><span id="SnapshotManager.get_tags-357"><a href="#SnapshotManager.get_tags-357"><span class="linenos">357</span></a>
</span><span id="SnapshotManager.get_tags-358"><a href="#SnapshotManager.get_tags-358"><span class="linenos">358</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_tags-359"><a href="#SnapshotManager.get_tags-359"><span class="linenos">359</span></a><span class="sd">            snapshot_id (str): The unique ID of the Snapshot whose tags are to be retrieved.</span>
</span><span id="SnapshotManager.get_tags-360"><a href="#SnapshotManager.get_tags-360"><span class="linenos">360</span></a>
</span><span id="SnapshotManager.get_tags-361"><a href="#SnapshotManager.get_tags-361"><span class="linenos">361</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_tags-362"><a href="#SnapshotManager.get_tags-362"><span class="linenos">362</span></a><span class="sd">            list[str]: A list of tags associated with the Snapshot. If no tags are associated, returns an empty list.</span>
</span><span id="SnapshotManager.get_tags-363"><a href="#SnapshotManager.get_tags-363"><span class="linenos">363</span></a>
</span><span id="SnapshotManager.get_tags-364"><a href="#SnapshotManager.get_tags-364"><span class="linenos">364</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_tags-365"><a href="#SnapshotManager.get_tags-365"><span class="linenos">365</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist in the storage.</span>
</span><span id="SnapshotManager.get_tags-366"><a href="#SnapshotManager.get_tags-366"><span class="linenos">366</span></a>
</span><span id="SnapshotManager.get_tags-367"><a href="#SnapshotManager.get_tags-367"><span class="linenos">367</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_tags-368"><a href="#SnapshotManager.get_tags-368"><span class="linenos">368</span></a><span class="sd">            Retrieve tags for a Snapshot:</span>
</span><span id="SnapshotManager.get_tags-369"><a href="#SnapshotManager.get_tags-369"><span class="linenos">369</span></a><span class="sd">                tags = manager.get_tags(&quot;snapshot_id&quot;)</span>
</span><span id="SnapshotManager.get_tags-370"><a href="#SnapshotManager.get_tags-370"><span class="linenos">370</span></a><span class="sd">                print(tags)</span>
</span><span id="SnapshotManager.get_tags-371"><a href="#SnapshotManager.get_tags-371"><span class="linenos">371</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_tags-372"><a href="#SnapshotManager.get_tags-372"><span class="linenos">372</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.get_tags-373"><a href="#SnapshotManager.get_tags-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">tags</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the tags associated with a specific Snapshot.</p>

<p>Args:
    snapshot_id (str): The unique ID of the Snapshot whose tags are to be retrieved.</p>

<p>Returns:
    list[str]: A list of tags associated with the Snapshot. If no tags are associated, returns an empty list.</p>

<p>Raises:
    ValueError: If the Snapshot ID does not exist in the storage.</p>

<p>Examples:
    Retrieve tags for a Snapshot:
        tags = manager.get_tags("snapshot_id")
        print(tags)</p>
</div>


                            </div>
                            <div id="SnapshotManager.remove_tags" class="classattr">
                                        <input id="SnapshotManager.remove_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span>, </span><span class="param"><span class="n">tags</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.remove_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.remove_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.remove_tags-375"><a href="#SnapshotManager.remove_tags-375"><span class="linenos">375</span></a>    <span class="k">def</span> <span class="nf">remove_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="SnapshotManager.remove_tags-376"><a href="#SnapshotManager.remove_tags-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_tags-377"><a href="#SnapshotManager.remove_tags-377"><span class="linenos">377</span></a><span class="sd">        Remove tags from a Snapshot.</span>
</span><span id="SnapshotManager.remove_tags-378"><a href="#SnapshotManager.remove_tags-378"><span class="linenos">378</span></a>
</span><span id="SnapshotManager.remove_tags-379"><a href="#SnapshotManager.remove_tags-379"><span class="linenos">379</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.remove_tags-380"><a href="#SnapshotManager.remove_tags-380"><span class="linenos">380</span></a><span class="sd">            snapshot_id (str): The ID of the Snapshot.</span>
</span><span id="SnapshotManager.remove_tags-381"><a href="#SnapshotManager.remove_tags-381"><span class="linenos">381</span></a><span class="sd">            tags (list): Tags to remove.</span>
</span><span id="SnapshotManager.remove_tags-382"><a href="#SnapshotManager.remove_tags-382"><span class="linenos">382</span></a>
</span><span id="SnapshotManager.remove_tags-383"><a href="#SnapshotManager.remove_tags-383"><span class="linenos">383</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.remove_tags-384"><a href="#SnapshotManager.remove_tags-384"><span class="linenos">384</span></a><span class="sd">            ValueError: If the Snapshot ID does not exist.</span>
</span><span id="SnapshotManager.remove_tags-385"><a href="#SnapshotManager.remove_tags-385"><span class="linenos">385</span></a>
</span><span id="SnapshotManager.remove_tags-386"><a href="#SnapshotManager.remove_tags-386"><span class="linenos">386</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.remove_tags-387"><a href="#SnapshotManager.remove_tags-387"><span class="linenos">387</span></a><span class="sd">            Remove tags from a Snapshot:</span>
</span><span id="SnapshotManager.remove_tags-388"><a href="#SnapshotManager.remove_tags-388"><span class="linenos">388</span></a><span class="sd">                manager.remove_tags(&quot;snap_id&quot;, [&quot;obsolete&quot;])</span>
</span><span id="SnapshotManager.remove_tags-389"><a href="#SnapshotManager.remove_tags-389"><span class="linenos">389</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_tags-390"><a href="#SnapshotManager.remove_tags-390"><span class="linenos">390</span></a>        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="SnapshotManager.remove_tags-391"><a href="#SnapshotManager.remove_tags-391"><span class="linenos">391</span></a>        <span class="n">snapshot</span><span class="o">.</span><span class="n">remove_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Remove tags from a Snapshot.</p>

<p>Args:
    snapshot_id (str): The ID of the Snapshot.
    tags (list): Tags to remove.</p>

<p>Raises:
    ValueError: If the Snapshot ID does not exist.</p>

<p>Examples:
    Remove tags from a Snapshot:
        manager.remove_tags("snap_id", ["obsolete"])</p>
</div>


                            </div>
                            <div id="SnapshotManager.list_snapshots" class="classattr">
                                        <input id="SnapshotManager.list_snapshots-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_snapshots</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.list_snapshots-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.list_snapshots"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.list_snapshots-395"><a href="#SnapshotManager.list_snapshots-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">list_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.list_snapshots-396"><a href="#SnapshotManager.list_snapshots-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.list_snapshots-397"><a href="#SnapshotManager.list_snapshots-397"><span class="linenos">397</span></a><span class="sd">        List all Snapshot IDs in the order they were created.</span>
</span><span id="SnapshotManager.list_snapshots-398"><a href="#SnapshotManager.list_snapshots-398"><span class="linenos">398</span></a>
</span><span id="SnapshotManager.list_snapshots-399"><a href="#SnapshotManager.list_snapshots-399"><span class="linenos">399</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.list_snapshots-400"><a href="#SnapshotManager.list_snapshots-400"><span class="linenos">400</span></a><span class="sd">            list: Snapshot IDs.</span>
</span><span id="SnapshotManager.list_snapshots-401"><a href="#SnapshotManager.list_snapshots-401"><span class="linenos">401</span></a>
</span><span id="SnapshotManager.list_snapshots-402"><a href="#SnapshotManager.list_snapshots-402"><span class="linenos">402</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.list_snapshots-403"><a href="#SnapshotManager.list_snapshots-403"><span class="linenos">403</span></a><span class="sd">            List all Snapshot IDs:</span>
</span><span id="SnapshotManager.list_snapshots-404"><a href="#SnapshotManager.list_snapshots-404"><span class="linenos">404</span></a><span class="sd">                ids = manager.list_snapshots()</span>
</span><span id="SnapshotManager.list_snapshots-405"><a href="#SnapshotManager.list_snapshots-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.list_snapshots-406"><a href="#SnapshotManager.list_snapshots-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span></pre></div>


            <div class="docstring"><p>List all Snapshot IDs in the order they were created.</p>

<p>Returns:
    list: Snapshot IDs.</p>

<p>Examples:
    List all Snapshot IDs:
        ids = manager.list_snapshots()</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_snapshot_count" class="classattr">
                                        <input id="SnapshotManager.get_snapshot_count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_snapshot_count</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_snapshot_count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_snapshot_count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_snapshot_count-408"><a href="#SnapshotManager.get_snapshot_count-408"><span class="linenos">408</span></a>    <span class="k">def</span> <span class="nf">get_snapshot_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.get_snapshot_count-409"><a href="#SnapshotManager.get_snapshot_count-409"><span class="linenos">409</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot_count-410"><a href="#SnapshotManager.get_snapshot_count-410"><span class="linenos">410</span></a><span class="sd">        Return the current number of PytreeSnapshots.</span>
</span><span id="SnapshotManager.get_snapshot_count-411"><a href="#SnapshotManager.get_snapshot_count-411"><span class="linenos">411</span></a>
</span><span id="SnapshotManager.get_snapshot_count-412"><a href="#SnapshotManager.get_snapshot_count-412"><span class="linenos">412</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_snapshot_count-413"><a href="#SnapshotManager.get_snapshot_count-413"><span class="linenos">413</span></a><span class="sd">            int: The number of stored PytreeSnapshots.</span>
</span><span id="SnapshotManager.get_snapshot_count-414"><a href="#SnapshotManager.get_snapshot_count-414"><span class="linenos">414</span></a>
</span><span id="SnapshotManager.get_snapshot_count-415"><a href="#SnapshotManager.get_snapshot_count-415"><span class="linenos">415</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_snapshot_count-416"><a href="#SnapshotManager.get_snapshot_count-416"><span class="linenos">416</span></a><span class="sd">            Get the number of PytreeSnapshots:</span>
</span><span id="SnapshotManager.get_snapshot_count-417"><a href="#SnapshotManager.get_snapshot_count-417"><span class="linenos">417</span></a><span class="sd">                count = manager.get_snapshot_count()</span>
</span><span id="SnapshotManager.get_snapshot_count-418"><a href="#SnapshotManager.get_snapshot_count-418"><span class="linenos">418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot_count-419"><a href="#SnapshotManager.get_snapshot_count-419"><span class="linenos">419</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the current number of PytreeSnapshots.</p>

<p>Returns:
    int: The number of stored PytreeSnapshots.</p>

<p>Examples:
    Get the number of PytreeSnapshots:
        count = manager.get_snapshot_count()</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_snapshot_by_index" class="classattr">
                                        <input id="SnapshotManager.get_snapshot_by_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_snapshot_by_index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=&lt;</span><span class="nb">object</span> <span class="nb">object</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_snapshot_by_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_snapshot_by_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_snapshot_by_index-421"><a href="#SnapshotManager.get_snapshot_by_index-421"><span class="linenos">421</span></a>    <span class="k">def</span> <span class="nf">get_snapshot_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager.get_snapshot_by_index-422"><a href="#SnapshotManager.get_snapshot_by_index-422"><span class="linenos">422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot_by_index-423"><a href="#SnapshotManager.get_snapshot_by_index-423"><span class="linenos">423</span></a><span class="sd">        Retrieve a Snapshot by its creation index.</span>
</span><span id="SnapshotManager.get_snapshot_by_index-424"><a href="#SnapshotManager.get_snapshot_by_index-424"><span class="linenos">424</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-425"><a href="#SnapshotManager.get_snapshot_by_index-425"><span class="linenos">425</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_snapshot_by_index-426"><a href="#SnapshotManager.get_snapshot_by_index-426"><span class="linenos">426</span></a><span class="sd">            index (int): Index of the Snapshot in the creation order.</span>
</span><span id="SnapshotManager.get_snapshot_by_index-427"><a href="#SnapshotManager.get_snapshot_by_index-427"><span class="linenos">427</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</span>
</span><span id="SnapshotManager.get_snapshot_by_index-428"><a href="#SnapshotManager.get_snapshot_by_index-428"><span class="linenos">428</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-429"><a href="#SnapshotManager.get_snapshot_by_index-429"><span class="linenos">429</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_snapshot_by_index-430"><a href="#SnapshotManager.get_snapshot_by_index-430"><span class="linenos">430</span></a><span class="sd">            Snapshot: The Snapshot object.</span>
</span><span id="SnapshotManager.get_snapshot_by_index-431"><a href="#SnapshotManager.get_snapshot_by_index-431"><span class="linenos">431</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-432"><a href="#SnapshotManager.get_snapshot_by_index-432"><span class="linenos">432</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_snapshot_by_index-433"><a href="#SnapshotManager.get_snapshot_by_index-433"><span class="linenos">433</span></a><span class="sd">            IndexError: If the index is out of range.</span>
</span><span id="SnapshotManager.get_snapshot_by_index-434"><a href="#SnapshotManager.get_snapshot_by_index-434"><span class="linenos">434</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-435"><a href="#SnapshotManager.get_snapshot_by_index-435"><span class="linenos">435</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_snapshot_by_index-436"><a href="#SnapshotManager.get_snapshot_by_index-436"><span class="linenos">436</span></a><span class="sd">            Retrieve a Snapshot by index:</span>
</span><span id="SnapshotManager.get_snapshot_by_index-437"><a href="#SnapshotManager.get_snapshot_by_index-437"><span class="linenos">437</span></a><span class="sd">                snapshot = manager.get_snapshot_by_index(0)</span>
</span><span id="SnapshotManager.get_snapshot_by_index-438"><a href="#SnapshotManager.get_snapshot_by_index-438"><span class="linenos">438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_snapshot_by_index-439"><a href="#SnapshotManager.get_snapshot_by_index-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">):</span>
</span><span id="SnapshotManager.get_snapshot_by_index-440"><a href="#SnapshotManager.get_snapshot_by_index-440"><span class="linenos">440</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index &#39;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&#39; is out of range.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.get_snapshot_by_index-441"><a href="#SnapshotManager.get_snapshot_by_index-441"><span class="linenos">441</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-442"><a href="#SnapshotManager.get_snapshot_by_index-442"><span class="linenos">442</span></a>        <span class="c1"># Get the snapshot ID by its index</span>
</span><span id="SnapshotManager.get_snapshot_by_index-443"><a href="#SnapshotManager.get_snapshot_by_index-443"><span class="linenos">443</span></a>        <span class="n">snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="SnapshotManager.get_snapshot_by_index-444"><a href="#SnapshotManager.get_snapshot_by_index-444"><span class="linenos">444</span></a>
</span><span id="SnapshotManager.get_snapshot_by_index-445"><a href="#SnapshotManager.get_snapshot_by_index-445"><span class="linenos">445</span></a>        <span class="c1"># Use the existing get_snapshot method to retrieve the snapshot</span>
</span><span id="SnapshotManager.get_snapshot_by_index-446"><a href="#SnapshotManager.get_snapshot_by_index-446"><span class="linenos">446</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve a Snapshot by its creation index.</p>

<p>Args:
    index (int): Index of the Snapshot in the creation order.
    deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</p>

<p>Returns:
    Snapshot: The Snapshot object.</p>

<p>Raises:
    IndexError: If the index is out of range.</p>

<p>Examples:
    Retrieve a Snapshot by index:
        snapshot = manager.get_snapshot_by_index(0)</p>
</div>


                            </div>
                            <div id="SnapshotManager.get_oldest_snapshot" class="classattr">
                                        <input id="SnapshotManager.get_oldest_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_oldest_snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=&lt;</span><span class="nb">object</span> <span class="nb">object</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.get_oldest_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.get_oldest_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.get_oldest_snapshot-448"><a href="#SnapshotManager.get_oldest_snapshot-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">get_oldest_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">):</span>
</span><span id="SnapshotManager.get_oldest_snapshot-449"><a href="#SnapshotManager.get_oldest_snapshot-449"><span class="linenos">449</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_oldest_snapshot-450"><a href="#SnapshotManager.get_oldest_snapshot-450"><span class="linenos">450</span></a><span class="sd">        Retrieve the oldest Snapshot.</span>
</span><span id="SnapshotManager.get_oldest_snapshot-451"><a href="#SnapshotManager.get_oldest_snapshot-451"><span class="linenos">451</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-452"><a href="#SnapshotManager.get_oldest_snapshot-452"><span class="linenos">452</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-453"><a href="#SnapshotManager.get_oldest_snapshot-453"><span class="linenos">453</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</span>
</span><span id="SnapshotManager.get_oldest_snapshot-454"><a href="#SnapshotManager.get_oldest_snapshot-454"><span class="linenos">454</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-455"><a href="#SnapshotManager.get_oldest_snapshot-455"><span class="linenos">455</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-456"><a href="#SnapshotManager.get_oldest_snapshot-456"><span class="linenos">456</span></a><span class="sd">            Snapshot: The oldest Snapshot object.</span>
</span><span id="SnapshotManager.get_oldest_snapshot-457"><a href="#SnapshotManager.get_oldest_snapshot-457"><span class="linenos">457</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-458"><a href="#SnapshotManager.get_oldest_snapshot-458"><span class="linenos">458</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-459"><a href="#SnapshotManager.get_oldest_snapshot-459"><span class="linenos">459</span></a><span class="sd">            IndexError: If no Snapshots are available.</span>
</span><span id="SnapshotManager.get_oldest_snapshot-460"><a href="#SnapshotManager.get_oldest_snapshot-460"><span class="linenos">460</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-461"><a href="#SnapshotManager.get_oldest_snapshot-461"><span class="linenos">461</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-462"><a href="#SnapshotManager.get_oldest_snapshot-462"><span class="linenos">462</span></a><span class="sd">            Retrieve the oldest Snapshot:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-463"><a href="#SnapshotManager.get_oldest_snapshot-463"><span class="linenos">463</span></a><span class="sd">                snapshot = manager.get_oldest_snapshot()</span>
</span><span id="SnapshotManager.get_oldest_snapshot-464"><a href="#SnapshotManager.get_oldest_snapshot-464"><span class="linenos">464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.get_oldest_snapshot-465"><a href="#SnapshotManager.get_oldest_snapshot-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">:</span>
</span><span id="SnapshotManager.get_oldest_snapshot-466"><a href="#SnapshotManager.get_oldest_snapshot-466"><span class="linenos">466</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;No Snapshots are available.&quot;</span><span class="p">)</span>
</span><span id="SnapshotManager.get_oldest_snapshot-467"><a href="#SnapshotManager.get_oldest_snapshot-467"><span class="linenos">467</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-468"><a href="#SnapshotManager.get_oldest_snapshot-468"><span class="linenos">468</span></a>        <span class="c1"># Get the oldest snapshot ID from the storage</span>
</span><span id="SnapshotManager.get_oldest_snapshot-469"><a href="#SnapshotManager.get_oldest_snapshot-469"><span class="linenos">469</span></a>        <span class="n">oldest_snapshot_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SnapshotManager.get_oldest_snapshot-470"><a href="#SnapshotManager.get_oldest_snapshot-470"><span class="linenos">470</span></a>
</span><span id="SnapshotManager.get_oldest_snapshot-471"><a href="#SnapshotManager.get_oldest_snapshot-471"><span class="linenos">471</span></a>        <span class="c1"># Use the existing get_snapshot method to retrieve the snapshot</span>
</span><span id="SnapshotManager.get_oldest_snapshot-472"><a href="#SnapshotManager.get_oldest_snapshot-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">oldest_snapshot_id</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the oldest Snapshot.</p>

<p>Args:
    deepcopy (bool, optional): Whether to return a deep copy of the Snapshot object.</p>

<p>Returns:
    Snapshot: The oldest Snapshot object.</p>

<p>Raises:
    IndexError: If no Snapshots are available.</p>

<p>Examples:
    Retrieve the oldest Snapshot:
        snapshot = manager.get_oldest_snapshot()</p>
</div>


                            </div>
                            <div id="SnapshotManager.list_snapshots_by_age" class="classattr">
                                        <input id="SnapshotManager.list_snapshots_by_age-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_snapshots_by_age</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.list_snapshots_by_age-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.list_snapshots_by_age"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.list_snapshots_by_age-474"><a href="#SnapshotManager.list_snapshots_by_age-474"><span class="linenos">474</span></a>    <span class="k">def</span> <span class="nf">list_snapshots_by_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SnapshotManager.list_snapshots_by_age-475"><a href="#SnapshotManager.list_snapshots_by_age-475"><span class="linenos">475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.list_snapshots_by_age-476"><a href="#SnapshotManager.list_snapshots_by_age-476"><span class="linenos">476</span></a><span class="sd">        List all Snapshot IDs sorted by their age (creation time).</span>
</span><span id="SnapshotManager.list_snapshots_by_age-477"><a href="#SnapshotManager.list_snapshots_by_age-477"><span class="linenos">477</span></a>
</span><span id="SnapshotManager.list_snapshots_by_age-478"><a href="#SnapshotManager.list_snapshots_by_age-478"><span class="linenos">478</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.list_snapshots_by_age-479"><a href="#SnapshotManager.list_snapshots_by_age-479"><span class="linenos">479</span></a><span class="sd">            ascending (bool): If True, lists PytreeSnapshots from oldest to newest. Otherwise, newest to oldest.</span>
</span><span id="SnapshotManager.list_snapshots_by_age-480"><a href="#SnapshotManager.list_snapshots_by_age-480"><span class="linenos">480</span></a>
</span><span id="SnapshotManager.list_snapshots_by_age-481"><a href="#SnapshotManager.list_snapshots_by_age-481"><span class="linenos">481</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.list_snapshots_by_age-482"><a href="#SnapshotManager.list_snapshots_by_age-482"><span class="linenos">482</span></a><span class="sd">            list: Snapshot IDs sorted by age.</span>
</span><span id="SnapshotManager.list_snapshots_by_age-483"><a href="#SnapshotManager.list_snapshots_by_age-483"><span class="linenos">483</span></a>
</span><span id="SnapshotManager.list_snapshots_by_age-484"><a href="#SnapshotManager.list_snapshots_by_age-484"><span class="linenos">484</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.list_snapshots_by_age-485"><a href="#SnapshotManager.list_snapshots_by_age-485"><span class="linenos">485</span></a><span class="sd">            List PytreeSnapshots from newest to oldest:</span>
</span><span id="SnapshotManager.list_snapshots_by_age-486"><a href="#SnapshotManager.list_snapshots_by_age-486"><span class="linenos">486</span></a><span class="sd">                ids = manager.list_snapshots_by_age(ascending=False)</span>
</span><span id="SnapshotManager.list_snapshots_by_age-487"><a href="#SnapshotManager.list_snapshots_by_age-487"><span class="linenos">487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.list_snapshots_by_age-488"><a href="#SnapshotManager.list_snapshots_by_age-488"><span class="linenos">488</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="SnapshotManager.list_snapshots_by_age-489"><a href="#SnapshotManager.list_snapshots_by_age-489"><span class="linenos">489</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="SnapshotManager.list_snapshots_by_age-490"><a href="#SnapshotManager.list_snapshots_by_age-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">ascending</span>
</span><span id="SnapshotManager.list_snapshots_by_age-491"><a href="#SnapshotManager.list_snapshots_by_age-491"><span class="linenos">491</span></a>            <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span><span class="p">))</span>
</span><span id="SnapshotManager.list_snapshots_by_age-492"><a href="#SnapshotManager.list_snapshots_by_age-492"><span class="linenos">492</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List all Snapshot IDs sorted by their age (creation time).</p>

<p>Args:
    ascending (bool): If True, lists PytreeSnapshots from oldest to newest. Otherwise, newest to oldest.</p>

<p>Returns:
    list: Snapshot IDs sorted by age.</p>

<p>Examples:
    List PytreeSnapshots from newest to oldest:
        ids = manager.list_snapshots_by_age(ascending=False)</p>
</div>


                            </div>
                            <div id="SnapshotManager.save_to_file" class="classattr">
                                        <input id="SnapshotManager.save_to_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_to_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span>, </span><span class="param"><span class="n">compress</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.save_to_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.save_to_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.save_to_file-517"><a href="#SnapshotManager.save_to_file-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SnapshotManager.save_to_file-518"><a href="#SnapshotManager.save_to_file-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.save_to_file-519"><a href="#SnapshotManager.save_to_file-519"><span class="linenos">519</span></a><span class="sd">        Save the current state of the SnapshotManager to a file.</span>
</span><span id="SnapshotManager.save_to_file-520"><a href="#SnapshotManager.save_to_file-520"><span class="linenos">520</span></a>
</span><span id="SnapshotManager.save_to_file-521"><a href="#SnapshotManager.save_to_file-521"><span class="linenos">521</span></a><span class="sd">        The state includes all stored snapshots, metadata, and configuration. This allows for</span>
</span><span id="SnapshotManager.save_to_file-522"><a href="#SnapshotManager.save_to_file-522"><span class="linenos">522</span></a><span class="sd">        persistent storage and later restoration of the manager&#39;s state.</span>
</span><span id="SnapshotManager.save_to_file-523"><a href="#SnapshotManager.save_to_file-523"><span class="linenos">523</span></a>
</span><span id="SnapshotManager.save_to_file-524"><a href="#SnapshotManager.save_to_file-524"><span class="linenos">524</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.save_to_file-525"><a href="#SnapshotManager.save_to_file-525"><span class="linenos">525</span></a><span class="sd">            file_path (str): The file path where the state should be saved.</span>
</span><span id="SnapshotManager.save_to_file-526"><a href="#SnapshotManager.save_to_file-526"><span class="linenos">526</span></a><span class="sd">            compress (bool): Whether to compress the saved state. Defaults to True.</span>
</span><span id="SnapshotManager.save_to_file-527"><a href="#SnapshotManager.save_to_file-527"><span class="linenos">527</span></a>
</span><span id="SnapshotManager.save_to_file-528"><a href="#SnapshotManager.save_to_file-528"><span class="linenos">528</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.save_to_file-529"><a href="#SnapshotManager.save_to_file-529"><span class="linenos">529</span></a><span class="sd">            None</span>
</span><span id="SnapshotManager.save_to_file-530"><a href="#SnapshotManager.save_to_file-530"><span class="linenos">530</span></a>
</span><span id="SnapshotManager.save_to_file-531"><a href="#SnapshotManager.save_to_file-531"><span class="linenos">531</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.save_to_file-532"><a href="#SnapshotManager.save_to_file-532"><span class="linenos">532</span></a><span class="sd">            IOError: If there is an issue writing to the file.</span>
</span><span id="SnapshotManager.save_to_file-533"><a href="#SnapshotManager.save_to_file-533"><span class="linenos">533</span></a>
</span><span id="SnapshotManager.save_to_file-534"><a href="#SnapshotManager.save_to_file-534"><span class="linenos">534</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.save_to_file-535"><a href="#SnapshotManager.save_to_file-535"><span class="linenos">535</span></a><span class="sd">            Save the state of the manager to a file:</span>
</span><span id="SnapshotManager.save_to_file-536"><a href="#SnapshotManager.save_to_file-536"><span class="linenos">536</span></a><span class="sd">                manager.save_to_file(&quot;snapshot_manager_state.json&quot;)</span>
</span><span id="SnapshotManager.save_to_file-537"><a href="#SnapshotManager.save_to_file-537"><span class="linenos">537</span></a>
</span><span id="SnapshotManager.save_to_file-538"><a href="#SnapshotManager.save_to_file-538"><span class="linenos">538</span></a><span class="sd">            Save without compression:</span>
</span><span id="SnapshotManager.save_to_file-539"><a href="#SnapshotManager.save_to_file-539"><span class="linenos">539</span></a><span class="sd">                manager.save_to_file(&quot;snapshot_manager_state.json&quot;, compress=False)</span>
</span><span id="SnapshotManager.save_to_file-540"><a href="#SnapshotManager.save_to_file-540"><span class="linenos">540</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.save_to_file-541"><a href="#SnapshotManager.save_to_file-541"><span class="linenos">541</span></a>
</span><span id="SnapshotManager.save_to_file-542"><a href="#SnapshotManager.save_to_file-542"><span class="linenos">542</span></a>        <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">compress</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the current state of the SnapshotManager to a file.</p>

<p>The state includes all stored snapshots, metadata, and configuration. This allows for
persistent storage and later restoration of the manager's state.</p>

<p>Args:
    file_path (str): The file path where the state should be saved.
    compress (bool): Whether to compress the saved state. Defaults to True.</p>

<p>Returns:
    None</p>

<p>Raises:
    IOError: If there is an issue writing to the file.</p>

<p>Examples:
    Save the state of the manager to a file:
        manager.save_to_file("snapshot_manager_state.json")</p>

<pre><code>Save without compression:
    manager.save_to_file("snapshot_manager_state.json", compress=False)
</code></pre>
</div>


                            </div>
                            <div id="SnapshotManager.load_from_file" class="classattr">
                                        <input id="SnapshotManager.load_from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">load_from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.load_from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.load_from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.load_from_file-544"><a href="#SnapshotManager.load_from_file-544"><span class="linenos">544</span></a>    <span class="nd">@staticmethod</span>
</span><span id="SnapshotManager.load_from_file-545"><a href="#SnapshotManager.load_from_file-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="nf">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="SnapshotManager.load_from_file-546"><a href="#SnapshotManager.load_from_file-546"><span class="linenos">546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.load_from_file-547"><a href="#SnapshotManager.load_from_file-547"><span class="linenos">547</span></a><span class="sd">        Load a SnapshotManager instance from a file.</span>
</span><span id="SnapshotManager.load_from_file-548"><a href="#SnapshotManager.load_from_file-548"><span class="linenos">548</span></a>
</span><span id="SnapshotManager.load_from_file-549"><a href="#SnapshotManager.load_from_file-549"><span class="linenos">549</span></a><span class="sd">        This method restores the state of a SnapshotManager from a file created using `save_to_file`.</span>
</span><span id="SnapshotManager.load_from_file-550"><a href="#SnapshotManager.load_from_file-550"><span class="linenos">550</span></a><span class="sd">        The loaded state includes all stored snapshots, metadata, and configuration.</span>
</span><span id="SnapshotManager.load_from_file-551"><a href="#SnapshotManager.load_from_file-551"><span class="linenos">551</span></a>
</span><span id="SnapshotManager.load_from_file-552"><a href="#SnapshotManager.load_from_file-552"><span class="linenos">552</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.load_from_file-553"><a href="#SnapshotManager.load_from_file-553"><span class="linenos">553</span></a><span class="sd">            file_path (str): The path to the file containing the saved state.</span>
</span><span id="SnapshotManager.load_from_file-554"><a href="#SnapshotManager.load_from_file-554"><span class="linenos">554</span></a>
</span><span id="SnapshotManager.load_from_file-555"><a href="#SnapshotManager.load_from_file-555"><span class="linenos">555</span></a><span class="sd">        Returns:</span>
</span><span id="SnapshotManager.load_from_file-556"><a href="#SnapshotManager.load_from_file-556"><span class="linenos">556</span></a><span class="sd">            SnapshotManager: A new instance of SnapshotManager initialized with the loaded state.</span>
</span><span id="SnapshotManager.load_from_file-557"><a href="#SnapshotManager.load_from_file-557"><span class="linenos">557</span></a>
</span><span id="SnapshotManager.load_from_file-558"><a href="#SnapshotManager.load_from_file-558"><span class="linenos">558</span></a><span class="sd">        Raises:</span>
</span><span id="SnapshotManager.load_from_file-559"><a href="#SnapshotManager.load_from_file-559"><span class="linenos">559</span></a><span class="sd">            IOError: If there is an issue reading from the file.</span>
</span><span id="SnapshotManager.load_from_file-560"><a href="#SnapshotManager.load_from_file-560"><span class="linenos">560</span></a><span class="sd">            ValueError: If the file does not contain valid SnapshotManager data.</span>
</span><span id="SnapshotManager.load_from_file-561"><a href="#SnapshotManager.load_from_file-561"><span class="linenos">561</span></a>
</span><span id="SnapshotManager.load_from_file-562"><a href="#SnapshotManager.load_from_file-562"><span class="linenos">562</span></a><span class="sd">        Examples:</span>
</span><span id="SnapshotManager.load_from_file-563"><a href="#SnapshotManager.load_from_file-563"><span class="linenos">563</span></a><span class="sd">            Load a SnapshotManager from a saved file:</span>
</span><span id="SnapshotManager.load_from_file-564"><a href="#SnapshotManager.load_from_file-564"><span class="linenos">564</span></a><span class="sd">                manager = SnapshotManager.load_from_file(&quot;snapshot_manager_state.json&quot;)</span>
</span><span id="SnapshotManager.load_from_file-565"><a href="#SnapshotManager.load_from_file-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.load_from_file-566"><a href="#SnapshotManager.load_from_file-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">SnapshotManager</span><span class="p">,</span> <span class="n">Snapshot</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load a SnapshotManager instance from a file.</p>

<p>This method restores the state of a SnapshotManager from a file created using <code><a href="#SnapshotManager.save_to_file">save_to_file</a></code>.
The loaded state includes all stored snapshots, metadata, and configuration.</p>

<p>Args:
    file_path (str): The path to the file containing the saved state.</p>

<p>Returns:
    SnapshotManager: A new instance of SnapshotManager initialized with the loaded state.</p>

<p>Raises:
    IOError: If there is an issue reading from the file.
    ValueError: If the file does not contain valid SnapshotManager data.</p>

<p>Examples:
    Load a SnapshotManager from a saved file:
        manager = <a href="#SnapshotManager.load_from_file">SnapshotManager.load_from_file</a>("snapshot_manager_state.json")</p>
</div>


                            </div>
                            <div id="SnapshotManager.update_cmp" class="classattr">
                                        <input id="SnapshotManager.update_cmp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_cmp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cmp</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.update_cmp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.update_cmp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.update_cmp-568"><a href="#SnapshotManager.update_cmp-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="nf">update_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmp</span><span class="p">):</span>
</span><span id="SnapshotManager.update_cmp-569"><a href="#SnapshotManager.update_cmp-569"><span class="linenos">569</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_cmp-570"><a href="#SnapshotManager.update_cmp-570"><span class="linenos">570</span></a><span class="sd">        Update the cmp function used for ranking snapshots.</span>
</span><span id="SnapshotManager.update_cmp-571"><a href="#SnapshotManager.update_cmp-571"><span class="linenos">571</span></a>
</span><span id="SnapshotManager.update_cmp-572"><a href="#SnapshotManager.update_cmp-572"><span class="linenos">572</span></a><span class="sd">        This method updates the comparison function used to determine the ranking of snapshots.</span>
</span><span id="SnapshotManager.update_cmp-573"><a href="#SnapshotManager.update_cmp-573"><span class="linenos">573</span></a><span class="sd">        The new cmp will be applied to the existing snapshots, and they will be re-ranked accordingly.</span>
</span><span id="SnapshotManager.update_cmp-574"><a href="#SnapshotManager.update_cmp-574"><span class="linenos">574</span></a>
</span><span id="SnapshotManager.update_cmp-575"><a href="#SnapshotManager.update_cmp-575"><span class="linenos">575</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.update_cmp-576"><a href="#SnapshotManager.update_cmp-576"><span class="linenos">576</span></a><span class="sd">            cmp (callable): A new cmp function that takes two snapshots as arguments and</span>
</span><span id="SnapshotManager.update_cmp-577"><a href="#SnapshotManager.update_cmp-577"><span class="linenos">577</span></a><span class="sd">                returns a negative, zero, or positive number to indicate their relative ranking.</span>
</span><span id="SnapshotManager.update_cmp-578"><a href="#SnapshotManager.update_cmp-578"><span class="linenos">578</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_cmp-579"><a href="#SnapshotManager.update_cmp-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_cmp</span><span class="p">(</span><span class="n">cmp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update the cmp function used for ranking snapshots.</p>

<p>This method updates the comparison function used to determine the ranking of snapshots.
The new cmp will be applied to the existing snapshots, and they will be re-ranked accordingly.</p>

<p>Args:
    cmp (callable): A new cmp function that takes two snapshots as arguments and
        returns a negative, zero, or positive number to indicate their relative ranking.</p>
</div>


                            </div>
                            <div id="SnapshotManager.remove_cmp" class="classattr">
                                        <input id="SnapshotManager.remove_cmp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_cmp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.remove_cmp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.remove_cmp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.remove_cmp-581"><a href="#SnapshotManager.remove_cmp-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">remove_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SnapshotManager.remove_cmp-582"><a href="#SnapshotManager.remove_cmp-582"><span class="linenos">582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_cmp-583"><a href="#SnapshotManager.remove_cmp-583"><span class="linenos">583</span></a><span class="sd">        Remove the cmp function and disable ranked snapshot management.</span>
</span><span id="SnapshotManager.remove_cmp-584"><a href="#SnapshotManager.remove_cmp-584"><span class="linenos">584</span></a>
</span><span id="SnapshotManager.remove_cmp-585"><a href="#SnapshotManager.remove_cmp-585"><span class="linenos">585</span></a><span class="sd">        This method removes the cmp function from the storage, disabling ranked snapshots.</span>
</span><span id="SnapshotManager.remove_cmp-586"><a href="#SnapshotManager.remove_cmp-586"><span class="linenos">586</span></a><span class="sd">        Snapshots will no longer be ranked or sorted based on the cmp, and only their creation</span>
</span><span id="SnapshotManager.remove_cmp-587"><a href="#SnapshotManager.remove_cmp-587"><span class="linenos">587</span></a><span class="sd">        order will be maintained.</span>
</span><span id="SnapshotManager.remove_cmp-588"><a href="#SnapshotManager.remove_cmp-588"><span class="linenos">588</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.remove_cmp-589"><a href="#SnapshotManager.remove_cmp-589"><span class="linenos">589</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_cmp</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Remove the cmp function and disable ranked snapshot management.</p>

<p>This method removes the cmp function from the storage, disabling ranked snapshots.
Snapshots will no longer be ranked or sorted based on the cmp, and only their creation
order will be maintained.</p>
</div>


                            </div>
                            <div id="SnapshotManager.update_max_snapshots" class="classattr">
                                        <input id="SnapshotManager.update_max_snapshots-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_max_snapshots</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">max_snapshots</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SnapshotManager.update_max_snapshots-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SnapshotManager.update_max_snapshots"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SnapshotManager.update_max_snapshots-591"><a href="#SnapshotManager.update_max_snapshots-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="nf">update_max_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_snapshots</span><span class="p">):</span>
</span><span id="SnapshotManager.update_max_snapshots-592"><a href="#SnapshotManager.update_max_snapshots-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_max_snapshots-593"><a href="#SnapshotManager.update_max_snapshots-593"><span class="linenos">593</span></a><span class="sd">        Update the maximum number of snapshots to store.</span>
</span><span id="SnapshotManager.update_max_snapshots-594"><a href="#SnapshotManager.update_max_snapshots-594"><span class="linenos">594</span></a>
</span><span id="SnapshotManager.update_max_snapshots-595"><a href="#SnapshotManager.update_max_snapshots-595"><span class="linenos">595</span></a><span class="sd">        This method adjusts the maximum limit for the number of snapshots stored by the manager.</span>
</span><span id="SnapshotManager.update_max_snapshots-596"><a href="#SnapshotManager.update_max_snapshots-596"><span class="linenos">596</span></a><span class="sd">        If the new limit is smaller than the current number of snapshots, excess snapshots will be removed</span>
</span><span id="SnapshotManager.update_max_snapshots-597"><a href="#SnapshotManager.update_max_snapshots-597"><span class="linenos">597</span></a><span class="sd">        according to the current ranking or creation order.</span>
</span><span id="SnapshotManager.update_max_snapshots-598"><a href="#SnapshotManager.update_max_snapshots-598"><span class="linenos">598</span></a>
</span><span id="SnapshotManager.update_max_snapshots-599"><a href="#SnapshotManager.update_max_snapshots-599"><span class="linenos">599</span></a><span class="sd">        Args:</span>
</span><span id="SnapshotManager.update_max_snapshots-600"><a href="#SnapshotManager.update_max_snapshots-600"><span class="linenos">600</span></a><span class="sd">            max_snapshots (int): The new maximum number of snapshots to retain. If None, no limit is enforced.</span>
</span><span id="SnapshotManager.update_max_snapshots-601"><a href="#SnapshotManager.update_max_snapshots-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SnapshotManager.update_max_snapshots-602"><a href="#SnapshotManager.update_max_snapshots-602"><span class="linenos">602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">update_max_snapshots</span><span class="p">(</span><span class="n">max_snapshots</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update the maximum number of snapshots to store.</p>

<p>This method adjusts the maximum limit for the number of snapshots stored by the manager.
If the new limit is smaller than the current number of snapshots, excess snapshots will be removed
according to the current ranking or creation order.</p>

<p>Args:
    max_snapshots (int): The new maximum number of snapshots to retain. If None, no limit is enforced.</p>
</div>


                            </div>
                </section>
                <section id="Snapshot">
                            <input id="Snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Snapshot</span>:

                <label class="view-source-button" for="Snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot-7"><a href="#Snapshot-7"><span class="linenos">  7</span></a><span class="k">class</span> <span class="nc">Snapshot</span><span class="p">:</span>
</span><span id="Snapshot-8"><a href="#Snapshot-8"><span class="linenos">  8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Snapshot-9"><a href="#Snapshot-9"><span class="linenos">  9</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-10"><a href="#Snapshot-10"><span class="linenos"> 10</span></a><span class="sd">        Initialize a Snapshot instance.</span>
</span><span id="Snapshot-11"><a href="#Snapshot-11"><span class="linenos"> 11</span></a>
</span><span id="Snapshot-12"><a href="#Snapshot-12"><span class="linenos"> 12</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-13"><a href="#Snapshot-13"><span class="linenos"> 13</span></a><span class="sd">            id: snapshot id,</span>
</span><span id="Snapshot-14"><a href="#Snapshot-14"><span class="linenos"> 14</span></a><span class="sd">            data: The data structure to store in the snapshot.</span>
</span><span id="Snapshot-15"><a href="#Snapshot-15"><span class="linenos"> 15</span></a><span class="sd">            metadata (dict, optional): User-defined metadata.</span>
</span><span id="Snapshot-16"><a href="#Snapshot-16"><span class="linenos"> 16</span></a><span class="sd">            tags (list, optional): Tags associated with the snapshot.</span>
</span><span id="Snapshot-17"><a href="#Snapshot-17"><span class="linenos"> 17</span></a><span class="sd">            deepcopy (bool, optional): If True, creates deep copies of the data, metadata, and tags;</span>
</span><span id="Snapshot-18"><a href="#Snapshot-18"><span class="linenos"> 18</span></a><span class="sd">                                        otherwise, stores references.</span>
</span><span id="Snapshot-19"><a href="#Snapshot-19"><span class="linenos"> 19</span></a><span class="sd">            snapshot_id (str, optional): A unique identifier for the snapshot. If not provided, a new ID is generated.</span>
</span><span id="Snapshot-20"><a href="#Snapshot-20"><span class="linenos"> 20</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-21"><a href="#Snapshot-21"><span class="linenos"> 21</span></a>
</span><span id="Snapshot-22"><a href="#Snapshot-22"><span class="linenos"> 22</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">snapshot_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
</span><span id="Snapshot-23"><a href="#Snapshot-23"><span class="linenos"> 23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Snapshot-24"><a href="#Snapshot-24"><span class="linenos"> 24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="n">data</span>
</span><span id="Snapshot-25"><a href="#Snapshot-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Snapshot-26"><a href="#Snapshot-26"><span class="linenos"> 26</span></a>            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">and</span> <span class="n">metadata</span> <span class="k">else</span> <span class="p">(</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{})</span>
</span><span id="Snapshot-27"><a href="#Snapshot-27"><span class="linenos"> 27</span></a>        <span class="p">)</span>
</span><span id="Snapshot-28"><a href="#Snapshot-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">and</span> <span class="n">tags</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">[])</span>
</span><span id="Snapshot-29"><a href="#Snapshot-29"><span class="linenos"> 29</span></a>
</span><span id="Snapshot-30"><a href="#Snapshot-30"><span class="linenos"> 30</span></a>    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-31"><a href="#Snapshot-31"><span class="linenos"> 31</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-32"><a href="#Snapshot-32"><span class="linenos"> 32</span></a><span class="sd">        Retrieve the snapshot ID.</span>
</span><span id="Snapshot-33"><a href="#Snapshot-33"><span class="linenos"> 33</span></a>
</span><span id="Snapshot-34"><a href="#Snapshot-34"><span class="linenos"> 34</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-35"><a href="#Snapshot-35"><span class="linenos"> 35</span></a><span class="sd">            str: The snapshot&#39;s unique identifier.</span>
</span><span id="Snapshot-36"><a href="#Snapshot-36"><span class="linenos"> 36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-37"><a href="#Snapshot-37"><span class="linenos"> 37</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
</span><span id="Snapshot-38"><a href="#Snapshot-38"><span class="linenos"> 38</span></a>
</span><span id="Snapshot-39"><a href="#Snapshot-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Snapshot-40"><a href="#Snapshot-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-41"><a href="#Snapshot-41"><span class="linenos"> 41</span></a><span class="sd">        Create a deep copy of the entire Snapshot object.</span>
</span><span id="Snapshot-42"><a href="#Snapshot-42"><span class="linenos"> 42</span></a>
</span><span id="Snapshot-43"><a href="#Snapshot-43"><span class="linenos"> 43</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-44"><a href="#Snapshot-44"><span class="linenos"> 44</span></a><span class="sd">            snapshot_id (str, optional): A unique identifier for the cloned snapshot.</span>
</span><span id="Snapshot-45"><a href="#Snapshot-45"><span class="linenos"> 45</span></a><span class="sd">                                        If not provided, a new ID is generated.</span>
</span><span id="Snapshot-46"><a href="#Snapshot-46"><span class="linenos"> 46</span></a>
</span><span id="Snapshot-47"><a href="#Snapshot-47"><span class="linenos"> 47</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-48"><a href="#Snapshot-48"><span class="linenos"> 48</span></a><span class="sd">            Snapshot: A new Snapshot instance with the same data, metadata, tags, and timestamp.</span>
</span><span id="Snapshot-49"><a href="#Snapshot-49"><span class="linenos"> 49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-50"><a href="#Snapshot-50"><span class="linenos"> 50</span></a>        <span class="k">return</span> <span class="n">Snapshot</span><span class="p">(</span>
</span><span id="Snapshot-51"><a href="#Snapshot-51"><span class="linenos"> 51</span></a>            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Snapshot-52"><a href="#Snapshot-52"><span class="linenos"> 52</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="Snapshot-53"><a href="#Snapshot-53"><span class="linenos"> 53</span></a>            <span class="n">tags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
</span><span id="Snapshot-54"><a href="#Snapshot-54"><span class="linenos"> 54</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Deepcopy will handle all fields internally</span>
</span><span id="Snapshot-55"><a href="#Snapshot-55"><span class="linenos"> 55</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span>
</span><span id="Snapshot-56"><a href="#Snapshot-56"><span class="linenos"> 56</span></a>            <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>  <span class="c1"># Use provided ID or generate a new one</span>
</span><span id="Snapshot-57"><a href="#Snapshot-57"><span class="linenos"> 57</span></a>        <span class="p">)</span>
</span><span id="Snapshot-58"><a href="#Snapshot-58"><span class="linenos"> 58</span></a>
</span><span id="Snapshot-59"><a href="#Snapshot-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-60"><a href="#Snapshot-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the snapshot to a dictionary for serialization.&quot;&quot;&quot;</span>
</span><span id="Snapshot-61"><a href="#Snapshot-61"><span class="linenos"> 61</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="Snapshot-62"><a href="#Snapshot-62"><span class="linenos"> 62</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="Snapshot-63"><a href="#Snapshot-63"><span class="linenos"> 63</span></a>            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Snapshot-64"><a href="#Snapshot-64"><span class="linenos"> 64</span></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="Snapshot-65"><a href="#Snapshot-65"><span class="linenos"> 65</span></a>            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
</span><span id="Snapshot-66"><a href="#Snapshot-66"><span class="linenos"> 66</span></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
</span><span id="Snapshot-67"><a href="#Snapshot-67"><span class="linenos"> 67</span></a>        <span class="p">}</span>
</span><span id="Snapshot-68"><a href="#Snapshot-68"><span class="linenos"> 68</span></a>
</span><span id="Snapshot-69"><a href="#Snapshot-69"><span class="linenos"> 69</span></a>    <span class="nd">@classmethod</span>
</span><span id="Snapshot-70"><a href="#Snapshot-70"><span class="linenos"> 70</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Snapshot-71"><a href="#Snapshot-71"><span class="linenos"> 71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recreate a snapshot from a dictionary.&quot;&quot;&quot;</span>
</span><span id="Snapshot-72"><a href="#Snapshot-72"><span class="linenos"> 72</span></a>
</span><span id="Snapshot-73"><a href="#Snapshot-73"><span class="linenos"> 73</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="Snapshot-74"><a href="#Snapshot-74"><span class="linenos"> 74</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
</span><span id="Snapshot-75"><a href="#Snapshot-75"><span class="linenos"> 75</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
</span><span id="Snapshot-76"><a href="#Snapshot-76"><span class="linenos"> 76</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">),</span>
</span><span id="Snapshot-77"><a href="#Snapshot-77"><span class="linenos"> 77</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">),</span>
</span><span id="Snapshot-78"><a href="#Snapshot-78"><span class="linenos"> 78</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Snapshot-79"><a href="#Snapshot-79"><span class="linenos"> 79</span></a>        <span class="p">)</span>
</span><span id="Snapshot-80"><a href="#Snapshot-80"><span class="linenos"> 80</span></a>
</span><span id="Snapshot-81"><a href="#Snapshot-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Snapshot-82"><a href="#Snapshot-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-83"><a href="#Snapshot-83"><span class="linenos"> 83</span></a><span class="sd">        Retrieve the stored data.</span>
</span><span id="Snapshot-84"><a href="#Snapshot-84"><span class="linenos"> 84</span></a>
</span><span id="Snapshot-85"><a href="#Snapshot-85"><span class="linenos"> 85</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-86"><a href="#Snapshot-86"><span class="linenos"> 86</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy.</span>
</span><span id="Snapshot-87"><a href="#Snapshot-87"><span class="linenos"> 87</span></a>
</span><span id="Snapshot-88"><a href="#Snapshot-88"><span class="linenos"> 88</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-89"><a href="#Snapshot-89"><span class="linenos"> 89</span></a><span class="sd">            The stored data.</span>
</span><span id="Snapshot-90"><a href="#Snapshot-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-91"><a href="#Snapshot-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</span><span id="Snapshot-92"><a href="#Snapshot-92"><span class="linenos"> 92</span></a>
</span><span id="Snapshot-93"><a href="#Snapshot-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">add_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="Snapshot-94"><a href="#Snapshot-94"><span class="linenos"> 94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-95"><a href="#Snapshot-95"><span class="linenos"> 95</span></a><span class="sd">        Add tags to the snapshot.</span>
</span><span id="Snapshot-96"><a href="#Snapshot-96"><span class="linenos"> 96</span></a>
</span><span id="Snapshot-97"><a href="#Snapshot-97"><span class="linenos"> 97</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-98"><a href="#Snapshot-98"><span class="linenos"> 98</span></a><span class="sd">            tags (list): Tags to add.</span>
</span><span id="Snapshot-99"><a href="#Snapshot-99"><span class="linenos"> 99</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-100"><a href="#Snapshot-100"><span class="linenos">100</span></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
</span><span id="Snapshot-101"><a href="#Snapshot-101"><span class="linenos">101</span></a>            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
</span><span id="Snapshot-102"><a href="#Snapshot-102"><span class="linenos">102</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</span><span id="Snapshot-103"><a href="#Snapshot-103"><span class="linenos">103</span></a>
</span><span id="Snapshot-104"><a href="#Snapshot-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">remove_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="Snapshot-105"><a href="#Snapshot-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-106"><a href="#Snapshot-106"><span class="linenos">106</span></a><span class="sd">        Remove tags from the snapshot.</span>
</span><span id="Snapshot-107"><a href="#Snapshot-107"><span class="linenos">107</span></a>
</span><span id="Snapshot-108"><a href="#Snapshot-108"><span class="linenos">108</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-109"><a href="#Snapshot-109"><span class="linenos">109</span></a><span class="sd">            tags (list): Tags to remove.</span>
</span><span id="Snapshot-110"><a href="#Snapshot-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-111"><a href="#Snapshot-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">]</span>
</span><span id="Snapshot-112"><a href="#Snapshot-112"><span class="linenos">112</span></a>
</span><span id="Snapshot-113"><a href="#Snapshot-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-114"><a href="#Snapshot-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-115"><a href="#Snapshot-115"><span class="linenos">115</span></a><span class="sd">        Retrieve the list of tags associated with the snapshot.</span>
</span><span id="Snapshot-116"><a href="#Snapshot-116"><span class="linenos">116</span></a>
</span><span id="Snapshot-117"><a href="#Snapshot-117"><span class="linenos">117</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-118"><a href="#Snapshot-118"><span class="linenos">118</span></a><span class="sd">            list: The list of tags.</span>
</span><span id="Snapshot-119"><a href="#Snapshot-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-120"><a href="#Snapshot-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span>
</span><span id="Snapshot-121"><a href="#Snapshot-121"><span class="linenos">121</span></a>
</span><span id="Snapshot-122"><a href="#Snapshot-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">has_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
</span><span id="Snapshot-123"><a href="#Snapshot-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-124"><a href="#Snapshot-124"><span class="linenos">124</span></a><span class="sd">        Check if the snapshot has a specific tag.</span>
</span><span id="Snapshot-125"><a href="#Snapshot-125"><span class="linenos">125</span></a>
</span><span id="Snapshot-126"><a href="#Snapshot-126"><span class="linenos">126</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-127"><a href="#Snapshot-127"><span class="linenos">127</span></a><span class="sd">            tag (str): The tag to check.</span>
</span><span id="Snapshot-128"><a href="#Snapshot-128"><span class="linenos">128</span></a>
</span><span id="Snapshot-129"><a href="#Snapshot-129"><span class="linenos">129</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-130"><a href="#Snapshot-130"><span class="linenos">130</span></a><span class="sd">            bool: True if the tag exists, False otherwise.</span>
</span><span id="Snapshot-131"><a href="#Snapshot-131"><span class="linenos">131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-132"><a href="#Snapshot-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span>
</span><span id="Snapshot-133"><a href="#Snapshot-133"><span class="linenos">133</span></a>
</span><span id="Snapshot-134"><a href="#Snapshot-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-135"><a href="#Snapshot-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-136"><a href="#Snapshot-136"><span class="linenos">136</span></a><span class="sd">        Retrieve the metadata associated with the snapshot.</span>
</span><span id="Snapshot-137"><a href="#Snapshot-137"><span class="linenos">137</span></a>
</span><span id="Snapshot-138"><a href="#Snapshot-138"><span class="linenos">138</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-139"><a href="#Snapshot-139"><span class="linenos">139</span></a><span class="sd">            dict: The metadata dictionary.</span>
</span><span id="Snapshot-140"><a href="#Snapshot-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-141"><a href="#Snapshot-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
</span><span id="Snapshot-142"><a href="#Snapshot-142"><span class="linenos">142</span></a>
</span><span id="Snapshot-143"><a href="#Snapshot-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
</span><span id="Snapshot-144"><a href="#Snapshot-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-145"><a href="#Snapshot-145"><span class="linenos">145</span></a><span class="sd">        Set or replace the metadata for the snapshot.</span>
</span><span id="Snapshot-146"><a href="#Snapshot-146"><span class="linenos">146</span></a>
</span><span id="Snapshot-147"><a href="#Snapshot-147"><span class="linenos">147</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-148"><a href="#Snapshot-148"><span class="linenos">148</span></a><span class="sd">            metadata (dict): The new metadata.</span>
</span><span id="Snapshot-149"><a href="#Snapshot-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-150"><a href="#Snapshot-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
</span><span id="Snapshot-151"><a href="#Snapshot-151"><span class="linenos">151</span></a>
</span><span id="Snapshot-152"><a href="#Snapshot-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">get_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-153"><a href="#Snapshot-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-154"><a href="#Snapshot-154"><span class="linenos">154</span></a><span class="sd">        Retrieve the timestamp of when the snapshot was created.</span>
</span><span id="Snapshot-155"><a href="#Snapshot-155"><span class="linenos">155</span></a>
</span><span id="Snapshot-156"><a href="#Snapshot-156"><span class="linenos">156</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-157"><a href="#Snapshot-157"><span class="linenos">157</span></a><span class="sd">            float: The timestamp.</span>
</span><span id="Snapshot-158"><a href="#Snapshot-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-159"><a href="#Snapshot-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
</span><span id="Snapshot-160"><a href="#Snapshot-160"><span class="linenos">160</span></a>
</span><span id="Snapshot-161"><a href="#Snapshot-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">set_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
</span><span id="Snapshot-162"><a href="#Snapshot-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-163"><a href="#Snapshot-163"><span class="linenos">163</span></a><span class="sd">        Set or update the timestamp for the snapshot.</span>
</span><span id="Snapshot-164"><a href="#Snapshot-164"><span class="linenos">164</span></a>
</span><span id="Snapshot-165"><a href="#Snapshot-165"><span class="linenos">165</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-166"><a href="#Snapshot-166"><span class="linenos">166</span></a><span class="sd">            timestamp (float): The new timestamp value.</span>
</span><span id="Snapshot-167"><a href="#Snapshot-167"><span class="linenos">167</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-168"><a href="#Snapshot-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>
</span><span id="Snapshot-169"><a href="#Snapshot-169"><span class="linenos">169</span></a>
</span><span id="Snapshot-170"><a href="#Snapshot-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_metadata</span><span class="p">):</span>
</span><span id="Snapshot-171"><a href="#Snapshot-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-172"><a href="#Snapshot-172"><span class="linenos">172</span></a><span class="sd">        Update the metadata of the snapshot.</span>
</span><span id="Snapshot-173"><a href="#Snapshot-173"><span class="linenos">173</span></a>
</span><span id="Snapshot-174"><a href="#Snapshot-174"><span class="linenos">174</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-175"><a href="#Snapshot-175"><span class="linenos">175</span></a><span class="sd">            new_metadata (dict): Metadata to update.</span>
</span><span id="Snapshot-176"><a href="#Snapshot-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-177"><a href="#Snapshot-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">)</span>
</span><span id="Snapshot-178"><a href="#Snapshot-178"><span class="linenos">178</span></a>
</span><span id="Snapshot-179"><a href="#Snapshot-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Snapshot-180"><a href="#Snapshot-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-181"><a href="#Snapshot-181"><span class="linenos">181</span></a><span class="sd">        Compares snapshots for equality based on their IDs.</span>
</span><span id="Snapshot-182"><a href="#Snapshot-182"><span class="linenos">182</span></a>
</span><span id="Snapshot-183"><a href="#Snapshot-183"><span class="linenos">183</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot-184"><a href="#Snapshot-184"><span class="linenos">184</span></a><span class="sd">            other (Snapshot): Another snapshot to compare against.</span>
</span><span id="Snapshot-185"><a href="#Snapshot-185"><span class="linenos">185</span></a>
</span><span id="Snapshot-186"><a href="#Snapshot-186"><span class="linenos">186</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-187"><a href="#Snapshot-187"><span class="linenos">187</span></a><span class="sd">            bool: True if the snapshots have the same ID, False otherwise.</span>
</span><span id="Snapshot-188"><a href="#Snapshot-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-189"><a href="#Snapshot-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Snapshot</span><span class="p">):</span>
</span><span id="Snapshot-190"><a href="#Snapshot-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span>
</span><span id="Snapshot-191"><a href="#Snapshot-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Snapshot-192"><a href="#Snapshot-192"><span class="linenos">192</span></a>
</span><span id="Snapshot-193"><a href="#Snapshot-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-194"><a href="#Snapshot-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-195"><a href="#Snapshot-195"><span class="linenos">195</span></a><span class="sd">        Returns a hash value based on the snapshot ID.</span>
</span><span id="Snapshot-196"><a href="#Snapshot-196"><span class="linenos">196</span></a>
</span><span id="Snapshot-197"><a href="#Snapshot-197"><span class="linenos">197</span></a><span class="sd">        This ensures that snapshots can be used as keys in dictionaries or added to sets.</span>
</span><span id="Snapshot-198"><a href="#Snapshot-198"><span class="linenos">198</span></a>
</span><span id="Snapshot-199"><a href="#Snapshot-199"><span class="linenos">199</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot-200"><a href="#Snapshot-200"><span class="linenos">200</span></a><span class="sd">            int: The hash value of the snapshot ID.</span>
</span><span id="Snapshot-201"><a href="#Snapshot-201"><span class="linenos">201</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-202"><a href="#Snapshot-202"><span class="linenos">202</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="Snapshot-203"><a href="#Snapshot-203"><span class="linenos">203</span></a>    
</span><span id="Snapshot-204"><a href="#Snapshot-204"><span class="linenos">204</span></a>    
</span><span id="Snapshot-205"><a href="#Snapshot-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot-206"><a href="#Snapshot-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot-207"><a href="#Snapshot-207"><span class="linenos">207</span></a><span class="sd">        Return a string representation of the Snapshot object for debugging and logging.</span>
</span><span id="Snapshot-208"><a href="#Snapshot-208"><span class="linenos">208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot-209"><a href="#Snapshot-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Snapshot-210"><a href="#Snapshot-210"><span class="linenos">210</span></a>            <span class="sa">f</span><span class="s2">&quot;Snapshot(id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, timestamp=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Snapshot-211"><a href="#Snapshot-211"><span class="linenos">211</span></a>            <span class="sa">f</span><span class="s2">&quot;data=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, metadata=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="si">}</span><span class="s2">, tags=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Snapshot-212"><a href="#Snapshot-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            <div id="Snapshot.__init__" class="classattr">
                                        <input id="Snapshot.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">metadata</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">tags</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Snapshot.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.__init__-8"><a href="#Snapshot.__init__-8"><span class="linenos"> 8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Snapshot.__init__-9"><a href="#Snapshot.__init__-9"><span class="linenos"> 9</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.__init__-10"><a href="#Snapshot.__init__-10"><span class="linenos">10</span></a><span class="sd">        Initialize a Snapshot instance.</span>
</span><span id="Snapshot.__init__-11"><a href="#Snapshot.__init__-11"><span class="linenos">11</span></a>
</span><span id="Snapshot.__init__-12"><a href="#Snapshot.__init__-12"><span class="linenos">12</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.__init__-13"><a href="#Snapshot.__init__-13"><span class="linenos">13</span></a><span class="sd">            id: snapshot id,</span>
</span><span id="Snapshot.__init__-14"><a href="#Snapshot.__init__-14"><span class="linenos">14</span></a><span class="sd">            data: The data structure to store in the snapshot.</span>
</span><span id="Snapshot.__init__-15"><a href="#Snapshot.__init__-15"><span class="linenos">15</span></a><span class="sd">            metadata (dict, optional): User-defined metadata.</span>
</span><span id="Snapshot.__init__-16"><a href="#Snapshot.__init__-16"><span class="linenos">16</span></a><span class="sd">            tags (list, optional): Tags associated with the snapshot.</span>
</span><span id="Snapshot.__init__-17"><a href="#Snapshot.__init__-17"><span class="linenos">17</span></a><span class="sd">            deepcopy (bool, optional): If True, creates deep copies of the data, metadata, and tags;</span>
</span><span id="Snapshot.__init__-18"><a href="#Snapshot.__init__-18"><span class="linenos">18</span></a><span class="sd">                                        otherwise, stores references.</span>
</span><span id="Snapshot.__init__-19"><a href="#Snapshot.__init__-19"><span class="linenos">19</span></a><span class="sd">            snapshot_id (str, optional): A unique identifier for the snapshot. If not provided, a new ID is generated.</span>
</span><span id="Snapshot.__init__-20"><a href="#Snapshot.__init__-20"><span class="linenos">20</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.__init__-21"><a href="#Snapshot.__init__-21"><span class="linenos">21</span></a>
</span><span id="Snapshot.__init__-22"><a href="#Snapshot.__init__-22"><span class="linenos">22</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">snapshot_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
</span><span id="Snapshot.__init__-23"><a href="#Snapshot.__init__-23"><span class="linenos">23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Snapshot.__init__-24"><a href="#Snapshot.__init__-24"><span class="linenos">24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="n">data</span>
</span><span id="Snapshot.__init__-25"><a href="#Snapshot.__init__-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Snapshot.__init__-26"><a href="#Snapshot.__init__-26"><span class="linenos">26</span></a>            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">and</span> <span class="n">metadata</span> <span class="k">else</span> <span class="p">(</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{})</span>
</span><span id="Snapshot.__init__-27"><a href="#Snapshot.__init__-27"><span class="linenos">27</span></a>        <span class="p">)</span>
</span><span id="Snapshot.__init__-28"><a href="#Snapshot.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="ow">and</span> <span class="n">tags</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">[])</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Snapshot instance.</p>

<p>Args:
    id: snapshot id,
    data: The data structure to store in the snapshot.
    metadata (dict, optional): User-defined metadata.
    tags (list, optional): Tags associated with the snapshot.
    deepcopy (bool, optional): If True, creates deep copies of the data, metadata, and tags;
                                otherwise, stores references.
    snapshot_id (str, optional): A unique identifier for the snapshot. If not provided, a new ID is generated.</p>
</div>


                            </div>
                            <div id="Snapshot.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span>

        
    </div>
    <a class="headerlink" href="#Snapshot.id"></a>
    
    

                            </div>
                            <div id="Snapshot.timestamp" class="classattr">
                                <div class="attr variable">
            <span class="name">timestamp</span>

        
    </div>
    <a class="headerlink" href="#Snapshot.timestamp"></a>
    
    

                            </div>
                            <div id="Snapshot.data" class="classattr">
                                <div class="attr variable">
            <span class="name">data</span>

        
    </div>
    <a class="headerlink" href="#Snapshot.data"></a>
    
    

                            </div>
                            <div id="Snapshot.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#Snapshot.metadata"></a>
    
    

                            </div>
                            <div id="Snapshot.tags" class="classattr">
                                <div class="attr variable">
            <span class="name">tags</span>

        
    </div>
    <a class="headerlink" href="#Snapshot.tags"></a>
    
    

                            </div>
                            <div id="Snapshot.get_id" class="classattr">
                                        <input id="Snapshot.get_id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_id</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.get_id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.get_id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.get_id-30"><a href="#Snapshot.get_id-30"><span class="linenos">30</span></a>    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot.get_id-31"><a href="#Snapshot.get_id-31"><span class="linenos">31</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.get_id-32"><a href="#Snapshot.get_id-32"><span class="linenos">32</span></a><span class="sd">        Retrieve the snapshot ID.</span>
</span><span id="Snapshot.get_id-33"><a href="#Snapshot.get_id-33"><span class="linenos">33</span></a>
</span><span id="Snapshot.get_id-34"><a href="#Snapshot.get_id-34"><span class="linenos">34</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.get_id-35"><a href="#Snapshot.get_id-35"><span class="linenos">35</span></a><span class="sd">            str: The snapshot&#39;s unique identifier.</span>
</span><span id="Snapshot.get_id-36"><a href="#Snapshot.get_id-36"><span class="linenos">36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.get_id-37"><a href="#Snapshot.get_id-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the snapshot ID.</p>

<p>Returns:
    str: The snapshot's unique identifier.</p>
</div>


                            </div>
                            <div id="Snapshot.clone" class="classattr">
                                        <input id="Snapshot.clone-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clone</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.clone-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.clone"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.clone-39"><a href="#Snapshot.clone-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Snapshot.clone-40"><a href="#Snapshot.clone-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.clone-41"><a href="#Snapshot.clone-41"><span class="linenos">41</span></a><span class="sd">        Create a deep copy of the entire Snapshot object.</span>
</span><span id="Snapshot.clone-42"><a href="#Snapshot.clone-42"><span class="linenos">42</span></a>
</span><span id="Snapshot.clone-43"><a href="#Snapshot.clone-43"><span class="linenos">43</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.clone-44"><a href="#Snapshot.clone-44"><span class="linenos">44</span></a><span class="sd">            snapshot_id (str, optional): A unique identifier for the cloned snapshot.</span>
</span><span id="Snapshot.clone-45"><a href="#Snapshot.clone-45"><span class="linenos">45</span></a><span class="sd">                                        If not provided, a new ID is generated.</span>
</span><span id="Snapshot.clone-46"><a href="#Snapshot.clone-46"><span class="linenos">46</span></a>
</span><span id="Snapshot.clone-47"><a href="#Snapshot.clone-47"><span class="linenos">47</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.clone-48"><a href="#Snapshot.clone-48"><span class="linenos">48</span></a><span class="sd">            Snapshot: A new Snapshot instance with the same data, metadata, tags, and timestamp.</span>
</span><span id="Snapshot.clone-49"><a href="#Snapshot.clone-49"><span class="linenos">49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.clone-50"><a href="#Snapshot.clone-50"><span class="linenos">50</span></a>        <span class="k">return</span> <span class="n">Snapshot</span><span class="p">(</span>
</span><span id="Snapshot.clone-51"><a href="#Snapshot.clone-51"><span class="linenos">51</span></a>            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Snapshot.clone-52"><a href="#Snapshot.clone-52"><span class="linenos">52</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="Snapshot.clone-53"><a href="#Snapshot.clone-53"><span class="linenos">53</span></a>            <span class="n">tags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
</span><span id="Snapshot.clone-54"><a href="#Snapshot.clone-54"><span class="linenos">54</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Deepcopy will handle all fields internally</span>
</span><span id="Snapshot.clone-55"><a href="#Snapshot.clone-55"><span class="linenos">55</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span>
</span><span id="Snapshot.clone-56"><a href="#Snapshot.clone-56"><span class="linenos">56</span></a>            <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>  <span class="c1"># Use provided ID or generate a new one</span>
</span><span id="Snapshot.clone-57"><a href="#Snapshot.clone-57"><span class="linenos">57</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a deep copy of the entire Snapshot object.</p>

<p>Args:
    snapshot_id (str, optional): A unique identifier for the cloned snapshot.
                                If not provided, a new ID is generated.</p>

<p>Returns:
    Snapshot: A new Snapshot instance with the same data, metadata, tags, and timestamp.</p>
</div>


                            </div>
                            <div id="Snapshot.to_dict" class="classattr">
                                        <input id="Snapshot.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.to_dict-59"><a href="#Snapshot.to_dict-59"><span class="linenos">59</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot.to_dict-60"><a href="#Snapshot.to_dict-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the snapshot to a dictionary for serialization.&quot;&quot;&quot;</span>
</span><span id="Snapshot.to_dict-61"><a href="#Snapshot.to_dict-61"><span class="linenos">61</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="Snapshot.to_dict-62"><a href="#Snapshot.to_dict-62"><span class="linenos">62</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="Snapshot.to_dict-63"><a href="#Snapshot.to_dict-63"><span class="linenos">63</span></a>            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Snapshot.to_dict-64"><a href="#Snapshot.to_dict-64"><span class="linenos">64</span></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="Snapshot.to_dict-65"><a href="#Snapshot.to_dict-65"><span class="linenos">65</span></a>            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
</span><span id="Snapshot.to_dict-66"><a href="#Snapshot.to_dict-66"><span class="linenos">66</span></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
</span><span id="Snapshot.to_dict-67"><a href="#Snapshot.to_dict-67"><span class="linenos">67</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Convert the snapshot to a dictionary for serialization.</p>
</div>


                            </div>
                            <div id="Snapshot.from_dict" class="classattr">
                                        <input id="Snapshot.from_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.from_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.from_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.from_dict-69"><a href="#Snapshot.from_dict-69"><span class="linenos">69</span></a>    <span class="nd">@classmethod</span>
</span><span id="Snapshot.from_dict-70"><a href="#Snapshot.from_dict-70"><span class="linenos">70</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Snapshot.from_dict-71"><a href="#Snapshot.from_dict-71"><span class="linenos">71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recreate a snapshot from a dictionary.&quot;&quot;&quot;</span>
</span><span id="Snapshot.from_dict-72"><a href="#Snapshot.from_dict-72"><span class="linenos">72</span></a>
</span><span id="Snapshot.from_dict-73"><a href="#Snapshot.from_dict-73"><span class="linenos">73</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="Snapshot.from_dict-74"><a href="#Snapshot.from_dict-74"><span class="linenos">74</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
</span><span id="Snapshot.from_dict-75"><a href="#Snapshot.from_dict-75"><span class="linenos">75</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
</span><span id="Snapshot.from_dict-76"><a href="#Snapshot.from_dict-76"><span class="linenos">76</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">),</span>
</span><span id="Snapshot.from_dict-77"><a href="#Snapshot.from_dict-77"><span class="linenos">77</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">),</span>
</span><span id="Snapshot.from_dict-78"><a href="#Snapshot.from_dict-78"><span class="linenos">78</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Snapshot.from_dict-79"><a href="#Snapshot.from_dict-79"><span class="linenos">79</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Recreate a snapshot from a dictionary.</p>
</div>


                            </div>
                            <div id="Snapshot.get_data" class="classattr">
                                        <input id="Snapshot.get_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.get_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.get_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.get_data-81"><a href="#Snapshot.get_data-81"><span class="linenos">81</span></a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Snapshot.get_data-82"><a href="#Snapshot.get_data-82"><span class="linenos">82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.get_data-83"><a href="#Snapshot.get_data-83"><span class="linenos">83</span></a><span class="sd">        Retrieve the stored data.</span>
</span><span id="Snapshot.get_data-84"><a href="#Snapshot.get_data-84"><span class="linenos">84</span></a>
</span><span id="Snapshot.get_data-85"><a href="#Snapshot.get_data-85"><span class="linenos">85</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.get_data-86"><a href="#Snapshot.get_data-86"><span class="linenos">86</span></a><span class="sd">            deepcopy (bool, optional): Whether to return a deep copy.</span>
</span><span id="Snapshot.get_data-87"><a href="#Snapshot.get_data-87"><span class="linenos">87</span></a>
</span><span id="Snapshot.get_data-88"><a href="#Snapshot.get_data-88"><span class="linenos">88</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.get_data-89"><a href="#Snapshot.get_data-89"><span class="linenos">89</span></a><span class="sd">            The stored data.</span>
</span><span id="Snapshot.get_data-90"><a href="#Snapshot.get_data-90"><span class="linenos">90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.get_data-91"><a href="#Snapshot.get_data-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="n">deepcopy</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the stored data.</p>

<p>Args:
    deepcopy (bool, optional): Whether to return a deep copy.</p>

<p>Returns:
    The stored data.</p>
</div>


                            </div>
                            <div id="Snapshot.add_tags" class="classattr">
                                        <input id="Snapshot.add_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tags</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.add_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.add_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.add_tags-93"><a href="#Snapshot.add_tags-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">add_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="Snapshot.add_tags-94"><a href="#Snapshot.add_tags-94"><span class="linenos"> 94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.add_tags-95"><a href="#Snapshot.add_tags-95"><span class="linenos"> 95</span></a><span class="sd">        Add tags to the snapshot.</span>
</span><span id="Snapshot.add_tags-96"><a href="#Snapshot.add_tags-96"><span class="linenos"> 96</span></a>
</span><span id="Snapshot.add_tags-97"><a href="#Snapshot.add_tags-97"><span class="linenos"> 97</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.add_tags-98"><a href="#Snapshot.add_tags-98"><span class="linenos"> 98</span></a><span class="sd">            tags (list): Tags to add.</span>
</span><span id="Snapshot.add_tags-99"><a href="#Snapshot.add_tags-99"><span class="linenos"> 99</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.add_tags-100"><a href="#Snapshot.add_tags-100"><span class="linenos">100</span></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
</span><span id="Snapshot.add_tags-101"><a href="#Snapshot.add_tags-101"><span class="linenos">101</span></a>            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
</span><span id="Snapshot.add_tags-102"><a href="#Snapshot.add_tags-102"><span class="linenos">102</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add tags to the snapshot.</p>

<p>Args:
    tags (list): Tags to add.</p>
</div>


                            </div>
                            <div id="Snapshot.remove_tags" class="classattr">
                                        <input id="Snapshot.remove_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tags</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.remove_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.remove_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.remove_tags-104"><a href="#Snapshot.remove_tags-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">remove_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
</span><span id="Snapshot.remove_tags-105"><a href="#Snapshot.remove_tags-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.remove_tags-106"><a href="#Snapshot.remove_tags-106"><span class="linenos">106</span></a><span class="sd">        Remove tags from the snapshot.</span>
</span><span id="Snapshot.remove_tags-107"><a href="#Snapshot.remove_tags-107"><span class="linenos">107</span></a>
</span><span id="Snapshot.remove_tags-108"><a href="#Snapshot.remove_tags-108"><span class="linenos">108</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.remove_tags-109"><a href="#Snapshot.remove_tags-109"><span class="linenos">109</span></a><span class="sd">            tags (list): Tags to remove.</span>
</span><span id="Snapshot.remove_tags-110"><a href="#Snapshot.remove_tags-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.remove_tags-111"><a href="#Snapshot.remove_tags-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Remove tags from the snapshot.</p>

<p>Args:
    tags (list): Tags to remove.</p>
</div>


                            </div>
                            <div id="Snapshot.get_tags" class="classattr">
                                        <input id="Snapshot.get_tags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.get_tags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.get_tags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.get_tags-113"><a href="#Snapshot.get_tags-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot.get_tags-114"><a href="#Snapshot.get_tags-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.get_tags-115"><a href="#Snapshot.get_tags-115"><span class="linenos">115</span></a><span class="sd">        Retrieve the list of tags associated with the snapshot.</span>
</span><span id="Snapshot.get_tags-116"><a href="#Snapshot.get_tags-116"><span class="linenos">116</span></a>
</span><span id="Snapshot.get_tags-117"><a href="#Snapshot.get_tags-117"><span class="linenos">117</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.get_tags-118"><a href="#Snapshot.get_tags-118"><span class="linenos">118</span></a><span class="sd">            list: The list of tags.</span>
</span><span id="Snapshot.get_tags-119"><a href="#Snapshot.get_tags-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.get_tags-120"><a href="#Snapshot.get_tags-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the list of tags associated with the snapshot.</p>

<p>Returns:
    list: The list of tags.</p>
</div>


                            </div>
                            <div id="Snapshot.has_tag" class="classattr">
                                        <input id="Snapshot.has_tag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_tag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tag</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.has_tag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.has_tag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.has_tag-122"><a href="#Snapshot.has_tag-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">has_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
</span><span id="Snapshot.has_tag-123"><a href="#Snapshot.has_tag-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.has_tag-124"><a href="#Snapshot.has_tag-124"><span class="linenos">124</span></a><span class="sd">        Check if the snapshot has a specific tag.</span>
</span><span id="Snapshot.has_tag-125"><a href="#Snapshot.has_tag-125"><span class="linenos">125</span></a>
</span><span id="Snapshot.has_tag-126"><a href="#Snapshot.has_tag-126"><span class="linenos">126</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.has_tag-127"><a href="#Snapshot.has_tag-127"><span class="linenos">127</span></a><span class="sd">            tag (str): The tag to check.</span>
</span><span id="Snapshot.has_tag-128"><a href="#Snapshot.has_tag-128"><span class="linenos">128</span></a>
</span><span id="Snapshot.has_tag-129"><a href="#Snapshot.has_tag-129"><span class="linenos">129</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.has_tag-130"><a href="#Snapshot.has_tag-130"><span class="linenos">130</span></a><span class="sd">            bool: True if the tag exists, False otherwise.</span>
</span><span id="Snapshot.has_tag-131"><a href="#Snapshot.has_tag-131"><span class="linenos">131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.has_tag-132"><a href="#Snapshot.has_tag-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span>
</span></pre></div>


            <div class="docstring"><p>Check if the snapshot has a specific tag.</p>

<p>Args:
    tag (str): The tag to check.</p>

<p>Returns:
    bool: True if the tag exists, False otherwise.</p>
</div>


                            </div>
                            <div id="Snapshot.get_metadata" class="classattr">
                                        <input id="Snapshot.get_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.get_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.get_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.get_metadata-134"><a href="#Snapshot.get_metadata-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot.get_metadata-135"><a href="#Snapshot.get_metadata-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.get_metadata-136"><a href="#Snapshot.get_metadata-136"><span class="linenos">136</span></a><span class="sd">        Retrieve the metadata associated with the snapshot.</span>
</span><span id="Snapshot.get_metadata-137"><a href="#Snapshot.get_metadata-137"><span class="linenos">137</span></a>
</span><span id="Snapshot.get_metadata-138"><a href="#Snapshot.get_metadata-138"><span class="linenos">138</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.get_metadata-139"><a href="#Snapshot.get_metadata-139"><span class="linenos">139</span></a><span class="sd">            dict: The metadata dictionary.</span>
</span><span id="Snapshot.get_metadata-140"><a href="#Snapshot.get_metadata-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.get_metadata-141"><a href="#Snapshot.get_metadata-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the metadata associated with the snapshot.</p>

<p>Returns:
    dict: The metadata dictionary.</p>
</div>


                            </div>
                            <div id="Snapshot.set_metadata" class="classattr">
                                        <input id="Snapshot.set_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">metadata</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.set_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.set_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.set_metadata-143"><a href="#Snapshot.set_metadata-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
</span><span id="Snapshot.set_metadata-144"><a href="#Snapshot.set_metadata-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.set_metadata-145"><a href="#Snapshot.set_metadata-145"><span class="linenos">145</span></a><span class="sd">        Set or replace the metadata for the snapshot.</span>
</span><span id="Snapshot.set_metadata-146"><a href="#Snapshot.set_metadata-146"><span class="linenos">146</span></a>
</span><span id="Snapshot.set_metadata-147"><a href="#Snapshot.set_metadata-147"><span class="linenos">147</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.set_metadata-148"><a href="#Snapshot.set_metadata-148"><span class="linenos">148</span></a><span class="sd">            metadata (dict): The new metadata.</span>
</span><span id="Snapshot.set_metadata-149"><a href="#Snapshot.set_metadata-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.set_metadata-150"><a href="#Snapshot.set_metadata-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
</span></pre></div>


            <div class="docstring"><p>Set or replace the metadata for the snapshot.</p>

<p>Args:
    metadata (dict): The new metadata.</p>
</div>


                            </div>
                            <div id="Snapshot.get_timestamp" class="classattr">
                                        <input id="Snapshot.get_timestamp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_timestamp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.get_timestamp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.get_timestamp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.get_timestamp-152"><a href="#Snapshot.get_timestamp-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">get_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Snapshot.get_timestamp-153"><a href="#Snapshot.get_timestamp-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.get_timestamp-154"><a href="#Snapshot.get_timestamp-154"><span class="linenos">154</span></a><span class="sd">        Retrieve the timestamp of when the snapshot was created.</span>
</span><span id="Snapshot.get_timestamp-155"><a href="#Snapshot.get_timestamp-155"><span class="linenos">155</span></a>
</span><span id="Snapshot.get_timestamp-156"><a href="#Snapshot.get_timestamp-156"><span class="linenos">156</span></a><span class="sd">        Returns:</span>
</span><span id="Snapshot.get_timestamp-157"><a href="#Snapshot.get_timestamp-157"><span class="linenos">157</span></a><span class="sd">            float: The timestamp.</span>
</span><span id="Snapshot.get_timestamp-158"><a href="#Snapshot.get_timestamp-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.get_timestamp-159"><a href="#Snapshot.get_timestamp-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the timestamp of when the snapshot was created.</p>

<p>Returns:
    float: The timestamp.</p>
</div>


                            </div>
                            <div id="Snapshot.set_timestamp" class="classattr">
                                        <input id="Snapshot.set_timestamp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_timestamp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">timestamp</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.set_timestamp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.set_timestamp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.set_timestamp-161"><a href="#Snapshot.set_timestamp-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">set_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
</span><span id="Snapshot.set_timestamp-162"><a href="#Snapshot.set_timestamp-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.set_timestamp-163"><a href="#Snapshot.set_timestamp-163"><span class="linenos">163</span></a><span class="sd">        Set or update the timestamp for the snapshot.</span>
</span><span id="Snapshot.set_timestamp-164"><a href="#Snapshot.set_timestamp-164"><span class="linenos">164</span></a>
</span><span id="Snapshot.set_timestamp-165"><a href="#Snapshot.set_timestamp-165"><span class="linenos">165</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.set_timestamp-166"><a href="#Snapshot.set_timestamp-166"><span class="linenos">166</span></a><span class="sd">            timestamp (float): The new timestamp value.</span>
</span><span id="Snapshot.set_timestamp-167"><a href="#Snapshot.set_timestamp-167"><span class="linenos">167</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.set_timestamp-168"><a href="#Snapshot.set_timestamp-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>
</span></pre></div>


            <div class="docstring"><p>Set or update the timestamp for the snapshot.</p>

<p>Args:
    timestamp (float): The new timestamp value.</p>
</div>


                            </div>
                            <div id="Snapshot.update_metadata" class="classattr">
                                        <input id="Snapshot.update_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">new_metadata</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Snapshot.update_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Snapshot.update_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Snapshot.update_metadata-170"><a href="#Snapshot.update_metadata-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_metadata</span><span class="p">):</span>
</span><span id="Snapshot.update_metadata-171"><a href="#Snapshot.update_metadata-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Snapshot.update_metadata-172"><a href="#Snapshot.update_metadata-172"><span class="linenos">172</span></a><span class="sd">        Update the metadata of the snapshot.</span>
</span><span id="Snapshot.update_metadata-173"><a href="#Snapshot.update_metadata-173"><span class="linenos">173</span></a>
</span><span id="Snapshot.update_metadata-174"><a href="#Snapshot.update_metadata-174"><span class="linenos">174</span></a><span class="sd">        Args:</span>
</span><span id="Snapshot.update_metadata-175"><a href="#Snapshot.update_metadata-175"><span class="linenos">175</span></a><span class="sd">            new_metadata (dict): Metadata to update.</span>
</span><span id="Snapshot.update_metadata-176"><a href="#Snapshot.update_metadata-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Snapshot.update_metadata-177"><a href="#Snapshot.update_metadata-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update the metadata of the snapshot.</p>

<p>Args:
    new_metadata (dict): Metadata to update.</p>
</div>


                            </div>
                </section>
                <section id="PyTreeSnapshotManager">
                            <input id="PyTreeSnapshotManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PyTreeSnapshotManager</span><wbr>(<span class="base"><a href="#SnapshotManager">snapshot_manager.SnapshotManager</a></span>):

                <label class="view-source-button" for="PyTreeSnapshotManager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager-13"><a href="#PyTreeSnapshotManager-13"><span class="linenos"> 13</span></a><span class="k">class</span> <span class="nc">PyTreeSnapshotManager</span><span class="p">(</span><span class="n">SnapshotManager</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-14"><a href="#PyTreeSnapshotManager-14"><span class="linenos"> 14</span></a>
</span><span id="PyTreeSnapshotManager-15"><a href="#PyTreeSnapshotManager-15"><span class="linenos"> 15</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">query_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-16"><a href="#PyTreeSnapshotManager-16"><span class="linenos"> 16</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-17"><a href="#PyTreeSnapshotManager-17"><span class="linenos"> 17</span></a><span class="sd">        Initialize the PyTreeSnapshotManager.</span>
</span><span id="PyTreeSnapshotManager-18"><a href="#PyTreeSnapshotManager-18"><span class="linenos"> 18</span></a>
</span><span id="PyTreeSnapshotManager-19"><a href="#PyTreeSnapshotManager-19"><span class="linenos"> 19</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-20"><a href="#PyTreeSnapshotManager-20"><span class="linenos"> 20</span></a><span class="sd">            query_class (type, optional): A class implementing PyTreeSnapshotQueryInterface.</span>
</span><span id="PyTreeSnapshotManager-21"><a href="#PyTreeSnapshotManager-21"><span class="linenos"> 21</span></a><span class="sd">                                           Defaults to PyTreeSnapshotQuery.</span>
</span><span id="PyTreeSnapshotManager-22"><a href="#PyTreeSnapshotManager-22"><span class="linenos"> 22</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-23"><a href="#PyTreeSnapshotManager-23"><span class="linenos"> 23</span></a>        <span class="c1"># Default to PyTreeSnapshotQuery if no query class is provided</span>
</span><span id="PyTreeSnapshotManager-24"><a href="#PyTreeSnapshotManager-24"><span class="linenos"> 24</span></a>        <span class="n">query_class</span> <span class="o">=</span> <span class="n">query_class</span> <span class="ow">or</span> <span class="n">PyTreeSnapshotQuery</span>
</span><span id="PyTreeSnapshotManager-25"><a href="#PyTreeSnapshotManager-25"><span class="linenos"> 25</span></a>
</span><span id="PyTreeSnapshotManager-26"><a href="#PyTreeSnapshotManager-26"><span class="linenos"> 26</span></a>        <span class="c1"># Validate that the provided query class implements PyTreeSnapshotQueryInterface</span>
</span><span id="PyTreeSnapshotManager-27"><a href="#PyTreeSnapshotManager-27"><span class="linenos"> 27</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">query_class</span><span class="p">,</span> <span class="n">PyTreeSnapshotQueryInterface</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-28"><a href="#PyTreeSnapshotManager-28"><span class="linenos"> 28</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager-29"><a href="#PyTreeSnapshotManager-29"><span class="linenos"> 29</span></a>                <span class="sa">f</span><span class="s2">&quot;The query_class must implement PyTreeSnapshotQueryInterface. &quot;</span>
</span><span id="PyTreeSnapshotManager-30"><a href="#PyTreeSnapshotManager-30"><span class="linenos"> 30</span></a>                <span class="sa">f</span><span class="s2">&quot;Received: </span><span class="si">{</span><span class="n">query_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PyTreeSnapshotManager-31"><a href="#PyTreeSnapshotManager-31"><span class="linenos"> 31</span></a>            <span class="p">)</span>
</span><span id="PyTreeSnapshotManager-32"><a href="#PyTreeSnapshotManager-32"><span class="linenos"> 32</span></a>
</span><span id="PyTreeSnapshotManager-33"><a href="#PyTreeSnapshotManager-33"><span class="linenos"> 33</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">query_class</span><span class="o">=</span><span class="n">query_class</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-34"><a href="#PyTreeSnapshotManager-34"><span class="linenos"> 34</span></a>
</span><span id="PyTreeSnapshotManager-35"><a href="#PyTreeSnapshotManager-35"><span class="linenos"> 35</span></a>    <span class="k">def</span> <span class="nf">tree_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-36"><a href="#PyTreeSnapshotManager-36"><span class="linenos"> 36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-37"><a href="#PyTreeSnapshotManager-37"><span class="linenos"> 37</span></a><span class="sd">        Apply a transformation function to the PyTree(s) of specified snapshots.</span>
</span><span id="PyTreeSnapshotManager-38"><a href="#PyTreeSnapshotManager-38"><span class="linenos"> 38</span></a>
</span><span id="PyTreeSnapshotManager-39"><a href="#PyTreeSnapshotManager-39"><span class="linenos"> 39</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-40"><a href="#PyTreeSnapshotManager-40"><span class="linenos"> 40</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshotManager-41"><a href="#PyTreeSnapshotManager-41"><span class="linenos"> 41</span></a><span class="sd">                            The function should take a single argument (leaf) and return the transformed leaf.</span>
</span><span id="PyTreeSnapshotManager-42"><a href="#PyTreeSnapshotManager-42"><span class="linenos"> 42</span></a><span class="sd">            snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.</span>
</span><span id="PyTreeSnapshotManager-43"><a href="#PyTreeSnapshotManager-43"><span class="linenos"> 43</span></a><span class="sd">                                                        If None, all snapshots in storage will be affected.</span>
</span><span id="PyTreeSnapshotManager-44"><a href="#PyTreeSnapshotManager-44"><span class="linenos"> 44</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</span>
</span><span id="PyTreeSnapshotManager-45"><a href="#PyTreeSnapshotManager-45"><span class="linenos"> 45</span></a>
</span><span id="PyTreeSnapshotManager-46"><a href="#PyTreeSnapshotManager-46"><span class="linenos"> 46</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager-47"><a href="#PyTreeSnapshotManager-47"><span class="linenos"> 47</span></a><span class="sd">            PyTree or list: A transformed PyTree if a single snapshot_id is provided,</span>
</span><span id="PyTreeSnapshotManager-48"><a href="#PyTreeSnapshotManager-48"><span class="linenos"> 48</span></a><span class="sd">                            a list of transformed PyTrees otherwise.</span>
</span><span id="PyTreeSnapshotManager-49"><a href="#PyTreeSnapshotManager-49"><span class="linenos"> 49</span></a>
</span><span id="PyTreeSnapshotManager-50"><a href="#PyTreeSnapshotManager-50"><span class="linenos"> 50</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager-51"><a href="#PyTreeSnapshotManager-51"><span class="linenos"> 51</span></a><span class="sd">            TypeError: If a snapshot is not a PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager-52"><a href="#PyTreeSnapshotManager-52"><span class="linenos"> 52</span></a><span class="sd">            ValueError: If no valid snapshots are found for the given snapshot_ids.</span>
</span><span id="PyTreeSnapshotManager-53"><a href="#PyTreeSnapshotManager-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-54"><a href="#PyTreeSnapshotManager-54"><span class="linenos"> 54</span></a>        <span class="c1"># Normalize snapshot_ids</span>
</span><span id="PyTreeSnapshotManager-55"><a href="#PyTreeSnapshotManager-55"><span class="linenos"> 55</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># Single snapshot ID</span>
</span><span id="PyTreeSnapshotManager-56"><a href="#PyTreeSnapshotManager-56"><span class="linenos"> 56</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">snapshot_ids</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager-57"><a href="#PyTreeSnapshotManager-57"><span class="linenos"> 57</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PyTreeSnapshotManager-58"><a href="#PyTreeSnapshotManager-58"><span class="linenos"> 58</span></a>        <span class="k">elif</span> <span class="n">snapshot_ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># All snapshots</span>
</span><span id="PyTreeSnapshotManager-59"><a href="#PyTreeSnapshotManager-59"><span class="linenos"> 59</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager-60"><a href="#PyTreeSnapshotManager-60"><span class="linenos"> 60</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PyTreeSnapshotManager-61"><a href="#PyTreeSnapshotManager-61"><span class="linenos"> 61</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># List of snapshot IDs</span>
</span><span id="PyTreeSnapshotManager-62"><a href="#PyTreeSnapshotManager-62"><span class="linenos"> 62</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PyTreeSnapshotManager-63"><a href="#PyTreeSnapshotManager-63"><span class="linenos"> 63</span></a>
</span><span id="PyTreeSnapshotManager-64"><a href="#PyTreeSnapshotManager-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-65"><a href="#PyTreeSnapshotManager-65"><span class="linenos"> 65</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No snapshot IDs provided or available.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-66"><a href="#PyTreeSnapshotManager-66"><span class="linenos"> 66</span></a>
</span><span id="PyTreeSnapshotManager-67"><a href="#PyTreeSnapshotManager-67"><span class="linenos"> 67</span></a>        <span class="n">transformed_pytrees</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PyTreeSnapshotManager-68"><a href="#PyTreeSnapshotManager-68"><span class="linenos"> 68</span></a>
</span><span id="PyTreeSnapshotManager-69"><a href="#PyTreeSnapshotManager-69"><span class="linenos"> 69</span></a>        <span class="k">for</span> <span class="n">snap_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-70"><a href="#PyTreeSnapshotManager-70"><span class="linenos"> 70</span></a>            <span class="c1"># Retrieve the snapshot</span>
</span><span id="PyTreeSnapshotManager-71"><a href="#PyTreeSnapshotManager-71"><span class="linenos"> 71</span></a>            <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snap_id</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-72"><a href="#PyTreeSnapshotManager-72"><span class="linenos"> 72</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-73"><a href="#PyTreeSnapshotManager-73"><span class="linenos"> 73</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot </span><span class="si">{</span><span class="n">snap_id</span><span class="si">}</span><span class="s2"> is not a PyTreeSnapshot.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-74"><a href="#PyTreeSnapshotManager-74"><span class="linenos"> 74</span></a>
</span><span id="PyTreeSnapshotManager-75"><a href="#PyTreeSnapshotManager-75"><span class="linenos"> 75</span></a>            <span class="c1"># Apply the tree_map transformation</span>
</span><span id="PyTreeSnapshotManager-76"><a href="#PyTreeSnapshotManager-76"><span class="linenos"> 76</span></a>            <span class="n">transformed_pytree</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-77"><a href="#PyTreeSnapshotManager-77"><span class="linenos"> 77</span></a>            <span class="n">transformed_pytrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-78"><a href="#PyTreeSnapshotManager-78"><span class="linenos"> 78</span></a>
</span><span id="PyTreeSnapshotManager-79"><a href="#PyTreeSnapshotManager-79"><span class="linenos"> 79</span></a>        <span class="k">if</span> <span class="n">single_return</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-80"><a href="#PyTreeSnapshotManager-80"><span class="linenos"> 80</span></a>            <span class="k">return</span> <span class="n">transformed_pytrees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Return a single PyTree if only one snapshot ID was provided</span>
</span><span id="PyTreeSnapshotManager-81"><a href="#PyTreeSnapshotManager-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="n">transformed_pytrees</span>  <span class="c1"># Return a list of PyTrees otherwise</span>
</span><span id="PyTreeSnapshotManager-82"><a href="#PyTreeSnapshotManager-82"><span class="linenos"> 82</span></a>
</span><span id="PyTreeSnapshotManager-83"><a href="#PyTreeSnapshotManager-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">tree_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-84"><a href="#PyTreeSnapshotManager-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-85"><a href="#PyTreeSnapshotManager-85"><span class="linenos"> 85</span></a><span class="sd">        Apply a transformation function to the PyTree(s) of specified snapshots and replace them in the storage.</span>
</span><span id="PyTreeSnapshotManager-86"><a href="#PyTreeSnapshotManager-86"><span class="linenos"> 86</span></a>
</span><span id="PyTreeSnapshotManager-87"><a href="#PyTreeSnapshotManager-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-88"><a href="#PyTreeSnapshotManager-88"><span class="linenos"> 88</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshotManager-89"><a href="#PyTreeSnapshotManager-89"><span class="linenos"> 89</span></a><span class="sd">                            The function should take a single argument (leaf) and return the transformed leaf.</span>
</span><span id="PyTreeSnapshotManager-90"><a href="#PyTreeSnapshotManager-90"><span class="linenos"> 90</span></a><span class="sd">            snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.</span>
</span><span id="PyTreeSnapshotManager-91"><a href="#PyTreeSnapshotManager-91"><span class="linenos"> 91</span></a><span class="sd">                                                        If None, all snapshots in storage will be affected.</span>
</span><span id="PyTreeSnapshotManager-92"><a href="#PyTreeSnapshotManager-92"><span class="linenos"> 92</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</span>
</span><span id="PyTreeSnapshotManager-93"><a href="#PyTreeSnapshotManager-93"><span class="linenos"> 93</span></a>
</span><span id="PyTreeSnapshotManager-94"><a href="#PyTreeSnapshotManager-94"><span class="linenos"> 94</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager-95"><a href="#PyTreeSnapshotManager-95"><span class="linenos"> 95</span></a><span class="sd">            TypeError: If a snapshot is not a PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager-96"><a href="#PyTreeSnapshotManager-96"><span class="linenos"> 96</span></a>
</span><span id="PyTreeSnapshotManager-97"><a href="#PyTreeSnapshotManager-97"><span class="linenos"> 97</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager-98"><a href="#PyTreeSnapshotManager-98"><span class="linenos"> 98</span></a><span class="sd">            Replace all snapshots with a transformation applied:</span>
</span><span id="PyTreeSnapshotManager-99"><a href="#PyTreeSnapshotManager-99"><span class="linenos"> 99</span></a><span class="sd">                manager.tree_replace(func=lambda x: x + 1)</span>
</span><span id="PyTreeSnapshotManager-100"><a href="#PyTreeSnapshotManager-100"><span class="linenos">100</span></a>
</span><span id="PyTreeSnapshotManager-101"><a href="#PyTreeSnapshotManager-101"><span class="linenos">101</span></a><span class="sd">            Replace a specific snapshot:</span>
</span><span id="PyTreeSnapshotManager-102"><a href="#PyTreeSnapshotManager-102"><span class="linenos">102</span></a><span class="sd">                manager.tree_replace(</span>
</span><span id="PyTreeSnapshotManager-103"><a href="#PyTreeSnapshotManager-103"><span class="linenos">103</span></a><span class="sd">                    func=lambda x: x * 2,</span>
</span><span id="PyTreeSnapshotManager-104"><a href="#PyTreeSnapshotManager-104"><span class="linenos">104</span></a><span class="sd">                    snapshot_ids=&quot;snapshot123&quot;</span>
</span><span id="PyTreeSnapshotManager-105"><a href="#PyTreeSnapshotManager-105"><span class="linenos">105</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager-106"><a href="#PyTreeSnapshotManager-106"><span class="linenos">106</span></a>
</span><span id="PyTreeSnapshotManager-107"><a href="#PyTreeSnapshotManager-107"><span class="linenos">107</span></a><span class="sd">            Replace multiple snapshots with custom leaf detection:</span>
</span><span id="PyTreeSnapshotManager-108"><a href="#PyTreeSnapshotManager-108"><span class="linenos">108</span></a><span class="sd">                manager.tree_replace(</span>
</span><span id="PyTreeSnapshotManager-109"><a href="#PyTreeSnapshotManager-109"><span class="linenos">109</span></a><span class="sd">                    func=lambda x: x.lower(),</span>
</span><span id="PyTreeSnapshotManager-110"><a href="#PyTreeSnapshotManager-110"><span class="linenos">110</span></a><span class="sd">                    snapshot_ids=[&quot;snapshot123&quot;, &quot;snapshot456&quot;],</span>
</span><span id="PyTreeSnapshotManager-111"><a href="#PyTreeSnapshotManager-111"><span class="linenos">111</span></a><span class="sd">                    is_leaf=lambda x: isinstance(x, str)</span>
</span><span id="PyTreeSnapshotManager-112"><a href="#PyTreeSnapshotManager-112"><span class="linenos">112</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager-113"><a href="#PyTreeSnapshotManager-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-114"><a href="#PyTreeSnapshotManager-114"><span class="linenos">114</span></a>        <span class="c1"># Normalize snapshot_ids into a list</span>
</span><span id="PyTreeSnapshotManager-115"><a href="#PyTreeSnapshotManager-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-116"><a href="#PyTreeSnapshotManager-116"><span class="linenos">116</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">snapshot_ids</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager-117"><a href="#PyTreeSnapshotManager-117"><span class="linenos">117</span></a>        <span class="k">elif</span> <span class="n">snapshot_ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-118"><a href="#PyTreeSnapshotManager-118"><span class="linenos">118</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager-119"><a href="#PyTreeSnapshotManager-119"><span class="linenos">119</span></a>
</span><span id="PyTreeSnapshotManager-120"><a href="#PyTreeSnapshotManager-120"><span class="linenos">120</span></a>        <span class="k">for</span> <span class="n">snap_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-121"><a href="#PyTreeSnapshotManager-121"><span class="linenos">121</span></a>            <span class="c1"># Retrieve the snapshot</span>
</span><span id="PyTreeSnapshotManager-122"><a href="#PyTreeSnapshotManager-122"><span class="linenos">122</span></a>            <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snap_id</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-123"><a href="#PyTreeSnapshotManager-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-124"><a href="#PyTreeSnapshotManager-124"><span class="linenos">124</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot </span><span class="si">{</span><span class="n">snap_id</span><span class="si">}</span><span class="s2"> is not a PyTreeSnapshot.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-125"><a href="#PyTreeSnapshotManager-125"><span class="linenos">125</span></a>
</span><span id="PyTreeSnapshotManager-126"><a href="#PyTreeSnapshotManager-126"><span class="linenos">126</span></a>            <span class="c1"># Replace the PyTree in the existing snapshot</span>
</span><span id="PyTreeSnapshotManager-127"><a href="#PyTreeSnapshotManager-127"><span class="linenos">127</span></a>            <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-128"><a href="#PyTreeSnapshotManager-128"><span class="linenos">128</span></a>
</span><span id="PyTreeSnapshotManager-129"><a href="#PyTreeSnapshotManager-129"><span class="linenos">129</span></a>            <span class="c1"># Update the snapshot in storage</span>
</span><span id="PyTreeSnapshotManager-130"><a href="#PyTreeSnapshotManager-130"><span class="linenos">130</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">add_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-131"><a href="#PyTreeSnapshotManager-131"><span class="linenos">131</span></a>
</span><span id="PyTreeSnapshotManager-132"><a href="#PyTreeSnapshotManager-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">tree_combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-133"><a href="#PyTreeSnapshotManager-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-134"><a href="#PyTreeSnapshotManager-134"><span class="linenos">134</span></a><span class="sd">        Combine multiple snapshots&#39; PyTrees into a single PyTree using a custom function,</span>
</span><span id="PyTreeSnapshotManager-135"><a href="#PyTreeSnapshotManager-135"><span class="linenos">135</span></a><span class="sd">        and returns it.</span>
</span><span id="PyTreeSnapshotManager-136"><a href="#PyTreeSnapshotManager-136"><span class="linenos">136</span></a>
</span><span id="PyTreeSnapshotManager-137"><a href="#PyTreeSnapshotManager-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-138"><a href="#PyTreeSnapshotManager-138"><span class="linenos">138</span></a><span class="sd">            snapshot_ids (list or None, optional): A list of IDs of the snapshots to combine.</span>
</span><span id="PyTreeSnapshotManager-139"><a href="#PyTreeSnapshotManager-139"><span class="linenos">139</span></a><span class="sd">                                                If None, all snapshots in storage are used.</span>
</span><span id="PyTreeSnapshotManager-140"><a href="#PyTreeSnapshotManager-140"><span class="linenos">140</span></a><span class="sd">            combine_fn (callable): A function to combine corresponding leaves of the PyTrees.</span>
</span><span id="PyTreeSnapshotManager-141"><a href="#PyTreeSnapshotManager-141"><span class="linenos">141</span></a><span class="sd">                                This function takes a list of values (one from each snapshot)</span>
</span><span id="PyTreeSnapshotManager-142"><a href="#PyTreeSnapshotManager-142"><span class="linenos">142</span></a><span class="sd">                                and returns a single combined value.</span>
</span><span id="PyTreeSnapshotManager-143"><a href="#PyTreeSnapshotManager-143"><span class="linenos">143</span></a>
</span><span id="PyTreeSnapshotManager-144"><a href="#PyTreeSnapshotManager-144"><span class="linenos">144</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager-145"><a href="#PyTreeSnapshotManager-145"><span class="linenos">145</span></a><span class="sd">            PyTree: returns the combined PyTree</span>
</span><span id="PyTreeSnapshotManager-146"><a href="#PyTreeSnapshotManager-146"><span class="linenos">146</span></a>
</span><span id="PyTreeSnapshotManager-147"><a href="#PyTreeSnapshotManager-147"><span class="linenos">147</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager-148"><a href="#PyTreeSnapshotManager-148"><span class="linenos">148</span></a><span class="sd">            ValueError: If `combine_fn` is not provided.</span>
</span><span id="PyTreeSnapshotManager-149"><a href="#PyTreeSnapshotManager-149"><span class="linenos">149</span></a><span class="sd">            TypeError: If the snapshots are not PyTreeSnapshots or their structures do not match.</span>
</span><span id="PyTreeSnapshotManager-150"><a href="#PyTreeSnapshotManager-150"><span class="linenos">150</span></a>
</span><span id="PyTreeSnapshotManager-151"><a href="#PyTreeSnapshotManager-151"><span class="linenos">151</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager-152"><a href="#PyTreeSnapshotManager-152"><span class="linenos">152</span></a><span class="sd">            Combine all snapshot pytrees with an addition operation:</span>
</span><span id="PyTreeSnapshotManager-153"><a href="#PyTreeSnapshotManager-153"><span class="linenos">153</span></a><span class="sd">                combined_pytree = manager.tree_combine(</span>
</span><span id="PyTreeSnapshotManager-154"><a href="#PyTreeSnapshotManager-154"><span class="linenos">154</span></a><span class="sd">                    combine_fn=lambda leaves: sum(leaves)</span>
</span><span id="PyTreeSnapshotManager-155"><a href="#PyTreeSnapshotManager-155"><span class="linenos">155</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager-156"><a href="#PyTreeSnapshotManager-156"><span class="linenos">156</span></a>
</span><span id="PyTreeSnapshotManager-157"><a href="#PyTreeSnapshotManager-157"><span class="linenos">157</span></a><span class="sd">            Combine specific snapshot pytrees:</span>
</span><span id="PyTreeSnapshotManager-158"><a href="#PyTreeSnapshotManager-158"><span class="linenos">158</span></a><span class="sd">                combined_pytree = manager.tree_combine(</span>
</span><span id="PyTreeSnapshotManager-159"><a href="#PyTreeSnapshotManager-159"><span class="linenos">159</span></a><span class="sd">                    snapshot_ids=[&quot;snapshot1&quot;, &quot;snapshot2&quot;],</span>
</span><span id="PyTreeSnapshotManager-160"><a href="#PyTreeSnapshotManager-160"><span class="linenos">160</span></a><span class="sd">                    combine_fn=lambda leaves: max(leaves)</span>
</span><span id="PyTreeSnapshotManager-161"><a href="#PyTreeSnapshotManager-161"><span class="linenos">161</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager-162"><a href="#PyTreeSnapshotManager-162"><span class="linenos">162</span></a>
</span><span id="PyTreeSnapshotManager-163"><a href="#PyTreeSnapshotManager-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-164"><a href="#PyTreeSnapshotManager-164"><span class="linenos">164</span></a>
</span><span id="PyTreeSnapshotManager-165"><a href="#PyTreeSnapshotManager-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="n">combine_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager-166"><a href="#PyTreeSnapshotManager-166"><span class="linenos">166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A combine_fn must be provided to combine PyTrees.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-167"><a href="#PyTreeSnapshotManager-167"><span class="linenos">167</span></a>
</span><span id="PyTreeSnapshotManager-168"><a href="#PyTreeSnapshotManager-168"><span class="linenos">168</span></a>        <span class="c1"># Select snapshots to combine</span>
</span><span id="PyTreeSnapshotManager-169"><a href="#PyTreeSnapshotManager-169"><span class="linenos">169</span></a>        <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="n">snapshot_ids</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager-170"><a href="#PyTreeSnapshotManager-170"><span class="linenos">170</span></a>        <span class="n">pytree_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PyTreeSnapshotManager-171"><a href="#PyTreeSnapshotManager-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">snapshot_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span>
</span><span id="PyTreeSnapshotManager-172"><a href="#PyTreeSnapshotManager-172"><span class="linenos">172</span></a>        <span class="p">]</span>
</span><span id="PyTreeSnapshotManager-173"><a href="#PyTreeSnapshotManager-173"><span class="linenos">173</span></a>
</span><span id="PyTreeSnapshotManager-174"><a href="#PyTreeSnapshotManager-174"><span class="linenos">174</span></a>        <span class="c1"># Ensure all PyTrees have the same structure</span>
</span><span id="PyTreeSnapshotManager-175"><a href="#PyTreeSnapshotManager-175"><span class="linenos">175</span></a>        <span class="n">flattened</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager-176"><a href="#PyTreeSnapshotManager-176"><span class="linenos">176</span></a>            <span class="o">*</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span> <span class="k">for</span> <span class="n">pytree</span> <span class="ow">in</span> <span class="n">pytree_list</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager-177"><a href="#PyTreeSnapshotManager-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="PyTreeSnapshotManager-178"><a href="#PyTreeSnapshotManager-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-179"><a href="#PyTreeSnapshotManager-179"><span class="linenos">179</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All snapshots must have the same PyTree structure.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-180"><a href="#PyTreeSnapshotManager-180"><span class="linenos">180</span></a>
</span><span id="PyTreeSnapshotManager-181"><a href="#PyTreeSnapshotManager-181"><span class="linenos">181</span></a>        <span class="c1"># Apply the combine function to each set of corresponding leaves</span>
</span><span id="PyTreeSnapshotManager-182"><a href="#PyTreeSnapshotManager-182"><span class="linenos">182</span></a>        <span class="n">combined_leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">combine_fn</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span> <span class="k">for</span> <span class="n">leaves</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">flattened</span><span class="p">)]</span>
</span><span id="PyTreeSnapshotManager-183"><a href="#PyTreeSnapshotManager-183"><span class="linenos">183</span></a>
</span><span id="PyTreeSnapshotManager-184"><a href="#PyTreeSnapshotManager-184"><span class="linenos">184</span></a>        <span class="c1"># return the combined pytree</span>
</span><span id="PyTreeSnapshotManager-185"><a href="#PyTreeSnapshotManager-185"><span class="linenos">185</span></a>        <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_unflatten</span><span class="p">(</span><span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">combined_leaves</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager-186"><a href="#PyTreeSnapshotManager-186"><span class="linenos">186</span></a>
</span><span id="PyTreeSnapshotManager-187"><a href="#PyTreeSnapshotManager-187"><span class="linenos">187</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PyTreeSnapshotManager-188"><a href="#PyTreeSnapshotManager-188"><span class="linenos">188</span></a>    <span class="k">def</span> <span class="nf">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-189"><a href="#PyTreeSnapshotManager-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-190"><a href="#PyTreeSnapshotManager-190"><span class="linenos">190</span></a><span class="sd">        Load a PyTreeSnapshotManager state from a file.</span>
</span><span id="PyTreeSnapshotManager-191"><a href="#PyTreeSnapshotManager-191"><span class="linenos">191</span></a>
</span><span id="PyTreeSnapshotManager-192"><a href="#PyTreeSnapshotManager-192"><span class="linenos">192</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-193"><a href="#PyTreeSnapshotManager-193"><span class="linenos">193</span></a><span class="sd">            file_path (str): The file path of the saved state to load.</span>
</span><span id="PyTreeSnapshotManager-194"><a href="#PyTreeSnapshotManager-194"><span class="linenos">194</span></a>
</span><span id="PyTreeSnapshotManager-195"><a href="#PyTreeSnapshotManager-195"><span class="linenos">195</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager-196"><a href="#PyTreeSnapshotManager-196"><span class="linenos">196</span></a><span class="sd">            PyTreeSnapshotManager: An instance of `PyTreeSnapshotManager` with the loaded state.</span>
</span><span id="PyTreeSnapshotManager-197"><a href="#PyTreeSnapshotManager-197"><span class="linenos">197</span></a>
</span><span id="PyTreeSnapshotManager-198"><a href="#PyTreeSnapshotManager-198"><span class="linenos">198</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager-199"><a href="#PyTreeSnapshotManager-199"><span class="linenos">199</span></a><span class="sd">            FileNotFoundError: If the specified file does not exist.</span>
</span><span id="PyTreeSnapshotManager-200"><a href="#PyTreeSnapshotManager-200"><span class="linenos">200</span></a><span class="sd">            IOError: If there is an error reading the file.</span>
</span><span id="PyTreeSnapshotManager-201"><a href="#PyTreeSnapshotManager-201"><span class="linenos">201</span></a><span class="sd">            ValueError: If the file contents cannot be deserialized into the expected state.</span>
</span><span id="PyTreeSnapshotManager-202"><a href="#PyTreeSnapshotManager-202"><span class="linenos">202</span></a>
</span><span id="PyTreeSnapshotManager-203"><a href="#PyTreeSnapshotManager-203"><span class="linenos">203</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager-204"><a href="#PyTreeSnapshotManager-204"><span class="linenos">204</span></a><span class="sd">            Load a manager state from a saved file:</span>
</span><span id="PyTreeSnapshotManager-205"><a href="#PyTreeSnapshotManager-205"><span class="linenos">205</span></a><span class="sd">                manager = PyTreeSnapshotManager.load_from_file(&quot;snapshots_state.json&quot;)</span>
</span><span id="PyTreeSnapshotManager-206"><a href="#PyTreeSnapshotManager-206"><span class="linenos">206</span></a>
</span><span id="PyTreeSnapshotManager-207"><a href="#PyTreeSnapshotManager-207"><span class="linenos">207</span></a><span class="sd">            Access snapshots from the loaded manager:</span>
</span><span id="PyTreeSnapshotManager-208"><a href="#PyTreeSnapshotManager-208"><span class="linenos">208</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;snapshot_id&quot;)</span>
</span><span id="PyTreeSnapshotManager-209"><a href="#PyTreeSnapshotManager-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-210"><a href="#PyTreeSnapshotManager-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager-211"><a href="#PyTreeSnapshotManager-211"><span class="linenos">211</span></a>            <span class="n">file_path</span><span class="p">,</span> <span class="n">PyTreeSnapshotManager</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span>
</span><span id="PyTreeSnapshotManager-212"><a href="#PyTreeSnapshotManager-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span><span id="PyTreeSnapshotManager-213"><a href="#PyTreeSnapshotManager-213"><span class="linenos">213</span></a>
</span><span id="PyTreeSnapshotManager-214"><a href="#PyTreeSnapshotManager-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">_create_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager-215"><a href="#PyTreeSnapshotManager-215"><span class="linenos">215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-216"><a href="#PyTreeSnapshotManager-216"><span class="linenos">216</span></a><span class="sd">        Override the factory method to create a PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager-217"><a href="#PyTreeSnapshotManager-217"><span class="linenos">217</span></a>
</span><span id="PyTreeSnapshotManager-218"><a href="#PyTreeSnapshotManager-218"><span class="linenos">218</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager-219"><a href="#PyTreeSnapshotManager-219"><span class="linenos">219</span></a><span class="sd">            data: The data to store in the PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager-220"><a href="#PyTreeSnapshotManager-220"><span class="linenos">220</span></a><span class="sd">            metadata (dict): Metadata to associate with the snapshot.</span>
</span><span id="PyTreeSnapshotManager-221"><a href="#PyTreeSnapshotManager-221"><span class="linenos">221</span></a><span class="sd">            tags (list): Tags to associate with the snapshot.</span>
</span><span id="PyTreeSnapshotManager-222"><a href="#PyTreeSnapshotManager-222"><span class="linenos">222</span></a><span class="sd">            deepcopy (bool): Whether to deepcopy the data.</span>
</span><span id="PyTreeSnapshotManager-223"><a href="#PyTreeSnapshotManager-223"><span class="linenos">223</span></a><span class="sd">            snapshot_id (str): Identifier for the Snapshot.</span>
</span><span id="PyTreeSnapshotManager-224"><a href="#PyTreeSnapshotManager-224"><span class="linenos">224</span></a>
</span><span id="PyTreeSnapshotManager-225"><a href="#PyTreeSnapshotManager-225"><span class="linenos">225</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager-226"><a href="#PyTreeSnapshotManager-226"><span class="linenos">226</span></a><span class="sd">            PyTreeSnapshot: The created PyTreeSnapshot instance.</span>
</span><span id="PyTreeSnapshotManager-227"><a href="#PyTreeSnapshotManager-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager-228"><a href="#PyTreeSnapshotManager-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="n">PyTreeSnapshot</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager-229"><a href="#PyTreeSnapshotManager-229"><span class="linenos">229</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="PyTreeSnapshotManager-230"><a href="#PyTreeSnapshotManager-230"><span class="linenos">230</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
</span><span id="PyTreeSnapshotManager-231"><a href="#PyTreeSnapshotManager-231"><span class="linenos">231</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
</span><span id="PyTreeSnapshotManager-232"><a href="#PyTreeSnapshotManager-232"><span class="linenos">232</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">,</span>
</span><span id="PyTreeSnapshotManager-233"><a href="#PyTreeSnapshotManager-233"><span class="linenos">233</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">,</span>
</span><span id="PyTreeSnapshotManager-234"><a href="#PyTreeSnapshotManager-234"><span class="linenos">234</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A manager for storing and managing data snapshots.</p>
</div>


                            <div id="PyTreeSnapshotManager.__init__" class="classattr">
                                        <input id="PyTreeSnapshotManager.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PyTreeSnapshotManager</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">query_class</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="PyTreeSnapshotManager.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager.__init__-15"><a href="#PyTreeSnapshotManager.__init__-15"><span class="linenos">15</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">query_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.__init__-16"><a href="#PyTreeSnapshotManager.__init__-16"><span class="linenos">16</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.__init__-17"><a href="#PyTreeSnapshotManager.__init__-17"><span class="linenos">17</span></a><span class="sd">        Initialize the PyTreeSnapshotManager.</span>
</span><span id="PyTreeSnapshotManager.__init__-18"><a href="#PyTreeSnapshotManager.__init__-18"><span class="linenos">18</span></a>
</span><span id="PyTreeSnapshotManager.__init__-19"><a href="#PyTreeSnapshotManager.__init__-19"><span class="linenos">19</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager.__init__-20"><a href="#PyTreeSnapshotManager.__init__-20"><span class="linenos">20</span></a><span class="sd">            query_class (type, optional): A class implementing PyTreeSnapshotQueryInterface.</span>
</span><span id="PyTreeSnapshotManager.__init__-21"><a href="#PyTreeSnapshotManager.__init__-21"><span class="linenos">21</span></a><span class="sd">                                           Defaults to PyTreeSnapshotQuery.</span>
</span><span id="PyTreeSnapshotManager.__init__-22"><a href="#PyTreeSnapshotManager.__init__-22"><span class="linenos">22</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.__init__-23"><a href="#PyTreeSnapshotManager.__init__-23"><span class="linenos">23</span></a>        <span class="c1"># Default to PyTreeSnapshotQuery if no query class is provided</span>
</span><span id="PyTreeSnapshotManager.__init__-24"><a href="#PyTreeSnapshotManager.__init__-24"><span class="linenos">24</span></a>        <span class="n">query_class</span> <span class="o">=</span> <span class="n">query_class</span> <span class="ow">or</span> <span class="n">PyTreeSnapshotQuery</span>
</span><span id="PyTreeSnapshotManager.__init__-25"><a href="#PyTreeSnapshotManager.__init__-25"><span class="linenos">25</span></a>
</span><span id="PyTreeSnapshotManager.__init__-26"><a href="#PyTreeSnapshotManager.__init__-26"><span class="linenos">26</span></a>        <span class="c1"># Validate that the provided query class implements PyTreeSnapshotQueryInterface</span>
</span><span id="PyTreeSnapshotManager.__init__-27"><a href="#PyTreeSnapshotManager.__init__-27"><span class="linenos">27</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">query_class</span><span class="p">,</span> <span class="n">PyTreeSnapshotQueryInterface</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.__init__-28"><a href="#PyTreeSnapshotManager.__init__-28"><span class="linenos">28</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager.__init__-29"><a href="#PyTreeSnapshotManager.__init__-29"><span class="linenos">29</span></a>                <span class="sa">f</span><span class="s2">&quot;The query_class must implement PyTreeSnapshotQueryInterface. &quot;</span>
</span><span id="PyTreeSnapshotManager.__init__-30"><a href="#PyTreeSnapshotManager.__init__-30"><span class="linenos">30</span></a>                <span class="sa">f</span><span class="s2">&quot;Received: </span><span class="si">{</span><span class="n">query_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PyTreeSnapshotManager.__init__-31"><a href="#PyTreeSnapshotManager.__init__-31"><span class="linenos">31</span></a>            <span class="p">)</span>
</span><span id="PyTreeSnapshotManager.__init__-32"><a href="#PyTreeSnapshotManager.__init__-32"><span class="linenos">32</span></a>
</span><span id="PyTreeSnapshotManager.__init__-33"><a href="#PyTreeSnapshotManager.__init__-33"><span class="linenos">33</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">query_class</span><span class="o">=</span><span class="n">query_class</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the PyTreeSnapshotManager.</p>

<p>Args:
    query_class (type, optional): A class implementing PyTreeSnapshotQueryInterface.
                                   Defaults to PyTreeSnapshotQuery.</p>
</div>


                            </div>
                            <div id="PyTreeSnapshotManager.tree_map" class="classattr">
                                        <input id="PyTreeSnapshotManager.tree_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tree_map</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">func</span>, </span><span class="param"><span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshotManager.tree_map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager.tree_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager.tree_map-35"><a href="#PyTreeSnapshotManager.tree_map-35"><span class="linenos">35</span></a>    <span class="k">def</span> <span class="nf">tree_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_map-36"><a href="#PyTreeSnapshotManager.tree_map-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_map-37"><a href="#PyTreeSnapshotManager.tree_map-37"><span class="linenos">37</span></a><span class="sd">        Apply a transformation function to the PyTree(s) of specified snapshots.</span>
</span><span id="PyTreeSnapshotManager.tree_map-38"><a href="#PyTreeSnapshotManager.tree_map-38"><span class="linenos">38</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-39"><a href="#PyTreeSnapshotManager.tree_map-39"><span class="linenos">39</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager.tree_map-40"><a href="#PyTreeSnapshotManager.tree_map-40"><span class="linenos">40</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshotManager.tree_map-41"><a href="#PyTreeSnapshotManager.tree_map-41"><span class="linenos">41</span></a><span class="sd">                            The function should take a single argument (leaf) and return the transformed leaf.</span>
</span><span id="PyTreeSnapshotManager.tree_map-42"><a href="#PyTreeSnapshotManager.tree_map-42"><span class="linenos">42</span></a><span class="sd">            snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.</span>
</span><span id="PyTreeSnapshotManager.tree_map-43"><a href="#PyTreeSnapshotManager.tree_map-43"><span class="linenos">43</span></a><span class="sd">                                                        If None, all snapshots in storage will be affected.</span>
</span><span id="PyTreeSnapshotManager.tree_map-44"><a href="#PyTreeSnapshotManager.tree_map-44"><span class="linenos">44</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</span>
</span><span id="PyTreeSnapshotManager.tree_map-45"><a href="#PyTreeSnapshotManager.tree_map-45"><span class="linenos">45</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-46"><a href="#PyTreeSnapshotManager.tree_map-46"><span class="linenos">46</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager.tree_map-47"><a href="#PyTreeSnapshotManager.tree_map-47"><span class="linenos">47</span></a><span class="sd">            PyTree or list: A transformed PyTree if a single snapshot_id is provided,</span>
</span><span id="PyTreeSnapshotManager.tree_map-48"><a href="#PyTreeSnapshotManager.tree_map-48"><span class="linenos">48</span></a><span class="sd">                            a list of transformed PyTrees otherwise.</span>
</span><span id="PyTreeSnapshotManager.tree_map-49"><a href="#PyTreeSnapshotManager.tree_map-49"><span class="linenos">49</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-50"><a href="#PyTreeSnapshotManager.tree_map-50"><span class="linenos">50</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager.tree_map-51"><a href="#PyTreeSnapshotManager.tree_map-51"><span class="linenos">51</span></a><span class="sd">            TypeError: If a snapshot is not a PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager.tree_map-52"><a href="#PyTreeSnapshotManager.tree_map-52"><span class="linenos">52</span></a><span class="sd">            ValueError: If no valid snapshots are found for the given snapshot_ids.</span>
</span><span id="PyTreeSnapshotManager.tree_map-53"><a href="#PyTreeSnapshotManager.tree_map-53"><span class="linenos">53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_map-54"><a href="#PyTreeSnapshotManager.tree_map-54"><span class="linenos">54</span></a>        <span class="c1"># Normalize snapshot_ids</span>
</span><span id="PyTreeSnapshotManager.tree_map-55"><a href="#PyTreeSnapshotManager.tree_map-55"><span class="linenos">55</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># Single snapshot ID</span>
</span><span id="PyTreeSnapshotManager.tree_map-56"><a href="#PyTreeSnapshotManager.tree_map-56"><span class="linenos">56</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">snapshot_ids</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager.tree_map-57"><a href="#PyTreeSnapshotManager.tree_map-57"><span class="linenos">57</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PyTreeSnapshotManager.tree_map-58"><a href="#PyTreeSnapshotManager.tree_map-58"><span class="linenos">58</span></a>        <span class="k">elif</span> <span class="n">snapshot_ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># All snapshots</span>
</span><span id="PyTreeSnapshotManager.tree_map-59"><a href="#PyTreeSnapshotManager.tree_map-59"><span class="linenos">59</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager.tree_map-60"><a href="#PyTreeSnapshotManager.tree_map-60"><span class="linenos">60</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PyTreeSnapshotManager.tree_map-61"><a href="#PyTreeSnapshotManager.tree_map-61"><span class="linenos">61</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># List of snapshot IDs</span>
</span><span id="PyTreeSnapshotManager.tree_map-62"><a href="#PyTreeSnapshotManager.tree_map-62"><span class="linenos">62</span></a>            <span class="n">single_return</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PyTreeSnapshotManager.tree_map-63"><a href="#PyTreeSnapshotManager.tree_map-63"><span class="linenos">63</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-64"><a href="#PyTreeSnapshotManager.tree_map-64"><span class="linenos">64</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_map-65"><a href="#PyTreeSnapshotManager.tree_map-65"><span class="linenos">65</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No snapshot IDs provided or available.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_map-66"><a href="#PyTreeSnapshotManager.tree_map-66"><span class="linenos">66</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-67"><a href="#PyTreeSnapshotManager.tree_map-67"><span class="linenos">67</span></a>        <span class="n">transformed_pytrees</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PyTreeSnapshotManager.tree_map-68"><a href="#PyTreeSnapshotManager.tree_map-68"><span class="linenos">68</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-69"><a href="#PyTreeSnapshotManager.tree_map-69"><span class="linenos">69</span></a>        <span class="k">for</span> <span class="n">snap_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_map-70"><a href="#PyTreeSnapshotManager.tree_map-70"><span class="linenos">70</span></a>            <span class="c1"># Retrieve the snapshot</span>
</span><span id="PyTreeSnapshotManager.tree_map-71"><a href="#PyTreeSnapshotManager.tree_map-71"><span class="linenos">71</span></a>            <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snap_id</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_map-72"><a href="#PyTreeSnapshotManager.tree_map-72"><span class="linenos">72</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_map-73"><a href="#PyTreeSnapshotManager.tree_map-73"><span class="linenos">73</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot </span><span class="si">{</span><span class="n">snap_id</span><span class="si">}</span><span class="s2"> is not a PyTreeSnapshot.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_map-74"><a href="#PyTreeSnapshotManager.tree_map-74"><span class="linenos">74</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-75"><a href="#PyTreeSnapshotManager.tree_map-75"><span class="linenos">75</span></a>            <span class="c1"># Apply the tree_map transformation</span>
</span><span id="PyTreeSnapshotManager.tree_map-76"><a href="#PyTreeSnapshotManager.tree_map-76"><span class="linenos">76</span></a>            <span class="n">transformed_pytree</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_map-77"><a href="#PyTreeSnapshotManager.tree_map-77"><span class="linenos">77</span></a>            <span class="n">transformed_pytrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_map-78"><a href="#PyTreeSnapshotManager.tree_map-78"><span class="linenos">78</span></a>
</span><span id="PyTreeSnapshotManager.tree_map-79"><a href="#PyTreeSnapshotManager.tree_map-79"><span class="linenos">79</span></a>        <span class="k">if</span> <span class="n">single_return</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_map-80"><a href="#PyTreeSnapshotManager.tree_map-80"><span class="linenos">80</span></a>            <span class="k">return</span> <span class="n">transformed_pytrees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Return a single PyTree if only one snapshot ID was provided</span>
</span><span id="PyTreeSnapshotManager.tree_map-81"><a href="#PyTreeSnapshotManager.tree_map-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="n">transformed_pytrees</span>  <span class="c1"># Return a list of PyTrees otherwise</span>
</span></pre></div>


            <div class="docstring"><p>Apply a transformation function to the PyTree(s) of specified snapshots.</p>

<p>Args:
    func (callable): A function to apply to each leaf of the PyTree.
                    The function should take a single argument (leaf) and return the transformed leaf.
    snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.
                                                If None, all snapshots in storage will be affected.
    is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</p>

<p>Returns:
    PyTree or list: A transformed PyTree if a single snapshot_id is provided,
                    a list of transformed PyTrees otherwise.</p>

<p>Raises:
    TypeError: If a snapshot is not a PyTreeSnapshot.
    ValueError: If no valid snapshots are found for the given snapshot_ids.</p>
</div>


                            </div>
                            <div id="PyTreeSnapshotManager.tree_replace" class="classattr">
                                        <input id="PyTreeSnapshotManager.tree_replace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tree_replace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">func</span>, </span><span class="param"><span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshotManager.tree_replace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager.tree_replace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager.tree_replace-83"><a href="#PyTreeSnapshotManager.tree_replace-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">tree_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_replace-84"><a href="#PyTreeSnapshotManager.tree_replace-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_replace-85"><a href="#PyTreeSnapshotManager.tree_replace-85"><span class="linenos"> 85</span></a><span class="sd">        Apply a transformation function to the PyTree(s) of specified snapshots and replace them in the storage.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-86"><a href="#PyTreeSnapshotManager.tree_replace-86"><span class="linenos"> 86</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-87"><a href="#PyTreeSnapshotManager.tree_replace-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-88"><a href="#PyTreeSnapshotManager.tree_replace-88"><span class="linenos"> 88</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-89"><a href="#PyTreeSnapshotManager.tree_replace-89"><span class="linenos"> 89</span></a><span class="sd">                            The function should take a single argument (leaf) and return the transformed leaf.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-90"><a href="#PyTreeSnapshotManager.tree_replace-90"><span class="linenos"> 90</span></a><span class="sd">            snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-91"><a href="#PyTreeSnapshotManager.tree_replace-91"><span class="linenos"> 91</span></a><span class="sd">                                                        If None, all snapshots in storage will be affected.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-92"><a href="#PyTreeSnapshotManager.tree_replace-92"><span class="linenos"> 92</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-93"><a href="#PyTreeSnapshotManager.tree_replace-93"><span class="linenos"> 93</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-94"><a href="#PyTreeSnapshotManager.tree_replace-94"><span class="linenos"> 94</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-95"><a href="#PyTreeSnapshotManager.tree_replace-95"><span class="linenos"> 95</span></a><span class="sd">            TypeError: If a snapshot is not a PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshotManager.tree_replace-96"><a href="#PyTreeSnapshotManager.tree_replace-96"><span class="linenos"> 96</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-97"><a href="#PyTreeSnapshotManager.tree_replace-97"><span class="linenos"> 97</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-98"><a href="#PyTreeSnapshotManager.tree_replace-98"><span class="linenos"> 98</span></a><span class="sd">            Replace all snapshots with a transformation applied:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-99"><a href="#PyTreeSnapshotManager.tree_replace-99"><span class="linenos"> 99</span></a><span class="sd">                manager.tree_replace(func=lambda x: x + 1)</span>
</span><span id="PyTreeSnapshotManager.tree_replace-100"><a href="#PyTreeSnapshotManager.tree_replace-100"><span class="linenos">100</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-101"><a href="#PyTreeSnapshotManager.tree_replace-101"><span class="linenos">101</span></a><span class="sd">            Replace a specific snapshot:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-102"><a href="#PyTreeSnapshotManager.tree_replace-102"><span class="linenos">102</span></a><span class="sd">                manager.tree_replace(</span>
</span><span id="PyTreeSnapshotManager.tree_replace-103"><a href="#PyTreeSnapshotManager.tree_replace-103"><span class="linenos">103</span></a><span class="sd">                    func=lambda x: x * 2,</span>
</span><span id="PyTreeSnapshotManager.tree_replace-104"><a href="#PyTreeSnapshotManager.tree_replace-104"><span class="linenos">104</span></a><span class="sd">                    snapshot_ids=&quot;snapshot123&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_replace-105"><a href="#PyTreeSnapshotManager.tree_replace-105"><span class="linenos">105</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager.tree_replace-106"><a href="#PyTreeSnapshotManager.tree_replace-106"><span class="linenos">106</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-107"><a href="#PyTreeSnapshotManager.tree_replace-107"><span class="linenos">107</span></a><span class="sd">            Replace multiple snapshots with custom leaf detection:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-108"><a href="#PyTreeSnapshotManager.tree_replace-108"><span class="linenos">108</span></a><span class="sd">                manager.tree_replace(</span>
</span><span id="PyTreeSnapshotManager.tree_replace-109"><a href="#PyTreeSnapshotManager.tree_replace-109"><span class="linenos">109</span></a><span class="sd">                    func=lambda x: x.lower(),</span>
</span><span id="PyTreeSnapshotManager.tree_replace-110"><a href="#PyTreeSnapshotManager.tree_replace-110"><span class="linenos">110</span></a><span class="sd">                    snapshot_ids=[&quot;snapshot123&quot;, &quot;snapshot456&quot;],</span>
</span><span id="PyTreeSnapshotManager.tree_replace-111"><a href="#PyTreeSnapshotManager.tree_replace-111"><span class="linenos">111</span></a><span class="sd">                    is_leaf=lambda x: isinstance(x, str)</span>
</span><span id="PyTreeSnapshotManager.tree_replace-112"><a href="#PyTreeSnapshotManager.tree_replace-112"><span class="linenos">112</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager.tree_replace-113"><a href="#PyTreeSnapshotManager.tree_replace-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_replace-114"><a href="#PyTreeSnapshotManager.tree_replace-114"><span class="linenos">114</span></a>        <span class="c1"># Normalize snapshot_ids into a list</span>
</span><span id="PyTreeSnapshotManager.tree_replace-115"><a href="#PyTreeSnapshotManager.tree_replace-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot_ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_replace-116"><a href="#PyTreeSnapshotManager.tree_replace-116"><span class="linenos">116</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">snapshot_ids</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager.tree_replace-117"><a href="#PyTreeSnapshotManager.tree_replace-117"><span class="linenos">117</span></a>        <span class="k">elif</span> <span class="n">snapshot_ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-118"><a href="#PyTreeSnapshotManager.tree_replace-118"><span class="linenos">118</span></a>            <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager.tree_replace-119"><a href="#PyTreeSnapshotManager.tree_replace-119"><span class="linenos">119</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-120"><a href="#PyTreeSnapshotManager.tree_replace-120"><span class="linenos">120</span></a>        <span class="k">for</span> <span class="n">snap_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_replace-121"><a href="#PyTreeSnapshotManager.tree_replace-121"><span class="linenos">121</span></a>            <span class="c1"># Retrieve the snapshot</span>
</span><span id="PyTreeSnapshotManager.tree_replace-122"><a href="#PyTreeSnapshotManager.tree_replace-122"><span class="linenos">122</span></a>            <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snap_id</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_replace-123"><a href="#PyTreeSnapshotManager.tree_replace-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_replace-124"><a href="#PyTreeSnapshotManager.tree_replace-124"><span class="linenos">124</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot </span><span class="si">{</span><span class="n">snap_id</span><span class="si">}</span><span class="s2"> is not a PyTreeSnapshot.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_replace-125"><a href="#PyTreeSnapshotManager.tree_replace-125"><span class="linenos">125</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-126"><a href="#PyTreeSnapshotManager.tree_replace-126"><span class="linenos">126</span></a>            <span class="c1"># Replace the PyTree in the existing snapshot</span>
</span><span id="PyTreeSnapshotManager.tree_replace-127"><a href="#PyTreeSnapshotManager.tree_replace-127"><span class="linenos">127</span></a>            <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_replace-128"><a href="#PyTreeSnapshotManager.tree_replace-128"><span class="linenos">128</span></a>
</span><span id="PyTreeSnapshotManager.tree_replace-129"><a href="#PyTreeSnapshotManager.tree_replace-129"><span class="linenos">129</span></a>            <span class="c1"># Update the snapshot in storage</span>
</span><span id="PyTreeSnapshotManager.tree_replace-130"><a href="#PyTreeSnapshotManager.tree_replace-130"><span class="linenos">130</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">add_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply a transformation function to the PyTree(s) of specified snapshots and replace them in the storage.</p>

<p>Args:
    func (callable): A function to apply to each leaf of the PyTree.
                    The function should take a single argument (leaf) and return the transformed leaf.
    snapshot_ids (str, list, or None, optional): A single snapshot ID, a list of snapshot IDs, or None.
                                                If None, all snapshots in storage will be affected.
    is_leaf (Callable[[Any], bool], optional): A function to determine custom leaf nodes. Defaults to None.</p>

<p>Raises:
    TypeError: If a snapshot is not a PyTreeSnapshot.</p>

<p>Examples:
    Replace all snapshots with a transformation applied:
        manager.tree_replace(func=lambda x: x + 1)</p>

<pre><code>Replace a specific snapshot:
    manager.tree_replace(
        func=lambda x: x * 2,
        snapshot_ids="snapshot123"
    )

Replace multiple snapshots with custom leaf detection:
    manager.tree_replace(
        func=lambda x: x.lower(),
        snapshot_ids=["snapshot123", "snapshot456"],
        is_leaf=lambda x: isinstance(x, str)
    )
</code></pre>
</div>


                            </div>
                            <div id="PyTreeSnapshotManager.tree_combine" class="classattr">
                                        <input id="PyTreeSnapshotManager.tree_combine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tree_combine</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">combine_fn</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshotManager.tree_combine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager.tree_combine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager.tree_combine-132"><a href="#PyTreeSnapshotManager.tree_combine-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">tree_combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_combine-133"><a href="#PyTreeSnapshotManager.tree_combine-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_combine-134"><a href="#PyTreeSnapshotManager.tree_combine-134"><span class="linenos">134</span></a><span class="sd">        Combine multiple snapshots&#39; PyTrees into a single PyTree using a custom function,</span>
</span><span id="PyTreeSnapshotManager.tree_combine-135"><a href="#PyTreeSnapshotManager.tree_combine-135"><span class="linenos">135</span></a><span class="sd">        and returns it.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-136"><a href="#PyTreeSnapshotManager.tree_combine-136"><span class="linenos">136</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-137"><a href="#PyTreeSnapshotManager.tree_combine-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-138"><a href="#PyTreeSnapshotManager.tree_combine-138"><span class="linenos">138</span></a><span class="sd">            snapshot_ids (list or None, optional): A list of IDs of the snapshots to combine.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-139"><a href="#PyTreeSnapshotManager.tree_combine-139"><span class="linenos">139</span></a><span class="sd">                                                If None, all snapshots in storage are used.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-140"><a href="#PyTreeSnapshotManager.tree_combine-140"><span class="linenos">140</span></a><span class="sd">            combine_fn (callable): A function to combine corresponding leaves of the PyTrees.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-141"><a href="#PyTreeSnapshotManager.tree_combine-141"><span class="linenos">141</span></a><span class="sd">                                This function takes a list of values (one from each snapshot)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-142"><a href="#PyTreeSnapshotManager.tree_combine-142"><span class="linenos">142</span></a><span class="sd">                                and returns a single combined value.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-143"><a href="#PyTreeSnapshotManager.tree_combine-143"><span class="linenos">143</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-144"><a href="#PyTreeSnapshotManager.tree_combine-144"><span class="linenos">144</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-145"><a href="#PyTreeSnapshotManager.tree_combine-145"><span class="linenos">145</span></a><span class="sd">            PyTree: returns the combined PyTree</span>
</span><span id="PyTreeSnapshotManager.tree_combine-146"><a href="#PyTreeSnapshotManager.tree_combine-146"><span class="linenos">146</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-147"><a href="#PyTreeSnapshotManager.tree_combine-147"><span class="linenos">147</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-148"><a href="#PyTreeSnapshotManager.tree_combine-148"><span class="linenos">148</span></a><span class="sd">            ValueError: If `combine_fn` is not provided.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-149"><a href="#PyTreeSnapshotManager.tree_combine-149"><span class="linenos">149</span></a><span class="sd">            TypeError: If the snapshots are not PyTreeSnapshots or their structures do not match.</span>
</span><span id="PyTreeSnapshotManager.tree_combine-150"><a href="#PyTreeSnapshotManager.tree_combine-150"><span class="linenos">150</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-151"><a href="#PyTreeSnapshotManager.tree_combine-151"><span class="linenos">151</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-152"><a href="#PyTreeSnapshotManager.tree_combine-152"><span class="linenos">152</span></a><span class="sd">            Combine all snapshot pytrees with an addition operation:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-153"><a href="#PyTreeSnapshotManager.tree_combine-153"><span class="linenos">153</span></a><span class="sd">                combined_pytree = manager.tree_combine(</span>
</span><span id="PyTreeSnapshotManager.tree_combine-154"><a href="#PyTreeSnapshotManager.tree_combine-154"><span class="linenos">154</span></a><span class="sd">                    combine_fn=lambda leaves: sum(leaves)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-155"><a href="#PyTreeSnapshotManager.tree_combine-155"><span class="linenos">155</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager.tree_combine-156"><a href="#PyTreeSnapshotManager.tree_combine-156"><span class="linenos">156</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-157"><a href="#PyTreeSnapshotManager.tree_combine-157"><span class="linenos">157</span></a><span class="sd">            Combine specific snapshot pytrees:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-158"><a href="#PyTreeSnapshotManager.tree_combine-158"><span class="linenos">158</span></a><span class="sd">                combined_pytree = manager.tree_combine(</span>
</span><span id="PyTreeSnapshotManager.tree_combine-159"><a href="#PyTreeSnapshotManager.tree_combine-159"><span class="linenos">159</span></a><span class="sd">                    snapshot_ids=[&quot;snapshot1&quot;, &quot;snapshot2&quot;],</span>
</span><span id="PyTreeSnapshotManager.tree_combine-160"><a href="#PyTreeSnapshotManager.tree_combine-160"><span class="linenos">160</span></a><span class="sd">                    combine_fn=lambda leaves: max(leaves)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-161"><a href="#PyTreeSnapshotManager.tree_combine-161"><span class="linenos">161</span></a><span class="sd">                )</span>
</span><span id="PyTreeSnapshotManager.tree_combine-162"><a href="#PyTreeSnapshotManager.tree_combine-162"><span class="linenos">162</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-163"><a href="#PyTreeSnapshotManager.tree_combine-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.tree_combine-164"><a href="#PyTreeSnapshotManager.tree_combine-164"><span class="linenos">164</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-165"><a href="#PyTreeSnapshotManager.tree_combine-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="n">combine_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PyTreeSnapshotManager.tree_combine-166"><a href="#PyTreeSnapshotManager.tree_combine-166"><span class="linenos">166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A combine_fn must be provided to combine PyTrees.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-167"><a href="#PyTreeSnapshotManager.tree_combine-167"><span class="linenos">167</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-168"><a href="#PyTreeSnapshotManager.tree_combine-168"><span class="linenos">168</span></a>        <span class="c1"># Select snapshots to combine</span>
</span><span id="PyTreeSnapshotManager.tree_combine-169"><a href="#PyTreeSnapshotManager.tree_combine-169"><span class="linenos">169</span></a>        <span class="n">snapshot_ids</span> <span class="o">=</span> <span class="n">snapshot_ids</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">insertion_order</span>
</span><span id="PyTreeSnapshotManager.tree_combine-170"><a href="#PyTreeSnapshotManager.tree_combine-170"><span class="linenos">170</span></a>        <span class="n">pytree_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PyTreeSnapshotManager.tree_combine-171"><a href="#PyTreeSnapshotManager.tree_combine-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">)</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">snapshot_id</span> <span class="ow">in</span> <span class="n">snapshot_ids</span>
</span><span id="PyTreeSnapshotManager.tree_combine-172"><a href="#PyTreeSnapshotManager.tree_combine-172"><span class="linenos">172</span></a>        <span class="p">]</span>
</span><span id="PyTreeSnapshotManager.tree_combine-173"><a href="#PyTreeSnapshotManager.tree_combine-173"><span class="linenos">173</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-174"><a href="#PyTreeSnapshotManager.tree_combine-174"><span class="linenos">174</span></a>        <span class="c1"># Ensure all PyTrees have the same structure</span>
</span><span id="PyTreeSnapshotManager.tree_combine-175"><a href="#PyTreeSnapshotManager.tree_combine-175"><span class="linenos">175</span></a>        <span class="n">flattened</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager.tree_combine-176"><a href="#PyTreeSnapshotManager.tree_combine-176"><span class="linenos">176</span></a>            <span class="o">*</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span> <span class="k">for</span> <span class="n">pytree</span> <span class="ow">in</span> <span class="n">pytree_list</span><span class="p">]</span>
</span><span id="PyTreeSnapshotManager.tree_combine-177"><a href="#PyTreeSnapshotManager.tree_combine-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-178"><a href="#PyTreeSnapshotManager.tree_combine-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.tree_combine-179"><a href="#PyTreeSnapshotManager.tree_combine-179"><span class="linenos">179</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All snapshots must have the same PyTree structure.&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshotManager.tree_combine-180"><a href="#PyTreeSnapshotManager.tree_combine-180"><span class="linenos">180</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-181"><a href="#PyTreeSnapshotManager.tree_combine-181"><span class="linenos">181</span></a>        <span class="c1"># Apply the combine function to each set of corresponding leaves</span>
</span><span id="PyTreeSnapshotManager.tree_combine-182"><a href="#PyTreeSnapshotManager.tree_combine-182"><span class="linenos">182</span></a>        <span class="n">combined_leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">combine_fn</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span> <span class="k">for</span> <span class="n">leaves</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">flattened</span><span class="p">)]</span>
</span><span id="PyTreeSnapshotManager.tree_combine-183"><a href="#PyTreeSnapshotManager.tree_combine-183"><span class="linenos">183</span></a>
</span><span id="PyTreeSnapshotManager.tree_combine-184"><a href="#PyTreeSnapshotManager.tree_combine-184"><span class="linenos">184</span></a>        <span class="c1"># return the combined pytree</span>
</span><span id="PyTreeSnapshotManager.tree_combine-185"><a href="#PyTreeSnapshotManager.tree_combine-185"><span class="linenos">185</span></a>        <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_unflatten</span><span class="p">(</span><span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">combined_leaves</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Combine multiple snapshots' PyTrees into a single PyTree using a custom function,
and returns it.</p>

<p>Args:
    snapshot_ids (list or None, optional): A list of IDs of the snapshots to combine.
                                        If None, all snapshots in storage are used.
    combine_fn (callable): A function to combine corresponding leaves of the PyTrees.
                        This function takes a list of values (one from each snapshot)
                        and returns a single combined value.</p>

<p>Returns:
    PyTree: returns the combined PyTree</p>

<p>Raises:
    ValueError: If <code>combine_fn</code> is not provided.
    TypeError: If the snapshots are not PyTreeSnapshots or their structures do not match.</p>

<p>Examples:
    Combine all snapshot pytrees with an addition operation:
        combined_pytree = manager.tree_combine(
            combine_fn=lambda leaves: sum(leaves)
        )</p>

<pre><code>Combine specific snapshot pytrees:
    combined_pytree = manager.tree_combine(
        snapshot_ids=["snapshot1", "snapshot2"],
        combine_fn=lambda leaves: max(leaves)
    )
</code></pre>
</div>


                            </div>
                            <div id="PyTreeSnapshotManager.load_from_file" class="classattr">
                                        <input id="PyTreeSnapshotManager.load_from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">load_from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshotManager.load_from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshotManager.load_from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshotManager.load_from_file-187"><a href="#PyTreeSnapshotManager.load_from_file-187"><span class="linenos">187</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PyTreeSnapshotManager.load_from_file-188"><a href="#PyTreeSnapshotManager.load_from_file-188"><span class="linenos">188</span></a>    <span class="k">def</span> <span class="nf">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="PyTreeSnapshotManager.load_from_file-189"><a href="#PyTreeSnapshotManager.load_from_file-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.load_from_file-190"><a href="#PyTreeSnapshotManager.load_from_file-190"><span class="linenos">190</span></a><span class="sd">        Load a PyTreeSnapshotManager state from a file.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-191"><a href="#PyTreeSnapshotManager.load_from_file-191"><span class="linenos">191</span></a>
</span><span id="PyTreeSnapshotManager.load_from_file-192"><a href="#PyTreeSnapshotManager.load_from_file-192"><span class="linenos">192</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-193"><a href="#PyTreeSnapshotManager.load_from_file-193"><span class="linenos">193</span></a><span class="sd">            file_path (str): The file path of the saved state to load.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-194"><a href="#PyTreeSnapshotManager.load_from_file-194"><span class="linenos">194</span></a>
</span><span id="PyTreeSnapshotManager.load_from_file-195"><a href="#PyTreeSnapshotManager.load_from_file-195"><span class="linenos">195</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-196"><a href="#PyTreeSnapshotManager.load_from_file-196"><span class="linenos">196</span></a><span class="sd">            PyTreeSnapshotManager: An instance of `PyTreeSnapshotManager` with the loaded state.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-197"><a href="#PyTreeSnapshotManager.load_from_file-197"><span class="linenos">197</span></a>
</span><span id="PyTreeSnapshotManager.load_from_file-198"><a href="#PyTreeSnapshotManager.load_from_file-198"><span class="linenos">198</span></a><span class="sd">        Raises:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-199"><a href="#PyTreeSnapshotManager.load_from_file-199"><span class="linenos">199</span></a><span class="sd">            FileNotFoundError: If the specified file does not exist.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-200"><a href="#PyTreeSnapshotManager.load_from_file-200"><span class="linenos">200</span></a><span class="sd">            IOError: If there is an error reading the file.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-201"><a href="#PyTreeSnapshotManager.load_from_file-201"><span class="linenos">201</span></a><span class="sd">            ValueError: If the file contents cannot be deserialized into the expected state.</span>
</span><span id="PyTreeSnapshotManager.load_from_file-202"><a href="#PyTreeSnapshotManager.load_from_file-202"><span class="linenos">202</span></a>
</span><span id="PyTreeSnapshotManager.load_from_file-203"><a href="#PyTreeSnapshotManager.load_from_file-203"><span class="linenos">203</span></a><span class="sd">        Examples:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-204"><a href="#PyTreeSnapshotManager.load_from_file-204"><span class="linenos">204</span></a><span class="sd">            Load a manager state from a saved file:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-205"><a href="#PyTreeSnapshotManager.load_from_file-205"><span class="linenos">205</span></a><span class="sd">                manager = PyTreeSnapshotManager.load_from_file(&quot;snapshots_state.json&quot;)</span>
</span><span id="PyTreeSnapshotManager.load_from_file-206"><a href="#PyTreeSnapshotManager.load_from_file-206"><span class="linenos">206</span></a>
</span><span id="PyTreeSnapshotManager.load_from_file-207"><a href="#PyTreeSnapshotManager.load_from_file-207"><span class="linenos">207</span></a><span class="sd">            Access snapshots from the loaded manager:</span>
</span><span id="PyTreeSnapshotManager.load_from_file-208"><a href="#PyTreeSnapshotManager.load_from_file-208"><span class="linenos">208</span></a><span class="sd">                snapshot = manager.get_snapshot(&quot;snapshot_id&quot;)</span>
</span><span id="PyTreeSnapshotManager.load_from_file-209"><a href="#PyTreeSnapshotManager.load_from_file-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshotManager.load_from_file-210"><a href="#PyTreeSnapshotManager.load_from_file-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">SnapshotPersistence</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="PyTreeSnapshotManager.load_from_file-211"><a href="#PyTreeSnapshotManager.load_from_file-211"><span class="linenos">211</span></a>            <span class="n">file_path</span><span class="p">,</span> <span class="n">PyTreeSnapshotManager</span><span class="p">,</span> <span class="n">PyTreeSnapshot</span>
</span><span id="PyTreeSnapshotManager.load_from_file-212"><a href="#PyTreeSnapshotManager.load_from_file-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load a PyTreeSnapshotManager state from a file.</p>

<p>Args:
    file_path (str): The file path of the saved state to load.</p>

<p>Returns:
    PyTreeSnapshotManager: An instance of <code><a href="#PyTreeSnapshotManager">PyTreeSnapshotManager</a></code> with the loaded state.</p>

<p>Raises:
    FileNotFoundError: If the specified file does not exist.
    IOError: If there is an error reading the file.
    ValueError: If the file contents cannot be deserialized into the expected state.</p>

<p>Examples:
    Load a manager state from a saved file:
        manager = <a href="#PyTreeSnapshotManager.load_from_file">PyTreeSnapshotManager.load_from_file</a>("snapshots_state.json")</p>

<pre><code>Access snapshots from the loaded manager:
    snapshot = manager.get_snapshot("snapshot_id")
</code></pre>
</div>


                            </div>
                </section>
                <section id="PyTreeSnapshot">
                            <input id="PyTreeSnapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PyTreeSnapshot</span><wbr>(<span class="base"><a href="#Snapshot">snapshot_manager.Snapshot</a></span>):

                <label class="view-source-button" for="PyTreeSnapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshot-7"><a href="#PyTreeSnapshot-7"><span class="linenos"> 7</span></a><span class="k">class</span> <span class="nc">PyTreeSnapshot</span><span class="p">(</span><span class="n">Snapshot</span><span class="p">):</span>
</span><span id="PyTreeSnapshot-8"><a href="#PyTreeSnapshot-8"><span class="linenos"> 8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PyTreeSnapshot-9"><a href="#PyTreeSnapshot-9"><span class="linenos"> 9</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">pytree</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span>
</span><span id="PyTreeSnapshot-10"><a href="#PyTreeSnapshot-10"><span class="linenos">10</span></a>    <span class="p">):</span>
</span><span id="PyTreeSnapshot-11"><a href="#PyTreeSnapshot-11"><span class="linenos">11</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-12"><a href="#PyTreeSnapshot-12"><span class="linenos">12</span></a><span class="sd">        Initialize a PyTree-specific Snapshot.</span>
</span><span id="PyTreeSnapshot-13"><a href="#PyTreeSnapshot-13"><span class="linenos">13</span></a>
</span><span id="PyTreeSnapshot-14"><a href="#PyTreeSnapshot-14"><span class="linenos">14</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshot-15"><a href="#PyTreeSnapshot-15"><span class="linenos">15</span></a><span class="sd">            pytree: A valid JAX PyTree.</span>
</span><span id="PyTreeSnapshot-16"><a href="#PyTreeSnapshot-16"><span class="linenos">16</span></a><span class="sd">            metadata (dict, optional): User-defined metadata.</span>
</span><span id="PyTreeSnapshot-17"><a href="#PyTreeSnapshot-17"><span class="linenos">17</span></a><span class="sd">            tags (list, optional): Tags associated with the snapshot.</span>
</span><span id="PyTreeSnapshot-18"><a href="#PyTreeSnapshot-18"><span class="linenos">18</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-19"><a href="#PyTreeSnapshot-19"><span class="linenos">19</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate_pytree</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshot-20"><a href="#PyTreeSnapshot-20"><span class="linenos">20</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pytree</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">)</span>
</span><span id="PyTreeSnapshot-21"><a href="#PyTreeSnapshot-21"><span class="linenos">21</span></a>
</span><span id="PyTreeSnapshot-22"><a href="#PyTreeSnapshot-22"><span class="linenos">22</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PyTreeSnapshot-23"><a href="#PyTreeSnapshot-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="nf">validate_pytree</span><span class="p">(</span><span class="n">pytree</span><span class="p">):</span>
</span><span id="PyTreeSnapshot-24"><a href="#PyTreeSnapshot-24"><span class="linenos">24</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-25"><a href="#PyTreeSnapshot-25"><span class="linenos">25</span></a><span class="sd">        Validate that the object is a valid JAX PyTree.</span>
</span><span id="PyTreeSnapshot-26"><a href="#PyTreeSnapshot-26"><span class="linenos">26</span></a><span class="sd">        Raises a ValueError if not valid.</span>
</span><span id="PyTreeSnapshot-27"><a href="#PyTreeSnapshot-27"><span class="linenos">27</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-28"><a href="#PyTreeSnapshot-28"><span class="linenos">28</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PyTreeSnapshot-29"><a href="#PyTreeSnapshot-29"><span class="linenos">29</span></a>            <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshot-30"><a href="#PyTreeSnapshot-30"><span class="linenos">30</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PyTreeSnapshot-31"><a href="#PyTreeSnapshot-31"><span class="linenos">31</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid PyTree: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PyTreeSnapshot-32"><a href="#PyTreeSnapshot-32"><span class="linenos">32</span></a>
</span><span id="PyTreeSnapshot-33"><a href="#PyTreeSnapshot-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">tree_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshot-34"><a href="#PyTreeSnapshot-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-35"><a href="#PyTreeSnapshot-35"><span class="linenos">35</span></a><span class="sd">        Apply a transformation function to each leaf of the PyTree and return a new PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshot-36"><a href="#PyTreeSnapshot-36"><span class="linenos">36</span></a>
</span><span id="PyTreeSnapshot-37"><a href="#PyTreeSnapshot-37"><span class="linenos">37</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshot-38"><a href="#PyTreeSnapshot-38"><span class="linenos">38</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshot-39"><a href="#PyTreeSnapshot-39"><span class="linenos">39</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): Function to determine custom leaf nodes.</span>
</span><span id="PyTreeSnapshot-40"><a href="#PyTreeSnapshot-40"><span class="linenos">40</span></a><span class="sd">            new_id (str, optional): Optional custom ID for the new snapshot.</span>
</span><span id="PyTreeSnapshot-41"><a href="#PyTreeSnapshot-41"><span class="linenos">41</span></a>
</span><span id="PyTreeSnapshot-42"><a href="#PyTreeSnapshot-42"><span class="linenos">42</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshot-43"><a href="#PyTreeSnapshot-43"><span class="linenos">43</span></a><span class="sd">            PyTreeSnapshot: A new snapshot with the transformed PyTree.</span>
</span><span id="PyTreeSnapshot-44"><a href="#PyTreeSnapshot-44"><span class="linenos">44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot-45"><a href="#PyTreeSnapshot-45"><span class="linenos">45</span></a>        <span class="c1"># Transform the PyTree</span>
</span><span id="PyTreeSnapshot-46"><a href="#PyTreeSnapshot-46"><span class="linenos">46</span></a>        <span class="n">transformed_pytree</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshot-47"><a href="#PyTreeSnapshot-47"><span class="linenos">47</span></a>
</span><span id="PyTreeSnapshot-48"><a href="#PyTreeSnapshot-48"><span class="linenos">48</span></a>        <span class="c1"># Create a new PyTreeSnapshot with the transformed data</span>
</span><span id="PyTreeSnapshot-49"><a href="#PyTreeSnapshot-49"><span class="linenos">49</span></a>        <span class="n">new_snapshot</span> <span class="o">=</span> <span class="n">PyTreeSnapshot</span><span class="p">(</span>
</span><span id="PyTreeSnapshot-50"><a href="#PyTreeSnapshot-50"><span class="linenos">50</span></a>            <span class="n">transformed_pytree</span><span class="p">,</span>
</span><span id="PyTreeSnapshot-51"><a href="#PyTreeSnapshot-51"><span class="linenos">51</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">),</span>
</span><span id="PyTreeSnapshot-52"><a href="#PyTreeSnapshot-52"><span class="linenos">52</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">),</span>
</span><span id="PyTreeSnapshot-53"><a href="#PyTreeSnapshot-53"><span class="linenos">53</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="PyTreeSnapshot-54"><a href="#PyTreeSnapshot-54"><span class="linenos">54</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">new_id</span><span class="p">,</span>
</span><span id="PyTreeSnapshot-55"><a href="#PyTreeSnapshot-55"><span class="linenos">55</span></a>        <span class="p">)</span>
</span><span id="PyTreeSnapshot-56"><a href="#PyTreeSnapshot-56"><span class="linenos">56</span></a>
</span><span id="PyTreeSnapshot-57"><a href="#PyTreeSnapshot-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">new_snapshot</span>
</span></pre></div>


    

                            <div id="PyTreeSnapshot.__init__" class="classattr">
                                        <input id="PyTreeSnapshot.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PyTreeSnapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pytree</span>, </span><span class="param"><span class="n">metadata</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">tags</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="PyTreeSnapshot.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshot.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshot.__init__-8"><a href="#PyTreeSnapshot.__init__-8"><span class="linenos"> 8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PyTreeSnapshot.__init__-9"><a href="#PyTreeSnapshot.__init__-9"><span class="linenos"> 9</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">pytree</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="kc">None</span>
</span><span id="PyTreeSnapshot.__init__-10"><a href="#PyTreeSnapshot.__init__-10"><span class="linenos">10</span></a>    <span class="p">):</span>
</span><span id="PyTreeSnapshot.__init__-11"><a href="#PyTreeSnapshot.__init__-11"><span class="linenos">11</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.__init__-12"><a href="#PyTreeSnapshot.__init__-12"><span class="linenos">12</span></a><span class="sd">        Initialize a PyTree-specific Snapshot.</span>
</span><span id="PyTreeSnapshot.__init__-13"><a href="#PyTreeSnapshot.__init__-13"><span class="linenos">13</span></a>
</span><span id="PyTreeSnapshot.__init__-14"><a href="#PyTreeSnapshot.__init__-14"><span class="linenos">14</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshot.__init__-15"><a href="#PyTreeSnapshot.__init__-15"><span class="linenos">15</span></a><span class="sd">            pytree: A valid JAX PyTree.</span>
</span><span id="PyTreeSnapshot.__init__-16"><a href="#PyTreeSnapshot.__init__-16"><span class="linenos">16</span></a><span class="sd">            metadata (dict, optional): User-defined metadata.</span>
</span><span id="PyTreeSnapshot.__init__-17"><a href="#PyTreeSnapshot.__init__-17"><span class="linenos">17</span></a><span class="sd">            tags (list, optional): Tags associated with the snapshot.</span>
</span><span id="PyTreeSnapshot.__init__-18"><a href="#PyTreeSnapshot.__init__-18"><span class="linenos">18</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.__init__-19"><a href="#PyTreeSnapshot.__init__-19"><span class="linenos">19</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate_pytree</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshot.__init__-20"><a href="#PyTreeSnapshot.__init__-20"><span class="linenos">20</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pytree</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a PyTree-specific Snapshot.</p>

<p>Args:
    pytree: A valid JAX PyTree.
    metadata (dict, optional): User-defined metadata.
    tags (list, optional): Tags associated with the snapshot.</p>
</div>


                            </div>
                            <div id="PyTreeSnapshot.validate_pytree" class="classattr">
                                        <input id="PyTreeSnapshot.validate_pytree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">validate_pytree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pytree</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshot.validate_pytree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshot.validate_pytree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshot.validate_pytree-22"><a href="#PyTreeSnapshot.validate_pytree-22"><span class="linenos">22</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PyTreeSnapshot.validate_pytree-23"><a href="#PyTreeSnapshot.validate_pytree-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="nf">validate_pytree</span><span class="p">(</span><span class="n">pytree</span><span class="p">):</span>
</span><span id="PyTreeSnapshot.validate_pytree-24"><a href="#PyTreeSnapshot.validate_pytree-24"><span class="linenos">24</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.validate_pytree-25"><a href="#PyTreeSnapshot.validate_pytree-25"><span class="linenos">25</span></a><span class="sd">        Validate that the object is a valid JAX PyTree.</span>
</span><span id="PyTreeSnapshot.validate_pytree-26"><a href="#PyTreeSnapshot.validate_pytree-26"><span class="linenos">26</span></a><span class="sd">        Raises a ValueError if not valid.</span>
</span><span id="PyTreeSnapshot.validate_pytree-27"><a href="#PyTreeSnapshot.validate_pytree-27"><span class="linenos">27</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.validate_pytree-28"><a href="#PyTreeSnapshot.validate_pytree-28"><span class="linenos">28</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PyTreeSnapshot.validate_pytree-29"><a href="#PyTreeSnapshot.validate_pytree-29"><span class="linenos">29</span></a>            <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span>
</span><span id="PyTreeSnapshot.validate_pytree-30"><a href="#PyTreeSnapshot.validate_pytree-30"><span class="linenos">30</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PyTreeSnapshot.validate_pytree-31"><a href="#PyTreeSnapshot.validate_pytree-31"><span class="linenos">31</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid PyTree: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Validate that the object is a valid JAX PyTree.
Raises a ValueError if not valid.</p>
</div>


                            </div>
                            <div id="PyTreeSnapshot.tree_map" class="classattr">
                                        <input id="PyTreeSnapshot.tree_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tree_map</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">func</span>, </span><span class="param"><span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">new_id</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PyTreeSnapshot.tree_map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PyTreeSnapshot.tree_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PyTreeSnapshot.tree_map-33"><a href="#PyTreeSnapshot.tree_map-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">tree_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="PyTreeSnapshot.tree_map-34"><a href="#PyTreeSnapshot.tree_map-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.tree_map-35"><a href="#PyTreeSnapshot.tree_map-35"><span class="linenos">35</span></a><span class="sd">        Apply a transformation function to each leaf of the PyTree and return a new PyTreeSnapshot.</span>
</span><span id="PyTreeSnapshot.tree_map-36"><a href="#PyTreeSnapshot.tree_map-36"><span class="linenos">36</span></a>
</span><span id="PyTreeSnapshot.tree_map-37"><a href="#PyTreeSnapshot.tree_map-37"><span class="linenos">37</span></a><span class="sd">        Args:</span>
</span><span id="PyTreeSnapshot.tree_map-38"><a href="#PyTreeSnapshot.tree_map-38"><span class="linenos">38</span></a><span class="sd">            func (callable): A function to apply to each leaf of the PyTree.</span>
</span><span id="PyTreeSnapshot.tree_map-39"><a href="#PyTreeSnapshot.tree_map-39"><span class="linenos">39</span></a><span class="sd">            is_leaf (Callable[[Any], bool], optional): Function to determine custom leaf nodes.</span>
</span><span id="PyTreeSnapshot.tree_map-40"><a href="#PyTreeSnapshot.tree_map-40"><span class="linenos">40</span></a><span class="sd">            new_id (str, optional): Optional custom ID for the new snapshot.</span>
</span><span id="PyTreeSnapshot.tree_map-41"><a href="#PyTreeSnapshot.tree_map-41"><span class="linenos">41</span></a>
</span><span id="PyTreeSnapshot.tree_map-42"><a href="#PyTreeSnapshot.tree_map-42"><span class="linenos">42</span></a><span class="sd">        Returns:</span>
</span><span id="PyTreeSnapshot.tree_map-43"><a href="#PyTreeSnapshot.tree_map-43"><span class="linenos">43</span></a><span class="sd">            PyTreeSnapshot: A new snapshot with the transformed PyTree.</span>
</span><span id="PyTreeSnapshot.tree_map-44"><a href="#PyTreeSnapshot.tree_map-44"><span class="linenos">44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PyTreeSnapshot.tree_map-45"><a href="#PyTreeSnapshot.tree_map-45"><span class="linenos">45</span></a>        <span class="c1"># Transform the PyTree</span>
</span><span id="PyTreeSnapshot.tree_map-46"><a href="#PyTreeSnapshot.tree_map-46"><span class="linenos">46</span></a>        <span class="n">transformed_pytree</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>
</span><span id="PyTreeSnapshot.tree_map-47"><a href="#PyTreeSnapshot.tree_map-47"><span class="linenos">47</span></a>
</span><span id="PyTreeSnapshot.tree_map-48"><a href="#PyTreeSnapshot.tree_map-48"><span class="linenos">48</span></a>        <span class="c1"># Create a new PyTreeSnapshot with the transformed data</span>
</span><span id="PyTreeSnapshot.tree_map-49"><a href="#PyTreeSnapshot.tree_map-49"><span class="linenos">49</span></a>        <span class="n">new_snapshot</span> <span class="o">=</span> <span class="n">PyTreeSnapshot</span><span class="p">(</span>
</span><span id="PyTreeSnapshot.tree_map-50"><a href="#PyTreeSnapshot.tree_map-50"><span class="linenos">50</span></a>            <span class="n">transformed_pytree</span><span class="p">,</span>
</span><span id="PyTreeSnapshot.tree_map-51"><a href="#PyTreeSnapshot.tree_map-51"><span class="linenos">51</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">),</span>
</span><span id="PyTreeSnapshot.tree_map-52"><a href="#PyTreeSnapshot.tree_map-52"><span class="linenos">52</span></a>            <span class="n">tags</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">),</span>
</span><span id="PyTreeSnapshot.tree_map-53"><a href="#PyTreeSnapshot.tree_map-53"><span class="linenos">53</span></a>            <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="PyTreeSnapshot.tree_map-54"><a href="#PyTreeSnapshot.tree_map-54"><span class="linenos">54</span></a>            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">new_id</span><span class="p">,</span>
</span><span id="PyTreeSnapshot.tree_map-55"><a href="#PyTreeSnapshot.tree_map-55"><span class="linenos">55</span></a>        <span class="p">)</span>
</span><span id="PyTreeSnapshot.tree_map-56"><a href="#PyTreeSnapshot.tree_map-56"><span class="linenos">56</span></a>
</span><span id="PyTreeSnapshot.tree_map-57"><a href="#PyTreeSnapshot.tree_map-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">new_snapshot</span>
</span></pre></div>


            <div class="docstring"><p>Apply a transformation function to each leaf of the PyTree and return a new PyTreeSnapshot.</p>

<p>Args:
    func (callable): A function to apply to each leaf of the PyTree.
    is_leaf (Callable[[Any], bool], optional): Function to determine custom leaf nodes.
    new_id (str, optional): Optional custom ID for the new snapshot.</p>

<p>Returns:
    PyTreeSnapshot: A new snapshot with the transformed PyTree.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>